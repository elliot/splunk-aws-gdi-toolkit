import unittest, os, importlib, time, moto, boto3, glob


class S3_SQS_Lambda_Firehose_Tests(unittest.TestCase):

	mock_s3 = moto.mock_s3()
	bucket_name = "s3-sqs-lambda-firehose-bucket"
	os.environ["AWS_ACCESS_KEY_ID"] = "testing"
	os.environ["AWS_SECRET_ACCESS_KEY"] = "testing"
	os.environ["AWS_SECURITY_TOKEN"] = "testing"
	os.environ["AWS_SESSION_TOKEN"] = "testing"
	os.environ["AWS_DEFAULT_REGION"] = "us-east-1"	

	def setUp(self):
		# Set environment variables
		os.environ['firehoseDeliverySreamName'] = "main"
		os.environ['AWS_REGION'] = "main"
		os.environ['SPLUNK_INDEX'] = "main"
		os.environ['SPLUNK_TIME_PREFIX'] = "main"
		os.environ['SPLUNK_EVENT_DELIMITER'] = "main"
		os.environ['SPLUNK_TIME_DELINEATED_FIELD'] = "main"
		os.environ['SPLUNK_TIME_FORMAT'] = "main"
		os.environ['SPLUNK_STRFTIME_FORMAT'] = "main"
		os.environ['SPLUNK_SOURCETYPE'] = "main"
		os.environ['SPLUNK_SOURCE'] = "main"
		os.environ['SPLUNK_HOST'] = "main"
		os.environ['SPLUNK_JSON_FORMAT'] = "main"
		os.environ['SPLUNK_IGNORE_FIRST_LINE'] = "main"
		os.environ['SPLUNK_CSV_TO_JSON'] = "main"
		os.environ['SPLUNK_REMOVE_EMPTY_CSV_TO_JSON_FIELDS'] = "main"	

		# Import function to test
		self.lambda_module = importlib.import_module('lambda')

		# Reset vars in function that may have been overwritten during tests
		self.lambda_module.SPLUNK_SOURCETYPE = "main"
		self.lambda_module.SPLUNK_JSON_FORMAT = "main"
		self.lambda_module.SPLUNK_CSV_TO_JSON = "main"
		self.lambda_module.SPLUNK_REMOVE_EMPTY_CSV_TO_JSON_FIELDS = "main"
		self.lambda_module.SPLUNK_TIME_FORMAT = "main"
		self.lambda_module.SPLUNK_TIME_PREFIX = "main"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "main"
		self.lambda_module.SPLUNK_EVENT_DELIMITER = "main"
		self.lambda_module.SPLUNK_STRFTIME_FORMAT = "main"

		# Set up mock_s3
		self.mock_s3.start()
		s3 = boto3.resource("s3")
		bucket = s3.Bucket(self.bucket_name)
		bucket.create()

		# Copy files to mock_s3 bucket
		s3Client = boto3.client('s3')
		testFiles = ["testFile1.log", "testdir/123/testFile2.log"]
		for testFile in testFiles:
			s3Client.upload_file("test-artifacts/" + str(testFile), self.bucket_name, str(testFile))


	def test_createDdelimiter(self):
		
		# Test with un-swapped delimiters
		self.assertEqual(self.lambda_module.createDelimiter("none"), "none")
		self.assertEqual(self.lambda_module.createDelimiter("main"), "main")
		self.assertNotEqual(self.lambda_module.createDelimiter("none"), " ")

		# Test with delimiters to be swapped
		self.assertEqual(self.lambda_module.createDelimiter("comma"), ",")
		self.assertEqual(self.lambda_module.createDelimiter("space"), " ")
		self.assertEqual(self.lambda_module.createDelimiter("tab"), "	")
		self.assertEqual(self.lambda_module.createDelimiter("semicolon"), ";")

	def test_retrieveObjectInfo(self):

		# Test with working paths
		self.assertEqual(self.lambda_module.retrieveObjectInfo({'messageId': '0ed4e10e-7fe3-41c8-ba7e-59b0c90826f3', 'receiptHandle': 'AQEBrbGkhIBIrdBxqc9HfoDkMkaNz7/OE4jftgDzblOgi6aY4xgKPteadRUkKhr2apF8LYVsA9dZXVxPyQM74Tb0p8hNvZojgZW39Q0w8U75Lo/URZtpq/KT/LP+NBn5AUlYHwgV2Zy/i6TAs6EkNPjPj/+VYC8fNpaPeV5cFys/2Ql5hK1PTpvewhIe2TNLMjj2BUNWycSuboa5N6n5tY0wQG84JQvceb6tGW9x5Lb/ZP/ortmAZH+Yn5iUrg0sJwdudff1WdH8xZPSR3mSttskL7sSfEHS1cGLNr1XsHz4xpmX5Mv+xpievXjLMIESaO6aNoqBmQDPlZcExBJbWEXyDWrzVrU3YeQuTYaOFKXX8sf28aROG7jxJhk9NR5TSBR3w+vmuz0tgtm0pEqLHQPiC+MSi1nJeO7NbnPcnTqwvRLotFdmhlWAYBbPYsMuAoqp', 'body': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-2","eventTime":"2023-01-21T21:08:44.251Z","eventName":"ObjectCreated:Put","userIdentity":{"principalId":"AWS:AROAV2CJ256E23ZOBRSAF:prod.pdx.dbs.datafeeds.aws.internal"},"requestParameters":{"sourceIPAddress":"172.18.238.76"},"responseElements":{"x-amz-request-id":"81KMJ9RD5J340C2G","x-amz-id-2":"ORkLTETarSJwEOsMpQaqiVSdT8uoocAjB7tOlkVzfNMrqaGPRFHR4Jb4Pxxl9UauHUq4pgDuXZ/RZkH3BQHAlHvlDZ3C3rXj"},"s3":{"s3SchemaVersion":"1.0","configurationId":"85153fb0-1426-494e-9c4e-ffffe0ebf520","bucket":{"name":"841154226728-us-west-2-vpcflowlog","ownerIdentity":{"principalId":"A12SQTDQCD6TT5"},"arn":"arn:aws:s3:::841154226728-us-west-2-vpcflowlog"},"object":{"key":"AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2100Z_1ce1bf4b.log.gz","size":2595,"eTag":"0557d1d84c8f071523cc7d18ebf58d5a","sequencer":"0063CC545C372D5A7F"}}}]}', 'attributes': {'ApproximateReceiveCount': '1', 'SentTimestamp': '1674335325396', 'SenderId': 'AIDAJFWZWTE5KRAMGW5A2', 'ApproximateFirstReceiveTimestamp': '1674335325404'}, 'messageAttributes': {}, 'md5OfBody': '1910f3b491509daba1ceadca474a08c8', 'md5OfMessageAttributes': None, 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-west-2:841154226728:841154226728-us-west-2-vpcflowlog-sqs-queue', 'awsRegion': 'us-west-2'}), {'bucket': '841154226728-us-west-2-vpcflowlog', 'key': 'AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2100Z_1ce1bf4b.log.gz'})
		self.assertEqual(self.lambda_module.retrieveObjectInfo({'messageId': '65dd2ea3-8dc4-42fd-a180-ac91961ea2ee', 'receiptHandle': 'AQEBGerSNcBRWgr2QMCua2Q/J0m5yeHOqgzteDgS2Hmj1ZwcmAN1jITp5M+7hBLEBkL4McwVOlJJQAbPm99HZt3AhJmLX6hSqOtF8Bm2M7uP78s02L3gU1N3/1SZheorY+HCNo7smYxXLm2uYsAU/+evxEjcZzAGUBLnXpNnwT6kiU3qWw8GQ0FTci5NmGee4lt5RJjv6j4w93xnR9XovQQ9kJhcwmavXV+J5PbTSipTecfPrZDlKCMwBP+Nkfqyt3w5amVU1jl5/joK+WaSmdLGD2Evyjd4Z+05QsuA/9s/xMsoLXbiSj43CSrhH0opLWU1m7saEHRrmZJDhe2gF4rBOB8luX2I9ZoT3xyc/jPbgo3pJSAYiOwo6GEAZMoMhKRm/hcxMteB3YtDtDh8leaIRB5++ET0ASjLi1Ms8OGuoTJrz6J5GXQTJU7Ih52Jz/PY', 'body': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-2","eventTime":"2023-01-21T21:08:44.075Z","eventName":"ObjectCreated:Put","userIdentity":{"principalId":"AWS:AROAV2CJ256E23ZOBRSAF:prod.pdx.dbs.datafeeds.aws.internal"},"requestParameters":{"sourceIPAddress":"172.19.67.123"},"responseElements":{"x-amz-request-id":"81KR386GSPPEJ1A6","x-amz-id-2":"qDVdamIDcwxeAJOnAUm4kHvzvk2HsL5aggHiz6K7UQXNaYEJrtSbd/YbLR7xD0RpSeJDueUAFyWH02WPH9j51WFH37LjjnsQ"},"s3":{"s3SchemaVersion":"1.0","configurationId":"85153fb0-1426-494e-9c4e-ffffe0ebf520","bucket":{"name":"841154226728-us-west-2-vpcflowlog","ownerIdentity":{"principalId":"A12SQTDQCD6TT5"},"arn":"arn:aws:s3:::841154226728-us-west-2-vpcflowlog"},"object":{"key":"AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz","size":2794,"eTag":"1891e0401175628854f10ee575e9bade","sequencer":"0063CC545C0877B5E6"}}}]}', 'attributes': {'ApproximateReceiveCount': '1', 'SentTimestamp': '1674335325366', 'SenderId': 'AIDAJFWZWTE5KRAMGW5A2', 'ApproximateFirstReceiveTimestamp': '1674335325369'}, 'messageAttributes': {}, 'md5OfMessageAttributes': None, 'md5OfBody': 'b3cf3151132d06b8b68cdc64ad833dd6', 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-west-2:841154226728:841154226728-us-west-2-vpcflowlog-sqs-queue', 'awsRegion': 'us-west-2'}), {'bucket': '841154226728-us-west-2-vpcflowlog', 'key': 'AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz'})

		# Test with bad paths
		self.assertEqual(self.lambda_module.retrieveObjectInfo({'messageId': '0ed4e10e-7fe3-41c8-ba7e-59b0c90826f3', 'receiptHandle': 'AQEBrbGkhIBIrdBxqc9HfoDkMkaNz7/'}), "SQS message did not contain S3 file information.  Record: {'messageId': '0ed4e10e-7fe3-41c8-ba7e-59b0c90826f3', 'receiptHandle': 'AQEBrbGkhIBIrdBxqc9HfoDkMkaNz7/'}")

	def test_validateFileType(self):
		
		# Test with unsupported files
		self.assertEqual(self.lambda_module.validateFileType("none"), "Unsupported file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.txt"), "Unsupported file type.")
		self.assertEqual(self.lambda_module.validateFileType("file.md"), "Unsupported file type.")

		# Test with supported files
		self.assertEqual(self.lambda_module.validateFileType("AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.gz"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gzip"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.gzip"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.json"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.csv"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.parquet"), "Valid file type.")

	def test_eventBreak(self):
		
		# Test with log files, removing first line 
		self.assertEqual(self.lambda_module.eventBreak("version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status\n2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK", "log", "true"), ['2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK'])

		# Test with log files, leaving first line 
		self.assertEqual(self.lambda_module.eventBreak("version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status\n2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK", "log", "false"), ['version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status', '2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK'])

		# Test with csv files, removing first line
		self.assertEqual(self.lambda_module.eventBreak('identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/abdInstanceClass,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/backupservice,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeTier,product/freeTrial,product/freeUsageIncluded,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/invocation,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/origin,product/overageType,product/packSize,product/parameterType,product/physicalCores,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragename,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/qPresent,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/scanType,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/timeWindow,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usageGroup,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage,costCategory/cc_account_department\n2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,\nl2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\nlq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', "csv", "true"), [ '2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,', 'l2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', '3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', 'lq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'])

		# Test with csv files, leaving first line
		self.assertEqual(self.lambda_module.eventBreak('identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/abdInstanceClass,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/backupservice,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeTier,product/freeTrial,product/freeUsageIncluded,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/invocation,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/origin,product/overageType,product/packSize,product/parameterType,product/physicalCores,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragename,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/qPresent,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/scanType,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/timeWindow,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usageGroup,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage,costCategory/cc_account_department\n2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,\nl2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\nlq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', "csv", "false"), ['identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/abdInstanceClass,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/backupservice,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeTier,product/freeTrial,product/freeUsageIncluded,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/invocation,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/origin,product/overageType,product/packSize,product/parameterType,product/physicalCores,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragename,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/qPresent,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/scanType,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/timeWindow,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usageGroup,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage,costCategory/cc_account_department', '2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,', 'l2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', '3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', 'lq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'])

		# Test with sourcetype set to aws:s3:accesslogs, single event
		self.lambda_module.SPLUNK_SOURCETYPE = "aws:s3:accesslogs"
		self.assertEqual(self.lambda_module.eventBreak('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', "log", "false"), ['d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -'])
		
		# Test with sourcetype set to aws:s3:accesslogs, multiple events
		self.assertEqual(self.lambda_module.eventBreak('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -\nd2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:00 +0000] 72.21.217.31 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe XMCJ5XQ4EBJT3EK9 REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - 0QBKb8tfCZm6kL6nkgdc9rrE7cGaI+YLSi+jjIrnXqAzhHkrrOFUFqMd5SDmANZsjhcWWrHWIDk= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', "log", "false"), ['d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', 'd2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:00 +0000] 72.21.217.31 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe XMCJ5XQ4EBJT3EK9 REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - 0QBKb8tfCZm6kL6nkgdc9rrE7cGaI+YLSi+jjIrnXqAzhHkrrOFUFqMd5SDmANZsjhcWWrHWIDk= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -'])

		# Test with json, eventInRecords format
		self.lambda_module.SPLUNK_SOURCETYPE = "main"
		self.lambda_module.SPLUNK_JSON_FORMAT = "eventsInRecords"

		self.assertEqual(self.lambda_module.eventBreak('{"Records":[{"eventVersion":"1.08","userIdentity":{"type":"AssumedRole","principalId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2","accountId":"841154226728","sessionContext":{"sessionIssuer":{"type":"Role","principalId":"AROA4HWFS5IUE3HEDLKDB","arn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","accountId":"841154226728","userName":"AWSServiceRoleForResourceExplorer"},"webIdFederationData":{},"attributes":{"creationDate":"2023-01-19T22:55:36Z","mfaAuthenticated":"false"}},"invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:37Z","eventSource":"ec2.amazonaws.com","eventName":"DescribeIpamPools","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"DescribeIpamPoolsRequest":{"MaxResults":100}},"responseElements":null,"requestID":"8ae007b2-7862-47a3-87b3-770ec399463f","eventID":"3957f51a-8f68-4904-8d1e-8ded7bcc1981","readOnly":true,"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","eventCategory":"Management"},{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:36Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","roleSessionName":"resource-explorer-2","durationSeconds":900},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUDU43MXDC","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4","expiration":"Jan 19, 2023, 11:10:36 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2"}},"requestID":"9244c327-8a7d-4ef9-a556-daf719faa814","eventID":"201df201-769a-4f2e-bc50-59bdc32d32d9","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"7b1d2a34-3a77-4d6d-b3fe-372d296f4652","eventCategory":"Management"},{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"cloudtrail.amazonaws.com"},"eventTime":"2023-01-19T22:57:45Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"cloudtrail.amazonaws.com","userAgent":"cloudtrail.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole","roleSessionName":"CLOUDWATCH_LOGS_DELIVERY_SESSION"},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUEMTX5T6W","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==","expiration":"Jan 19, 2023, 11:57:45 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION","arn":"arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION"}},"requestID":"30819315-12f7-49cf-a95f-2a25c904c57d","eventID":"39ec690d-bb7b-4a15-b197-c7d449489268","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"724eaa5c-900a-4695-8402-ce3bf83ee464","eventCategory":"Management"}]}', "json", "false"), [{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROA4HWFS5IUE3HEDLKDB:resource-explorer-2', 'arn': 'arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2', 'accountId': '841154226728', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROA4HWFS5IUE3HEDLKDB', 'arn': 'arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer', 'accountId': '841154226728', 'userName': 'AWSServiceRoleForResourceExplorer'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2023-01-19T22:55:36Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'resource-explorer-2.amazonaws.com'}, 'eventTime': '2023-01-19T22:55:37Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DescribeIpamPools', 'awsRegion': 'sa-east-1', 'sourceIPAddress': 'resource-explorer-2.amazonaws.com', 'userAgent': 'resource-explorer-2.amazonaws.com', 'requestParameters': {'DescribeIpamPoolsRequest': {'MaxResults': 100}}, 'responseElements': None, 'requestID': '8ae007b2-7862-47a3-87b3-770ec399463f', 'eventID': '3957f51a-8f68-4904-8d1e-8ded7bcc1981', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '841154226728', 'eventCategory': 'Management'}, {'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 'resource-explorer-2.amazonaws.com'}, 'eventTime': '2023-01-19T22:55:36Z', 'eventSource': 'sts.amazonaws.com', 'eventName': 'AssumeRole', 'awsRegion': 'sa-east-1', 'sourceIPAddress': 'resource-explorer-2.amazonaws.com', 'userAgent': 'resource-explorer-2.amazonaws.com', 'requestParameters': {'roleArn': 'arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer', 'roleSessionName': 'resource-explorer-2', 'durationSeconds': 900}, 'responseElements': {'credentials': {'accessKeyId': 'ASIA4HWFS5IUDU43MXDC', 'sessionToken': 'IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4', 'expiration': 'Jan 19, 2023, 11:10:36 PM'}, 'assumedRoleUser': {'assumedRoleId': 'AROA4HWFS5IUE3HEDLKDB:resource-explorer-2', 'arn': 'arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2'}}, 'requestID': '9244c327-8a7d-4ef9-a556-daf719faa814', 'eventID': '201df201-769a-4f2e-bc50-59bdc32d32d9', 'readOnly': True, 'resources': [{'accountId': '841154226728', 'type': 'AWS::IAM::Role', 'ARN': 'arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '841154226728', 'sharedEventID': '7b1d2a34-3a77-4d6d-b3fe-372d296f4652', 'eventCategory': 'Management'}, {'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 'cloudtrail.amazonaws.com'}, 'eventTime': '2023-01-19T22:57:45Z', 'eventSource': 'sts.amazonaws.com', 'eventName': 'AssumeRole', 'awsRegion': 'sa-east-1', 'sourceIPAddress': 'cloudtrail.amazonaws.com', 'userAgent': 'cloudtrail.amazonaws.com', 'requestParameters': {'roleArn': 'arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole', 'roleSessionName': 'CLOUDWATCH_LOGS_DELIVERY_SESSION'}, 'responseElements': {'credentials': {'accessKeyId': 'ASIA4HWFS5IUEMTX5T6W', 'sessionToken': 'IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==', 'expiration': 'Jan 19, 2023, 11:57:45 PM'}, 'assumedRoleUser': {'assumedRoleId': 'AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION', 'arn': 'arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION'}}, 'requestID': '30819315-12f7-49cf-a95f-2a25c904c57d', 'eventID': '39ec690d-bb7b-4a15-b197-c7d449489268', 'readOnly': True, 'resources': [{'accountId': '841154226728', 'type': 'AWS::IAM::Role', 'ARN': 'arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '841154226728', 'sharedEventID': '724eaa5c-900a-4695-8402-ce3bf83ee464', 'eventCategory': 'Management'}])

		# Test with json, NDJSON format
		self.lambda_module.SPLUNK_JSON_FORMAT = "NDJSON"
		self.assertEqual(self.lambda_module.eventBreak('{"eventVersion":"1.08","userIdentity":{"type":"AssumedRole","principalId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2","accountId":"841154226728","sessionContext":{"sessionIssuer":{"type":"Role","principalId":"AROA4HWFS5IUE3HEDLKDB","arn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","accountId":"841154226728","userName":"AWSServiceRoleForResourceExplorer"},"webIdFederationData":{},"attributes":{"creationDate":"2023-01-19T22:55:36Z","mfaAuthenticated":"false"}},"invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:37Z","eventSource":"ec2.amazonaws.com","eventName":"DescribeIpamPools","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"DescribeIpamPoolsRequest":{"MaxResults":100}},"responseElements":null,"requestID":"8ae007b2-7862-47a3-87b3-770ec399463f","eventID":"3957f51a-8f68-4904-8d1e-8ded7bcc1981","readOnly":true,"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","eventCategory":"Management"}\n{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:36Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","roleSessionName":"resource-explorer-2","durationSeconds":900},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUDU43MXDC","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4","expiration":"Jan 19, 2023, 11:10:36 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2"}},"requestID":"9244c327-8a7d-4ef9-a556-daf719faa814","eventID":"201df201-769a-4f2e-bc50-59bdc32d32d9","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"7b1d2a34-3a77-4d6d-b3fe-372d296f4652","eventCategory":"Management"}\n{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"cloudtrail.amazonaws.com"},"eventTime":"2023-01-19T22:57:45Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"cloudtrail.amazonaws.com","userAgent":"cloudtrail.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole","roleSessionName":"CLOUDWATCH_LOGS_DELIVERY_SESSION"},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUEMTX5T6W","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==","expiration":"Jan 19, 2023, 11:57:45 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION","arn":"arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION"}},"requestID":"30819315-12f7-49cf-a95f-2a25c904c57d","eventID":"39ec690d-bb7b-4a15-b197-c7d449489268","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"724eaa5c-900a-4695-8402-ce3bf83ee464","eventCategory":"Management"}', "json", "false"), ['{"eventVersion":"1.08","userIdentity":{"type":"AssumedRole","principalId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2","accountId":"841154226728","sessionContext":{"sessionIssuer":{"type":"Role","principalId":"AROA4HWFS5IUE3HEDLKDB","arn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","accountId":"841154226728","userName":"AWSServiceRoleForResourceExplorer"},"webIdFederationData":{},"attributes":{"creationDate":"2023-01-19T22:55:36Z","mfaAuthenticated":"false"}},"invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:37Z","eventSource":"ec2.amazonaws.com","eventName":"DescribeIpamPools","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"DescribeIpamPoolsRequest":{"MaxResults":100}},"responseElements":null,"requestID":"8ae007b2-7862-47a3-87b3-770ec399463f","eventID":"3957f51a-8f68-4904-8d1e-8ded7bcc1981","readOnly":true,"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","eventCategory":"Management"}', '{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:36Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","roleSessionName":"resource-explorer-2","durationSeconds":900},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUDU43MXDC","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4","expiration":"Jan 19, 2023, 11:10:36 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2"}},"requestID":"9244c327-8a7d-4ef9-a556-daf719faa814","eventID":"201df201-769a-4f2e-bc50-59bdc32d32d9","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"7b1d2a34-3a77-4d6d-b3fe-372d296f4652","eventCategory":"Management"}', '{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"cloudtrail.amazonaws.com"},"eventTime":"2023-01-19T22:57:45Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"cloudtrail.amazonaws.com","userAgent":"cloudtrail.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole","roleSessionName":"CLOUDWATCH_LOGS_DELIVERY_SESSION"},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUEMTX5T6W","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==","expiration":"Jan 19, 2023, 11:57:45 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION","arn":"arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION"}},"requestID":"30819315-12f7-49cf-a95f-2a25c904c57d","eventID":"39ec690d-bb7b-4a15-b197-c7d449489268","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"724eaa5c-900a-4695-8402-ce3bf83ee464","eventCategory":"Management"}'])

	def test_cleanFirstLine(self):

		# Test with default sourcetype, should not change records
		self.assertEqual(self.lambda_module.cleanFirstLine(['version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 33910 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 91.240.118.245 172.21.12.101 54792 3414 6 1 40 1666655969 1666655995 REJECT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 44024 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.223.109.193 38608 443 6 7 539 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.223.109.193 172.21.12.101 443 38608 6 10 675 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 54.192.76.118 172.21.12.101 443 56238 6 11 6829 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.223.109.193 172.21.12.101 443 59154 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 5.8.18.58 172.21.12.101 54775 10623 6 1 40 1666655969 1666655995 REJECT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.208.215.234 44024 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 192.73.240.132 41641 3478 17 2 136 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 192.73.252.65 172.21.12.101 3478 41641 17 1 72 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 52.94.181.224 172.21.12.101 443 45320 6 20 6719 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.225.203.212 60974 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 52.94.181.224 45320 443 6 20 3269 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.223.109.193 172.21.12.101 443 57994 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 192.73.242.204 41641 3478 17 2 136 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 98.225.75.79 41641 41648 17 282 104132 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 98.225.75.79 172.21.12.101 41648 41641 17 285 63974 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 52.43.162.85 9997 57818 6 173 11620 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.225.203.212 33910 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 203.0.113.1 58070 12345 17 1 101 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 60974 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 78.128.112.170 172.21.12.101 55754 57539 6 1 40 1666655969 1666655995 REJECT OK','2 841154226728 eni-0b48139ba00b9b7bb 192.73.242.204 172.21.12.101 3478 41641 17 2 144 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 54.192.76.118 56238 443 6 10 1192 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.223.109.193 59154 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 52.43.162.85 172.21.12.101 57818 9997 6 819 1162439 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 192.73.240.132 172.21.12.101 3478 41641 17 2 144 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 192.73.252.65 41641 3478 17 1 68 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.223.109.193 57994 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 208.111.34.178 172.21.12.101 3478 41641 17 2 144 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 208.111.34.178 41641 3478 17 2 136 1666655969 1666655995 ACCEPT OK']), ['version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 33910 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 91.240.118.245 172.21.12.101 54792 3414 6 1 40 1666655969 1666655995 REJECT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 44024 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.223.109.193 38608 443 6 7 539 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.223.109.193 172.21.12.101 443 38608 6 10 675 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 54.192.76.118 172.21.12.101 443 56238 6 11 6829 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.223.109.193 172.21.12.101 443 59154 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 5.8.18.58 172.21.12.101 54775 10623 6 1 40 1666655969 1666655995 REJECT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.208.215.234 44024 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 192.73.240.132 41641 3478 17 2 136 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 192.73.252.65 172.21.12.101 3478 41641 17 1 72 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 52.94.181.224 172.21.12.101 443 45320 6 20 6719 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.225.203.212 60974 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 52.94.181.224 45320 443 6 20 3269 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.223.109.193 172.21.12.101 443 57994 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 192.73.242.204 41641 3478 17 2 136 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 98.225.75.79 41641 41648 17 282 104132 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 98.225.75.79 172.21.12.101 41648 41641 17 285 63974 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 52.43.162.85 9997 57818 6 173 11620 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.225.203.212 33910 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 203.0.113.1 58070 12345 17 1 101 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 60974 6 11 4832 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 78.128.112.170 172.21.12.101 55754 57539 6 1 40 1666655969 1666655995 REJECT OK','2 841154226728 eni-0b48139ba00b9b7bb 192.73.242.204 172.21.12.101 3478 41641 17 2 144 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 54.192.76.118 56238 443 6 10 1192 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.223.109.193 59154 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 52.43.162.85 172.21.12.101 57818 9997 6 819 1162439 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 192.73.240.132 172.21.12.101 3478 41641 17 2 144 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 192.73.252.65 41641 3478 17 1 68 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 3.223.109.193 57994 443 6 10 1450 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 208.111.34.178 172.21.12.101 3478 41641 17 2 144 1666655969 1666655995 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 208.111.34.178 41641 3478 17 2 136 1666655969 1666655995 ACCEPT OK'])
	
		# Test with sourcetype of aws:billing:cur, should change records
		self.lambda_module.SPLUNK_SOURCETYPE = "aws:billing:cur"
		self.assertEqual(self.lambda_module.cleanFirstLine(['identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/accessType,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/describes,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeQueryTypes,product/freeTier,product/freeTrial,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/opsItems,product/origin,product/overageType,product/parameterType,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceAssessment,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/softwareType,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage']), ['LineItemId,TimeInterval,InvoiceId,InvoicingEntity,BillingEntity,BillType,PayerAccountId,BillingPeriodStartDate,BillingPeriodEndDate,UsageAccountId,LineItemType,UsageStartDate,UsageEndDate,ProductCode,UsageType,Operation,AvailabilityZone,ResourceId,UsageAmount,NormalizationFactor,NormalizedUsageAmount,CurrencyCode,UnblendedRate,UnblendedCost,BlendedRate,BlendedCost,LineItemDescription,TaxType,LegalEntity,ProductName,accessType,alarmType,attachmentType,availability,availabilityZone,brokerEngine,bundle,bundleDescription,bundleGroup,cacheEngine,callingType,capacity,capacitystatus,category,ciType,classicnetworkingsupport,clientLocation,clockSpeed,component,computeType,connectionType,contentType,country,countsAgainstQuota,cputype,currentGeneration,data,dataTransferQuota,dataType,databaseEdition,databaseEngine,datatransferout,dedicatedEbsThroughput,deploymentOption,describes,description,device,deviceType,directConnectLocation,directorySize,directoryType,directoryTypeDescription,dominantnondominant,durability,ecu,edition,endpoint,endpointType,engineCode,enhancedNetworkingSupport,enhancedNetworkingSupported,equivalentondemandsku,eventType,feeCode,feeDescription,findingGroup,findingSource,findingStorage,freeOverage,freeQueryTypes,freeTier,freeTrial,fromLocation,fromLocationType,fromRegionCode,fusfCategory,georegioncode,gets,gpu,gpuMemory,group,groupDescription,insightstype,instance,instanceFamily,instanceFunction,instanceName,instanceType,instanceTypeFamily,instances,intelAvx2Available,intelAvxAvailable,intelTurboAvailable,io,license,licenseModel,lineType,location,locationType,lockeprofiles,logsDestination,mailboxStorage,marketoption,maxIopsBurstPerformance,maxIopsvolume,maxThroughputvolume,maxVolumeSize,maximumExtendedStorage,maximumStorageVolume,memory,memoryGib,memorytype,messageDeliveryFrequency,messageDeliveryOrder,meteringType,minVolumeSize,minimumStorageVolume,networkPerformance,normalizationSizeFactor,operatingSystem,operation,opsItems,origin,overageType,parameterType,physicalCpu,physicalGpu,physicalProcessor,platoclassificationtype,platodataanalyzedtype,platofeaturetype,platoinstancename,platoinstancetype,platopricingtype,platoprotocoltype,platostoragetype,platotrafficdirection,platotransfertype,platousagetype,platovolumetype,portSpeed,preInstalledSw,pricingUnit,primaryplaceofuse,processorArchitecture,processorFeatures,productFamily,productType,provisioned,queueType,recipient,region,regionCode,requestDescription,requestType,resourceAssessment,resourceEndpoint,resourcePriceGroup,resourceType,rootvolume,routingTarget,routingType,runningMode,servicecode,servicename,size,sku,snapshotarchivefeetype,softwareIncluded,softwareType,standardGroup,standardStorage,standardStorageRetentionIncluded,steps,storage,storageClass,storageMedia,storageType,subscriptionType,tenancy,throughput,throughputClass,tickettype,tiertype,toLocation,toLocationType,toRegionCode,trafficDirection,transactionType,transferType,type,updates,usageFamily,usagetype,uservolume,vcpu,version,virtualInterfaceType,volumeApiName,volumeType,vpcnetworkingsupport,withActiveUsers,LeaseContractLength,OfferingClass,PurchaseOption,RateCode,RateId,currency,publicOnDemandCost,publicOnDemandRate,term,unit,AmortizedUpfrontCostForUsage,AmortizedUpfrontFeeForBillingPeriod,EffectiveCost,EndTime,ModificationStatus,NormalizedUnitsPerReservation,NumberOfReservations,RecurringFeeForUsage,ReservationARN,StartTime,SubscriptionId,TotalReservedNormalizedUnits,TotalReservedUnits,UnitsPerReservation,UnusedAmortizedUpfrontFeeForBillingPeriod,UnusedNormalizedUnitQuantity,UnusedQuantity,UnusedRecurringFee,UpfrontValue,TotalCommitmentToDate,SavingsPlanARN,SavingsPlanRate,UsedCommitment,SavingsPlanEffectiveCost,AmortizedUpfrontCommitmentForBillingPeriod,RecurringCommitmentForBillingPeriod,aws:cloudformation:logical-id,aws:cloudformation:stack-id,aws:cloudformation:stack-name,aws:createdBy,user:AMI,user:Application,user:Area,user:Author,user:Backup,user:BlockDevice,user:BuildUser,user:Cluster,user:Created,user:CreatedBy,user:Customer,user:CustomerType,user:DNS,user:Desc,user:Description,user:Device,user:ELB,user:Email,user:Environment,user:EventCount,user:FQDN,user:Host,user:Hostname,user:Infra,user:InstanceId,user:Instructor,user:Label,user:Life,user:NAME,user:Name,user:Network,user:Note,user:OS,user:Owner,user:PAAS_CREATED_BY,user:PAAS_LIFETIME_DAYS,user:PAAS_OS,user:PAAS_SCHEDULE,user:PAAS_TZ,user:Plan,user:Project,user:PurgeAfterFE,user:PurgeAllow,user:Purpose,user:Release,user:Role,user:Server,user:SnapShotGroupId,user:SnapTestRunId,user:Splunk,user:Stack,user:StackName,user:Stage,user:Status,user:Subdomain,user:TEST,user:Team,user:Test,user:Ticket,user:Timestamp,user:Type,user:USER,user:Usage,user:Use,user:User,user:ValidationData,user:VerStackMakr,user:Volume,user:ami,user:ami_name,user:app,user:appversion,user:arch,user:area,user:class,user:cluster,user:createdBy,user:creator,user:customer,user:customer_type,user:desc,user:description,user:device_name,user:environment,user:fqdn,user:group,user:host,user:hostname,user:instructor,user:jenkins_slave_type,user:job_id,user:job_name,user:key1,user:key2,user:key_pair_id,user:mode,user:name,user:org,user:origin,user:os,user:project,user:purpose,user:region,user:role,user:sp_connection_id,user:splunkit.io/department/code,user:splunkit.io/os/version,user:splunkit.io/user/email,user:splunkit.io/user/isPartner,user:splunkit/app,user:splunkit/application,user:splunkit/department,user:splunkit/dept,user:splunkit/env,user:splunkit/environment,user:splunkit/instance,user:splunkit/name,user:splunkit/owner,user:splunkit/provider,user:splunkit/provisioner,user:splunkit/resource,user:splunkit/team,user:splunkit/ttl,user:splunkit/uri,user:stack,user:stack_id,user:stack_version,user:stage,user:status,user:storage,user:storm_raid,user:subnet,user:tag,user:tag1,user:target,user:team,user:test,user:type,user:uri,user:usage'])
		self.assertEqual(self.lambda_module.cleanFirstLine(['identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/accessType,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/describes,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeQueryTypes,product/freeTier,product/freeTrial,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/opsItems,product/origin,product/overageType,product/parameterType,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceAssessment,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/softwareType,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage','gxhsea5ks3hqkd4izpcztt3bbyodqrtv2e6c3pji335vli227ffa,2022-07-01T09:00:00Z/2022-07-01T10:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T09:00:00Z,2022-07-01T10:00:00Z,awskms,eu-central-1-KMS-Requests,GetKeyPolicy,,arn:aws:kms:eu-central-1:841154226728:key/566da3aa-ee78-4256-af4b-ae6d197d7e5e,1.0000000000,,,USD,0.0000030000,0.0000030000,0.0000030000,0.0000030000,$0.03 per 10000 KMS requests in EU (Frankfurt),,"Amazon Web Services, Inc.",AWS Key Management Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,awskms-APIRequest-All,All AWS KMS API requests,,,,,,,,,,,,,,,,EU (Frankfurt),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,API Request,,,,,eu-central-1,eu-central-1,,,,,,,,,,,awskms,AWS Key Management Service,,4H6XVYZMMD8MKVZD,,,,,,,,,,,,,,,,,,,,,,,,,,,eu-central-1-KMS-Requests,,,,,,,,,,,,4H6XVYZMMD8MKVZD.JRTCKXETXF.6YS6EN2CT7,7579438446,USD,0.0000030000,0.0000030000,OnDemand,Requests,,,,,,,,,,,8592851312,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','yohlkjq2fglidlmcveuvoqwvyyxxavydhildvtudifnxqij3shtq,2022-07-01T17:00:00Z/2022-07-01T18:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T17:00:00Z,2022-07-01T18:00:00Z,AmazonKinesisFirehose,USW2-BilledBytes,PutRecordBatch,,arn:aws:firehose:us-west-2:841154226728:deliverystream/841154226728-us-west-2-cloudtrail-firehose,0.0029754639,,,USD,0.0290000000,0.0000862885,0.0290000000,0.0000862885,Tier 1 $0.029 per GB of data ingested,,"Amazon Web Services, Inc.",Amazon Kinesis Firehose,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Per GB of data ingested,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Batch Processing,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,PutRecordBatch,,,,,,,,,,,,,,,,,,,,,,,,,,Kinesis Firehose,,,,,us-west-2,us-west-2,,,,,,,,,,,AmazonKinesisFirehose,Amazon Kinesis Firehose,,5267PTSYZKCEH8SQ,,,,,,,,,,,,,,,,1,,,,,,,,,,,USW2-BilledBytes,,,,,,,,,,,,5267PTSYZKCEH8SQ.JRTCKXETXF.HK3AFRJD7J,6906152730,USD,0.0000862885,0.0290000000,OnDemand,GB,,,,,,,,,,,8592851340,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','y2i7wrj74nmhzgulowyenmeaw5fdmv6v725hcp2yvlxt5ltnqrnq,2022-07-01T04:00:00Z/2022-07-01T05:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T04:00:00Z,2022-07-01T05:00:00Z,AWSCloudTrail,USW2-FreeEventsRecorded,None,,,125.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in US West (Oregon) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,us-west-2,us-west-2,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,57SQQK7HQMW76PRE,,,,,,,,,,,,,,,,,,,,,,,,,,,USW2-FreeEventsRecorded,,,,,,,,,,,,57SQQK7HQMW76PRE.JRTCKXETXF.6YS6EN2CT7,7994477393,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','5vjom4j4ffg2vsgm6druoqtc43tctnz55s2acmgtgg3k6hhawq2q,2022-07-01T07:00:00Z/2022-07-01T08:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T07:00:00Z,2022-07-01T08:00:00Z,AmazonEC2,USW2-DataTransfer-Regional-Bytes,PublicIP-In,,i-0f7700bc526d074e9,0.0033566216,,,USD,0.0030000000,0.0000100699,0.0030000000,0.0000100699,$0.003 per GB - regional data transfer - in/out/between EC2 AZs or using elastic IPs or ELB,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,62WNQUZDQQ6GRJC5,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,IntraRegion,,,,USW2-DataTransfer-Regional-Bytes,,,,,,,,,,,,62WNQUZDQQ6GRJC5.JRTCKXETXF.6YS6EN2CT7,7740772210,USD,0.0000335662,0.0100000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/preeves-k3s-worker1/ac6e2480-d62b-11ec-9c70-0afdd06c1fa1,preeves-k3s-worker1,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,preeves-k3s-worker1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,']), ['LineItemId,TimeInterval,InvoiceId,InvoicingEntity,BillingEntity,BillType,PayerAccountId,BillingPeriodStartDate,BillingPeriodEndDate,UsageAccountId,LineItemType,UsageStartDate,UsageEndDate,ProductCode,UsageType,Operation,AvailabilityZone,ResourceId,UsageAmount,NormalizationFactor,NormalizedUsageAmount,CurrencyCode,UnblendedRate,UnblendedCost,BlendedRate,BlendedCost,LineItemDescription,TaxType,LegalEntity,ProductName,accessType,alarmType,attachmentType,availability,availabilityZone,brokerEngine,bundle,bundleDescription,bundleGroup,cacheEngine,callingType,capacity,capacitystatus,category,ciType,classicnetworkingsupport,clientLocation,clockSpeed,component,computeType,connectionType,contentType,country,countsAgainstQuota,cputype,currentGeneration,data,dataTransferQuota,dataType,databaseEdition,databaseEngine,datatransferout,dedicatedEbsThroughput,deploymentOption,describes,description,device,deviceType,directConnectLocation,directorySize,directoryType,directoryTypeDescription,dominantnondominant,durability,ecu,edition,endpoint,endpointType,engineCode,enhancedNetworkingSupport,enhancedNetworkingSupported,equivalentondemandsku,eventType,feeCode,feeDescription,findingGroup,findingSource,findingStorage,freeOverage,freeQueryTypes,freeTier,freeTrial,fromLocation,fromLocationType,fromRegionCode,fusfCategory,georegioncode,gets,gpu,gpuMemory,group,groupDescription,insightstype,instance,instanceFamily,instanceFunction,instanceName,instanceType,instanceTypeFamily,instances,intelAvx2Available,intelAvxAvailable,intelTurboAvailable,io,license,licenseModel,lineType,location,locationType,lockeprofiles,logsDestination,mailboxStorage,marketoption,maxIopsBurstPerformance,maxIopsvolume,maxThroughputvolume,maxVolumeSize,maximumExtendedStorage,maximumStorageVolume,memory,memoryGib,memorytype,messageDeliveryFrequency,messageDeliveryOrder,meteringType,minVolumeSize,minimumStorageVolume,networkPerformance,normalizationSizeFactor,operatingSystem,operation,opsItems,origin,overageType,parameterType,physicalCpu,physicalGpu,physicalProcessor,platoclassificationtype,platodataanalyzedtype,platofeaturetype,platoinstancename,platoinstancetype,platopricingtype,platoprotocoltype,platostoragetype,platotrafficdirection,platotransfertype,platousagetype,platovolumetype,portSpeed,preInstalledSw,pricingUnit,primaryplaceofuse,processorArchitecture,processorFeatures,productFamily,productType,provisioned,queueType,recipient,region,regionCode,requestDescription,requestType,resourceAssessment,resourceEndpoint,resourcePriceGroup,resourceType,rootvolume,routingTarget,routingType,runningMode,servicecode,servicename,size,sku,snapshotarchivefeetype,softwareIncluded,softwareType,standardGroup,standardStorage,standardStorageRetentionIncluded,steps,storage,storageClass,storageMedia,storageType,subscriptionType,tenancy,throughput,throughputClass,tickettype,tiertype,toLocation,toLocationType,toRegionCode,trafficDirection,transactionType,transferType,type,updates,usageFamily,usagetype,uservolume,vcpu,version,virtualInterfaceType,volumeApiName,volumeType,vpcnetworkingsupport,withActiveUsers,LeaseContractLength,OfferingClass,PurchaseOption,RateCode,RateId,currency,publicOnDemandCost,publicOnDemandRate,term,unit,AmortizedUpfrontCostForUsage,AmortizedUpfrontFeeForBillingPeriod,EffectiveCost,EndTime,ModificationStatus,NormalizedUnitsPerReservation,NumberOfReservations,RecurringFeeForUsage,ReservationARN,StartTime,SubscriptionId,TotalReservedNormalizedUnits,TotalReservedUnits,UnitsPerReservation,UnusedAmortizedUpfrontFeeForBillingPeriod,UnusedNormalizedUnitQuantity,UnusedQuantity,UnusedRecurringFee,UpfrontValue,TotalCommitmentToDate,SavingsPlanARN,SavingsPlanRate,UsedCommitment,SavingsPlanEffectiveCost,AmortizedUpfrontCommitmentForBillingPeriod,RecurringCommitmentForBillingPeriod,aws:cloudformation:logical-id,aws:cloudformation:stack-id,aws:cloudformation:stack-name,aws:createdBy,user:AMI,user:Application,user:Area,user:Author,user:Backup,user:BlockDevice,user:BuildUser,user:Cluster,user:Created,user:CreatedBy,user:Customer,user:CustomerType,user:DNS,user:Desc,user:Description,user:Device,user:ELB,user:Email,user:Environment,user:EventCount,user:FQDN,user:Host,user:Hostname,user:Infra,user:InstanceId,user:Instructor,user:Label,user:Life,user:NAME,user:Name,user:Network,user:Note,user:OS,user:Owner,user:PAAS_CREATED_BY,user:PAAS_LIFETIME_DAYS,user:PAAS_OS,user:PAAS_SCHEDULE,user:PAAS_TZ,user:Plan,user:Project,user:PurgeAfterFE,user:PurgeAllow,user:Purpose,user:Release,user:Role,user:Server,user:SnapShotGroupId,user:SnapTestRunId,user:Splunk,user:Stack,user:StackName,user:Stage,user:Status,user:Subdomain,user:TEST,user:Team,user:Test,user:Ticket,user:Timestamp,user:Type,user:USER,user:Usage,user:Use,user:User,user:ValidationData,user:VerStackMakr,user:Volume,user:ami,user:ami_name,user:app,user:appversion,user:arch,user:area,user:class,user:cluster,user:createdBy,user:creator,user:customer,user:customer_type,user:desc,user:description,user:device_name,user:environment,user:fqdn,user:group,user:host,user:hostname,user:instructor,user:jenkins_slave_type,user:job_id,user:job_name,user:key1,user:key2,user:key_pair_id,user:mode,user:name,user:org,user:origin,user:os,user:project,user:purpose,user:region,user:role,user:sp_connection_id,user:splunkit.io/department/code,user:splunkit.io/os/version,user:splunkit.io/user/email,user:splunkit.io/user/isPartner,user:splunkit/app,user:splunkit/application,user:splunkit/department,user:splunkit/dept,user:splunkit/env,user:splunkit/environment,user:splunkit/instance,user:splunkit/name,user:splunkit/owner,user:splunkit/provider,user:splunkit/provisioner,user:splunkit/resource,user:splunkit/team,user:splunkit/ttl,user:splunkit/uri,user:stack,user:stack_id,user:stack_version,user:stage,user:status,user:storage,user:storm_raid,user:subnet,user:tag,user:tag1,user:target,user:team,user:test,user:type,user:uri,user:usage','gxhsea5ks3hqkd4izpcztt3bbyodqrtv2e6c3pji335vli227ffa,2022-07-01T09:00:00Z/2022-07-01T10:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T09:00:00Z,2022-07-01T10:00:00Z,awskms,eu-central-1-KMS-Requests,GetKeyPolicy,,arn:aws:kms:eu-central-1:841154226728:key/566da3aa-ee78-4256-af4b-ae6d197d7e5e,1.0000000000,,,USD,0.0000030000,0.0000030000,0.0000030000,0.0000030000,$0.03 per 10000 KMS requests in EU (Frankfurt),,"Amazon Web Services, Inc.",AWS Key Management Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,awskms-APIRequest-All,All AWS KMS API requests,,,,,,,,,,,,,,,,EU (Frankfurt),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,API Request,,,,,eu-central-1,eu-central-1,,,,,,,,,,,awskms,AWS Key Management Service,,4H6XVYZMMD8MKVZD,,,,,,,,,,,,,,,,,,,,,,,,,,,eu-central-1-KMS-Requests,,,,,,,,,,,,4H6XVYZMMD8MKVZD.JRTCKXETXF.6YS6EN2CT7,7579438446,USD,0.0000030000,0.0000030000,OnDemand,Requests,,,,,,,,,,,8592851312,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','yohlkjq2fglidlmcveuvoqwvyyxxavydhildvtudifnxqij3shtq,2022-07-01T17:00:00Z/2022-07-01T18:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T17:00:00Z,2022-07-01T18:00:00Z,AmazonKinesisFirehose,USW2-BilledBytes,PutRecordBatch,,arn:aws:firehose:us-west-2:841154226728:deliverystream/841154226728-us-west-2-cloudtrail-firehose,0.0029754639,,,USD,0.0290000000,0.0000862885,0.0290000000,0.0000862885,Tier 1 $0.029 per GB of data ingested,,"Amazon Web Services, Inc.",Amazon Kinesis Firehose,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Per GB of data ingested,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Batch Processing,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,PutRecordBatch,,,,,,,,,,,,,,,,,,,,,,,,,,Kinesis Firehose,,,,,us-west-2,us-west-2,,,,,,,,,,,AmazonKinesisFirehose,Amazon Kinesis Firehose,,5267PTSYZKCEH8SQ,,,,,,,,,,,,,,,,1,,,,,,,,,,,USW2-BilledBytes,,,,,,,,,,,,5267PTSYZKCEH8SQ.JRTCKXETXF.HK3AFRJD7J,6906152730,USD,0.0000862885,0.0290000000,OnDemand,GB,,,,,,,,,,,8592851340,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','y2i7wrj74nmhzgulowyenmeaw5fdmv6v725hcp2yvlxt5ltnqrnq,2022-07-01T04:00:00Z/2022-07-01T05:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T04:00:00Z,2022-07-01T05:00:00Z,AWSCloudTrail,USW2-FreeEventsRecorded,None,,,125.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in US West (Oregon) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,us-west-2,us-west-2,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,57SQQK7HQMW76PRE,,,,,,,,,,,,,,,,,,,,,,,,,,,USW2-FreeEventsRecorded,,,,,,,,,,,,57SQQK7HQMW76PRE.JRTCKXETXF.6YS6EN2CT7,7994477393,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','5vjom4j4ffg2vsgm6druoqtc43tctnz55s2acmgtgg3k6hhawq2q,2022-07-01T07:00:00Z/2022-07-01T08:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T07:00:00Z,2022-07-01T08:00:00Z,AmazonEC2,USW2-DataTransfer-Regional-Bytes,PublicIP-In,,i-0f7700bc526d074e9,0.0033566216,,,USD,0.0030000000,0.0000100699,0.0030000000,0.0000100699,$0.003 per GB - regional data transfer - in/out/between EC2 AZs or using elastic IPs or ELB,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,62WNQUZDQQ6GRJC5,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,IntraRegion,,,,USW2-DataTransfer-Regional-Bytes,,,,,,,,,,,,62WNQUZDQQ6GRJC5.JRTCKXETXF.6YS6EN2CT7,7740772210,USD,0.0000335662,0.0100000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/preeves-k3s-worker1/ac6e2480-d62b-11ec-9c70-0afdd06c1fa1,preeves-k3s-worker1,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,preeves-k3s-worker1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'])

	def test_csvToJSON(self):

		self.lambda_module.SPLUNK_CSV_TO_JSON = "true"

		# Test without removing empty rows
		self.assertEqual(self.lambda_module.csvToJSON(['identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/accessType,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/describes,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeQueryTypes,product/freeTier,product/freeTrial,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/opsItems,product/origin,product/overageType,product/parameterType,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceAssessment,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/softwareType,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage','gxhsea5ks3hqkd4izpcztt3bbyodqrtv2e6c3pji335vli227ffa,2022-07-01T09:00:00Z/2022-07-01T10:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T09:00:00Z,2022-07-01T10:00:00Z,awskms,eu-central-1-KMS-Requests,GetKeyPolicy,,arn:aws:kms:eu-central-1:841154226728:key/566da3aa-ee78-4256-af4b-ae6d197d7e5e,1.0000000000,,,USD,0.0000030000,0.0000030000,0.0000030000,0.0000030000,$0.03 per 10000 KMS requests in EU (Frankfurt),,"Amazon Web Services, Inc.",AWS Key Management Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,awskms-APIRequest-All,All AWS KMS API requests,,,,,,,,,,,,,,,,EU (Frankfurt),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,API Request,,,,,eu-central-1,eu-central-1,,,,,,,,,,,awskms,AWS Key Management Service,,4H6XVYZMMD8MKVZD,,,,,,,,,,,,,,,,,,,,,,,,,,,eu-central-1-KMS-Requests,,,,,,,,,,,,4H6XVYZMMD8MKVZD.JRTCKXETXF.6YS6EN2CT7,7579438446,USD,0.0000030000,0.0000030000,OnDemand,Requests,,,,,,,,,,,8592851312,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','yohlkjq2fglidlmcveuvoqwvyyxxavydhildvtudifnxqij3shtq,2022-07-01T17:00:00Z/2022-07-01T18:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T17:00:00Z,2022-07-01T18:00:00Z,AmazonKinesisFirehose,USW2-BilledBytes,PutRecordBatch,,arn:aws:firehose:us-west-2:841154226728:deliverystream/841154226728-us-west-2-cloudtrail-firehose,0.0029754639,,,USD,0.0290000000,0.0000862885,0.0290000000,0.0000862885,Tier 1 $0.029 per GB of data ingested,,"Amazon Web Services, Inc.",Amazon Kinesis Firehose,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Per GB of data ingested,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Batch Processing,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,PutRecordBatch,,,,,,,,,,,,,,,,,,,,,,,,,,Kinesis Firehose,,,,,us-west-2,us-west-2,,,,,,,,,,,AmazonKinesisFirehose,Amazon Kinesis Firehose,,5267PTSYZKCEH8SQ,,,,,,,,,,,,,,,,1,,,,,,,,,,,USW2-BilledBytes,,,,,,,,,,,,5267PTSYZKCEH8SQ.JRTCKXETXF.HK3AFRJD7J,6906152730,USD,0.0000862885,0.0290000000,OnDemand,GB,,,,,,,,,,,8592851340,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','y2i7wrj74nmhzgulowyenmeaw5fdmv6v725hcp2yvlxt5ltnqrnq,2022-07-01T04:00:00Z/2022-07-01T05:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T04:00:00Z,2022-07-01T05:00:00Z,AWSCloudTrail,USW2-FreeEventsRecorded,None,,,125.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in US West (Oregon) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,us-west-2,us-west-2,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,57SQQK7HQMW76PRE,,,,,,,,,,,,,,,,,,,,,,,,,,,USW2-FreeEventsRecorded,,,,,,,,,,,,57SQQK7HQMW76PRE.JRTCKXETXF.6YS6EN2CT7,7994477393,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','5vjom4j4ffg2vsgm6druoqtc43tctnz55s2acmgtgg3k6hhawq2q,2022-07-01T07:00:00Z/2022-07-01T08:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T07:00:00Z,2022-07-01T08:00:00Z,AmazonEC2,USW2-DataTransfer-Regional-Bytes,PublicIP-In,,i-0f7700bc526d074e9,0.0033566216,,,USD,0.0030000000,0.0000100699,0.0030000000,0.0000100699,$0.003 per GB - regional data transfer - in/out/between EC2 AZs or using elastic IPs or ELB,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,62WNQUZDQQ6GRJC5,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,IntraRegion,,,,USW2-DataTransfer-Regional-Bytes,,,,,,,,,,,,62WNQUZDQQ6GRJC5.JRTCKXETXF.6YS6EN2CT7,7740772210,USD,0.0000335662,0.0100000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/preeves-k3s-worker1/ac6e2480-d62b-11ec-9c70-0afdd06c1fa1,preeves-k3s-worker1,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,preeves-k3s-worker1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,']), [{'identity/LineItemId': 'gxhsea5ks3hqkd4izpcztt3bbyodqrtv2e6c3pji335vli227ffa', 'identity/TimeInterval': '2022-07-01T09:00:00Z/2022-07-01T10:00:00Z', 'bill/InvoiceId': '', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T09:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T10:00:00Z', 'lineItem/ProductCode': 'awskms', 'lineItem/UsageType': 'eu-central-1-KMS-Requests', 'lineItem/Operation': 'GetKeyPolicy', 'lineItem/AvailabilityZone': '', 'lineItem/ResourceId': 'arn:aws:kms:eu-central-1:841154226728:key/566da3aa-ee78-4256-af4b-ae6d197d7e5e', 'lineItem/UsageAmount': '1.0000000000', 'lineItem/NormalizationFactor': '', 'lineItem/NormalizedUsageAmount': '', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0000030000', 'lineItem/UnblendedCost': '0.0000030000', 'lineItem/BlendedRate': '0.0000030000', 'lineItem/BlendedCost': '0.0000030000', 'lineItem/LineItemDescription': '$0.03 per 10000 KMS requests in EU (Frankfurt)', 'lineItem/TaxType': '', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'AWS Key Management Service', 'product/accessType': '', 'product/alarmType': '', 'product/attachmentType': '', 'product/availability': '', 'product/availabilityZone': '', 'product/brokerEngine': '', 'product/bundle': '', 'product/bundleDescription': '', 'product/bundleGroup': '', 'product/cacheEngine': '', 'product/callingType': '', 'product/capacity': '', 'product/capacitystatus': '', 'product/category': '', 'product/ciType': '', 'product/classicnetworkingsupport': '', 'product/clientLocation': '', 'product/clockSpeed': '', 'product/component': '', 'product/computeType': '', 'product/connectionType': '', 'product/contentType': '', 'product/country': '', 'product/countsAgainstQuota': '', 'product/cputype': '', 'product/currentGeneration': '', 'product/data': '', 'product/dataTransferQuota': '', 'product/dataType': '', 'product/databaseEdition': '', 'product/databaseEngine': '', 'product/datatransferout': '', 'product/dedicatedEbsThroughput': '', 'product/deploymentOption': '', 'product/describes': '', 'product/description': '', 'product/device': '', 'product/deviceType': '', 'product/directConnectLocation': '', 'product/directorySize': '', 'product/directoryType': '', 'product/directoryTypeDescription': '', 'product/dominantnondominant': '', 'product/durability': '', 'product/ecu': '', 'product/edition': '', 'product/endpoint': '', 'product/endpointType': '', 'product/engineCode': '', 'product/enhancedNetworkingSupport': '', 'product/enhancedNetworkingSupported': '', 'product/equivalentondemandsku': '', 'product/eventType': '', 'product/feeCode': '', 'product/feeDescription': '', 'product/findingGroup': '', 'product/findingSource': '', 'product/findingStorage': '', 'product/freeOverage': '', 'product/freeQueryTypes': '', 'product/freeTier': '', 'product/freeTrial': '', 'product/fromLocation': '', 'product/fromLocationType': '', 'product/fromRegionCode': '', 'product/fusfCategory': '', 'product/georegioncode': '', 'product/gets': '', 'product/gpu': '', 'product/gpuMemory': '', 'product/group': 'awskms-APIRequest-All', 'product/groupDescription': 'All AWS KMS API requests', 'product/insightstype': '', 'product/instance': '', 'product/instanceFamily': '', 'product/instanceFunction': '', 'product/instanceName': '', 'product/instanceType': '', 'product/instanceTypeFamily': '', 'product/instances': '', 'product/intelAvx2Available': '', 'product/intelAvxAvailable': '', 'product/intelTurboAvailable': '', 'product/io': '', 'product/license': '', 'product/licenseModel': '', 'product/lineType': '', 'product/location': 'EU (Frankfurt)', 'product/locationType': 'AWS Region', 'product/lockeprofiles': '', 'product/logsDestination': '', 'product/mailboxStorage': '', 'product/marketoption': '', 'product/maxIopsBurstPerformance': '', 'product/maxIopsvolume': '', 'product/maxThroughputvolume': '', 'product/maxVolumeSize': '', 'product/maximumExtendedStorage': '', 'product/maximumStorageVolume': '', 'product/memory': '', 'product/memoryGib': '', 'product/memorytype': '', 'product/messageDeliveryFrequency': '', 'product/messageDeliveryOrder': '', 'product/meteringType': '', 'product/minVolumeSize': '', 'product/minimumStorageVolume': '', 'product/networkPerformance': '', 'product/normalizationSizeFactor': '', 'product/operatingSystem': '', 'product/operation': '', 'product/opsItems': '', 'product/origin': '', 'product/overageType': '', 'product/parameterType': '', 'product/physicalCpu': '', 'product/physicalGpu': '', 'product/physicalProcessor': '', 'product/platoclassificationtype': '', 'product/platodataanalyzedtype': '', 'product/platofeaturetype': '', 'product/platoinstancename': '', 'product/platoinstancetype': '', 'product/platopricingtype': '', 'product/platoprotocoltype': '', 'product/platostoragetype': '', 'product/platotrafficdirection': '', 'product/platotransfertype': '', 'product/platousagetype': '', 'product/platovolumetype': '', 'product/portSpeed': '', 'product/preInstalledSw': '', 'product/pricingUnit': '', 'product/primaryplaceofuse': '', 'product/processorArchitecture': '', 'product/processorFeatures': '', 'product/productFamily': 'API Request', 'product/productType': '', 'product/provisioned': '', 'product/queueType': '', 'product/recipient': '', 'product/region': 'eu-central-1', 'product/regionCode': 'eu-central-1', 'product/requestDescription': '', 'product/requestType': '', 'product/resourceAssessment': '', 'product/resourceEndpoint': '', 'product/resourcePriceGroup': '', 'product/resourceType': '', 'product/rootvolume': '', 'product/routingTarget': '', 'product/routingType': '', 'product/runningMode': '', 'product/servicecode': 'awskms', 'product/servicename': 'AWS Key Management Service', 'product/size': '', 'product/sku': '4H6XVYZMMD8MKVZD', 'product/snapshotarchivefeetype': '', 'product/softwareIncluded': '', 'product/softwareType': '', 'product/standardGroup': '', 'product/standardStorage': '', 'product/standardStorageRetentionIncluded': '', 'product/steps': '', 'product/storage': '', 'product/storageClass': '', 'product/storageMedia': '', 'product/storageType': '', 'product/subscriptionType': '', 'product/tenancy': '', 'product/throughput': '', 'product/throughputClass': '', 'product/tickettype': '', 'product/tiertype': '', 'product/toLocation': '', 'product/toLocationType': '', 'product/toRegionCode': '', 'product/trafficDirection': '', 'product/transactionType': '', 'product/transferType': '', 'product/type': '', 'product/updates': '', 'product/usageFamily': '', 'product/usagetype': 'eu-central-1-KMS-Requests', 'product/uservolume': '', 'product/vcpu': '', 'product/version': '', 'product/virtualInterfaceType': '', 'product/volumeApiName': '', 'product/volumeType': '', 'product/vpcnetworkingsupport': '', 'product/withActiveUsers': '', 'pricing/LeaseContractLength': '', 'pricing/OfferingClass': '', 'pricing/PurchaseOption': '', 'pricing/RateCode': '4H6XVYZMMD8MKVZD.JRTCKXETXF.6YS6EN2CT7', 'pricing/RateId': '7579438446', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000030000', 'pricing/publicOnDemandRate': '0.0000030000', 'pricing/term': 'OnDemand', 'pricing/unit': 'Requests', 'reservation/AmortizedUpfrontCostForUsage': '', 'reservation/AmortizedUpfrontFeeForBillingPeriod': '', 'reservation/EffectiveCost': '', 'reservation/EndTime': '', 'reservation/ModificationStatus': '', 'reservation/NormalizedUnitsPerReservation': '', 'reservation/NumberOfReservations': '', 'reservation/RecurringFeeForUsage': '', 'reservation/ReservationARN': '', 'reservation/StartTime': '', 'reservation/SubscriptionId': '8592851312', 'reservation/TotalReservedNormalizedUnits': '', 'reservation/TotalReservedUnits': '', 'reservation/UnitsPerReservation': '', 'reservation/UnusedAmortizedUpfrontFeeForBillingPeriod': '', 'reservation/UnusedNormalizedUnitQuantity': '', 'reservation/UnusedQuantity': '', 'reservation/UnusedRecurringFee': '', 'reservation/UpfrontValue': '', 'savingsPlan/TotalCommitmentToDate': '', 'savingsPlan/SavingsPlanARN': '', 'savingsPlan/SavingsPlanRate': '', 'savingsPlan/UsedCommitment': '', 'savingsPlan/SavingsPlanEffectiveCost': '', 'savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod': '', 'savingsPlan/RecurringCommitmentForBillingPeriod': '', 'resourceTags/aws:cloudformation:logical-id': '', 'resourceTags/aws:cloudformation:stack-id': '', 'resourceTags/aws:cloudformation:stack-name': '', 'resourceTags/aws:createdBy': '', 'resourceTags/user:AMI': '', 'resourceTags/user:Application': '', 'resourceTags/user:Area': '', 'resourceTags/user:Author': '', 'resourceTags/user:Backup': '', 'resourceTags/user:BlockDevice': '', 'resourceTags/user:BuildUser': '', 'resourceTags/user:Cluster': '', 'resourceTags/user:Created': '', 'resourceTags/user:CreatedBy': '', 'resourceTags/user:Customer': '', 'resourceTags/user:CustomerType': '', 'resourceTags/user:DNS': '', 'resourceTags/user:Desc': '', 'resourceTags/user:Description': '', 'resourceTags/user:Device': '', 'resourceTags/user:ELB': '', 'resourceTags/user:Email': '', 'resourceTags/user:Environment': '', 'resourceTags/user:EventCount': '', 'resourceTags/user:FQDN': '', 'resourceTags/user:Host': '', 'resourceTags/user:Hostname': '', 'resourceTags/user:Infra': '', 'resourceTags/user:InstanceId': '', 'resourceTags/user:Instructor': '', 'resourceTags/user:Label': '', 'resourceTags/user:Life': '', 'resourceTags/user:NAME': '', 'resourceTags/user:Name': '', 'resourceTags/user:Network': '', 'resourceTags/user:Note': '', 'resourceTags/user:OS': '', 'resourceTags/user:Owner': '', 'resourceTags/user:PAAS_CREATED_BY': '', 'resourceTags/user:PAAS_LIFETIME_DAYS': '', 'resourceTags/user:PAAS_OS': '', 'resourceTags/user:PAAS_SCHEDULE': '', 'resourceTags/user:PAAS_TZ': '', 'resourceTags/user:Plan': '', 'resourceTags/user:Project': '', 'resourceTags/user:PurgeAfterFE': '', 'resourceTags/user:PurgeAllow': '', 'resourceTags/user:Purpose': '', 'resourceTags/user:Release': '', 'resourceTags/user:Role': '', 'resourceTags/user:Server': '', 'resourceTags/user:SnapShotGroupId': '', 'resourceTags/user:SnapTestRunId': '', 'resourceTags/user:Splunk': '', 'resourceTags/user:Stack': '', 'resourceTags/user:StackName': '', 'resourceTags/user:Stage': '', 'resourceTags/user:Status': '', 'resourceTags/user:Subdomain': '', 'resourceTags/user:TEST': '', 'resourceTags/user:Team': '', 'resourceTags/user:Test': '', 'resourceTags/user:Ticket': '', 'resourceTags/user:Timestamp': '', 'resourceTags/user:Type': '', 'resourceTags/user:USER': '', 'resourceTags/user:Usage': '', 'resourceTags/user:Use': '', 'resourceTags/user:User': '', 'resourceTags/user:ValidationData': '', 'resourceTags/user:VerStackMakr': '', 'resourceTags/user:Volume': '', 'resourceTags/user:ami': '', 'resourceTags/user:ami_name': '', 'resourceTags/user:app': '', 'resourceTags/user:appversion': '', 'resourceTags/user:arch': '', 'resourceTags/user:area': '', 'resourceTags/user:class': '', 'resourceTags/user:cluster': '', 'resourceTags/user:createdBy': '', 'resourceTags/user:creator': '', 'resourceTags/user:customer': '', 'resourceTags/user:customer_type': '', 'resourceTags/user:desc': '', 'resourceTags/user:description': '', 'resourceTags/user:device_name': '', 'resourceTags/user:environment': '', 'resourceTags/user:fqdn': '', 'resourceTags/user:group': '', 'resourceTags/user:host': '', 'resourceTags/user:hostname': '', 'resourceTags/user:instructor': '', 'resourceTags/user:jenkins_slave_type': '', 'resourceTags/user:job_id': '', 'resourceTags/user:job_name': '', 'resourceTags/user:key1': '', 'resourceTags/user:key2': '', 'resourceTags/user:key_pair_id': '', 'resourceTags/user:mode': '', 'resourceTags/user:name': '', 'resourceTags/user:org': '', 'resourceTags/user:origin': '', 'resourceTags/user:os': '', 'resourceTags/user:project': '', 'resourceTags/user:purpose': '', 'resourceTags/user:region': '', 'resourceTags/user:role': '', 'resourceTags/user:sp_connection_id': '', 'resourceTags/user:splunkit.io/department/code': '', 'resourceTags/user:splunkit.io/os/version': '', 'resourceTags/user:splunkit.io/user/email': '', 'resourceTags/user:splunkit.io/user/isPartner': '', 'resourceTags/user:splunkit/app': '', 'resourceTags/user:splunkit/application': '', 'resourceTags/user:splunkit/department': '', 'resourceTags/user:splunkit/dept': '', 'resourceTags/user:splunkit/env': '', 'resourceTags/user:splunkit/environment': '', 'resourceTags/user:splunkit/instance': '', 'resourceTags/user:splunkit/name': '', 'resourceTags/user:splunkit/owner': '', 'resourceTags/user:splunkit/provider': '', 'resourceTags/user:splunkit/provisioner': '', 'resourceTags/user:splunkit/resource': '', 'resourceTags/user:splunkit/team': '', 'resourceTags/user:splunkit/ttl': '', 'resourceTags/user:splunkit/uri': '', 'resourceTags/user:stack': '', 'resourceTags/user:stack_id': '', 'resourceTags/user:stack_version': '', 'resourceTags/user:stage': '', 'resourceTags/user:status': '', 'resourceTags/user:storage': '', 'resourceTags/user:storm_raid': '', 'resourceTags/user:subnet': '', 'resourceTags/user:tag': '', 'resourceTags/user:tag1': '', 'resourceTags/user:target': '', 'resourceTags/user:team': '', 'resourceTags/user:test': '', 'resourceTags/user:type': '', 'resourceTags/user:uri': '', 'resourceTags/user:usage': ''}, {'identity/LineItemId': 'yohlkjq2fglidlmcveuvoqwvyyxxavydhildvtudifnxqij3shtq', 'identity/TimeInterval': '2022-07-01T17:00:00Z/2022-07-01T18:00:00Z', 'bill/InvoiceId': '', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T17:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T18:00:00Z', 'lineItem/ProductCode': 'AmazonKinesisFirehose', 'lineItem/UsageType': 'USW2-BilledBytes', 'lineItem/Operation': 'PutRecordBatch', 'lineItem/AvailabilityZone': '', 'lineItem/ResourceId': 'arn:aws:firehose:us-west-2:841154226728:deliverystream/841154226728-us-west-2-cloudtrail-firehose', 'lineItem/UsageAmount': '0.0029754639', 'lineItem/NormalizationFactor': '', 'lineItem/NormalizedUsageAmount': '', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0290000000', 'lineItem/UnblendedCost': '0.0000862885', 'lineItem/BlendedRate': '0.0290000000', 'lineItem/BlendedCost': '0.0000862885', 'lineItem/LineItemDescription': 'Tier 1 $0.029 per GB of data ingested', 'lineItem/TaxType': '', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'Amazon Kinesis Firehose', 'product/accessType': '', 'product/alarmType': '', 'product/attachmentType': '', 'product/availability': '', 'product/availabilityZone': '', 'product/brokerEngine': '', 'product/bundle': '', 'product/bundleDescription': '', 'product/bundleGroup': '', 'product/cacheEngine': '', 'product/callingType': '', 'product/capacity': '', 'product/capacitystatus': '', 'product/category': '', 'product/ciType': '', 'product/classicnetworkingsupport': '', 'product/clientLocation': '', 'product/clockSpeed': '', 'product/component': '', 'product/computeType': '', 'product/connectionType': '', 'product/contentType': '', 'product/country': '', 'product/countsAgainstQuota': '', 'product/cputype': '', 'product/currentGeneration': '', 'product/data': '', 'product/dataTransferQuota': '', 'product/dataType': '', 'product/databaseEdition': '', 'product/databaseEngine': '', 'product/datatransferout': '', 'product/dedicatedEbsThroughput': '', 'product/deploymentOption': '', 'product/describes': '', 'product/description': 'Per GB of data ingested', 'product/device': '', 'product/deviceType': '', 'product/directConnectLocation': '', 'product/directorySize': '', 'product/directoryType': '', 'product/directoryTypeDescription': '', 'product/dominantnondominant': '', 'product/durability': '', 'product/ecu': '', 'product/edition': '', 'product/endpoint': '', 'product/endpointType': '', 'product/engineCode': '', 'product/enhancedNetworkingSupport': '', 'product/enhancedNetworkingSupported': '', 'product/equivalentondemandsku': '', 'product/eventType': '', 'product/feeCode': '', 'product/feeDescription': '', 'product/findingGroup': '', 'product/findingSource': '', 'product/findingStorage': '', 'product/freeOverage': '', 'product/freeQueryTypes': '', 'product/freeTier': '', 'product/freeTrial': '', 'product/fromLocation': '', 'product/fromLocationType': '', 'product/fromRegionCode': '', 'product/fusfCategory': '', 'product/georegioncode': '', 'product/gets': '', 'product/gpu': '', 'product/gpuMemory': '', 'product/group': 'Batch Processing', 'product/groupDescription': '', 'product/insightstype': '', 'product/instance': '', 'product/instanceFamily': '', 'product/instanceFunction': '', 'product/instanceName': '', 'product/instanceType': '', 'product/instanceTypeFamily': '', 'product/instances': '', 'product/intelAvx2Available': '', 'product/intelAvxAvailable': '', 'product/intelTurboAvailable': '', 'product/io': '', 'product/license': '', 'product/licenseModel': '', 'product/lineType': '', 'product/location': 'US West (Oregon)', 'product/locationType': 'AWS Region', 'product/lockeprofiles': '', 'product/logsDestination': '', 'product/mailboxStorage': '', 'product/marketoption': '', 'product/maxIopsBurstPerformance': '', 'product/maxIopsvolume': '', 'product/maxThroughputvolume': '', 'product/maxVolumeSize': '', 'product/maximumExtendedStorage': '', 'product/maximumStorageVolume': '', 'product/memory': '', 'product/memoryGib': '', 'product/memorytype': '', 'product/messageDeliveryFrequency': '', 'product/messageDeliveryOrder': '', 'product/meteringType': '', 'product/minVolumeSize': '', 'product/minimumStorageVolume': '', 'product/networkPerformance': '', 'product/normalizationSizeFactor': '', 'product/operatingSystem': '', 'product/operation': 'PutRecordBatch', 'product/opsItems': '', 'product/origin': '', 'product/overageType': '', 'product/parameterType': '', 'product/physicalCpu': '', 'product/physicalGpu': '', 'product/physicalProcessor': '', 'product/platoclassificationtype': '', 'product/platodataanalyzedtype': '', 'product/platofeaturetype': '', 'product/platoinstancename': '', 'product/platoinstancetype': '', 'product/platopricingtype': '', 'product/platoprotocoltype': '', 'product/platostoragetype': '', 'product/platotrafficdirection': '', 'product/platotransfertype': '', 'product/platousagetype': '', 'product/platovolumetype': '', 'product/portSpeed': '', 'product/preInstalledSw': '', 'product/pricingUnit': '', 'product/primaryplaceofuse': '', 'product/processorArchitecture': '', 'product/processorFeatures': '', 'product/productFamily': 'Kinesis Firehose', 'product/productType': '', 'product/provisioned': '', 'product/queueType': '', 'product/recipient': '', 'product/region': 'us-west-2', 'product/regionCode': 'us-west-2', 'product/requestDescription': '', 'product/requestType': '', 'product/resourceAssessment': '', 'product/resourceEndpoint': '', 'product/resourcePriceGroup': '', 'product/resourceType': '', 'product/rootvolume': '', 'product/routingTarget': '', 'product/routingType': '', 'product/runningMode': '', 'product/servicecode': 'AmazonKinesisFirehose', 'product/servicename': 'Amazon Kinesis Firehose', 'product/size': '', 'product/sku': '5267PTSYZKCEH8SQ', 'product/snapshotarchivefeetype': '', 'product/softwareIncluded': '', 'product/softwareType': '', 'product/standardGroup': '', 'product/standardStorage': '', 'product/standardStorageRetentionIncluded': '', 'product/steps': '', 'product/storage': '', 'product/storageClass': '', 'product/storageMedia': '', 'product/storageType': '', 'product/subscriptionType': '', 'product/tenancy': '', 'product/throughput': '', 'product/throughputClass': '', 'product/tickettype': '1', 'product/tiertype': '', 'product/toLocation': '', 'product/toLocationType': '', 'product/toRegionCode': '', 'product/trafficDirection': '', 'product/transactionType': '', 'product/transferType': '', 'product/type': '', 'product/updates': '', 'product/usageFamily': '', 'product/usagetype': 'USW2-BilledBytes', 'product/uservolume': '', 'product/vcpu': '', 'product/version': '', 'product/virtualInterfaceType': '', 'product/volumeApiName': '', 'product/volumeType': '', 'product/vpcnetworkingsupport': '', 'product/withActiveUsers': '', 'pricing/LeaseContractLength': '', 'pricing/OfferingClass': '', 'pricing/PurchaseOption': '', 'pricing/RateCode': '5267PTSYZKCEH8SQ.JRTCKXETXF.HK3AFRJD7J', 'pricing/RateId': '6906152730', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000862885', 'pricing/publicOnDemandRate': '0.0290000000', 'pricing/term': 'OnDemand', 'pricing/unit': 'GB', 'reservation/AmortizedUpfrontCostForUsage': '', 'reservation/AmortizedUpfrontFeeForBillingPeriod': '', 'reservation/EffectiveCost': '', 'reservation/EndTime': '', 'reservation/ModificationStatus': '', 'reservation/NormalizedUnitsPerReservation': '', 'reservation/NumberOfReservations': '', 'reservation/RecurringFeeForUsage': '', 'reservation/ReservationARN': '', 'reservation/StartTime': '', 'reservation/SubscriptionId': '8592851340', 'reservation/TotalReservedNormalizedUnits': '', 'reservation/TotalReservedUnits': '', 'reservation/UnitsPerReservation': '', 'reservation/UnusedAmortizedUpfrontFeeForBillingPeriod': '', 'reservation/UnusedNormalizedUnitQuantity': '', 'reservation/UnusedQuantity': '', 'reservation/UnusedRecurringFee': '', 'reservation/UpfrontValue': '', 'savingsPlan/TotalCommitmentToDate': '', 'savingsPlan/SavingsPlanARN': '', 'savingsPlan/SavingsPlanRate': '', 'savingsPlan/UsedCommitment': '', 'savingsPlan/SavingsPlanEffectiveCost': '', 'savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod': '', 'savingsPlan/RecurringCommitmentForBillingPeriod': '', 'resourceTags/aws:cloudformation:logical-id': '', 'resourceTags/aws:cloudformation:stack-id': '', 'resourceTags/aws:cloudformation:stack-name': '', 'resourceTags/aws:createdBy': '', 'resourceTags/user:AMI': '', 'resourceTags/user:Application': '', 'resourceTags/user:Area': '', 'resourceTags/user:Author': '', 'resourceTags/user:Backup': '', 'resourceTags/user:BlockDevice': '', 'resourceTags/user:BuildUser': '', 'resourceTags/user:Cluster': '', 'resourceTags/user:Created': '', 'resourceTags/user:CreatedBy': '', 'resourceTags/user:Customer': '', 'resourceTags/user:CustomerType': '', 'resourceTags/user:DNS': '', 'resourceTags/user:Desc': '', 'resourceTags/user:Description': '', 'resourceTags/user:Device': '', 'resourceTags/user:ELB': '', 'resourceTags/user:Email': '', 'resourceTags/user:Environment': '', 'resourceTags/user:EventCount': '', 'resourceTags/user:FQDN': '', 'resourceTags/user:Host': '', 'resourceTags/user:Hostname': '', 'resourceTags/user:Infra': '', 'resourceTags/user:InstanceId': '', 'resourceTags/user:Instructor': '', 'resourceTags/user:Label': '', 'resourceTags/user:Life': '', 'resourceTags/user:NAME': '', 'resourceTags/user:Name': '', 'resourceTags/user:Network': '', 'resourceTags/user:Note': '', 'resourceTags/user:OS': '', 'resourceTags/user:Owner': '', 'resourceTags/user:PAAS_CREATED_BY': '', 'resourceTags/user:PAAS_LIFETIME_DAYS': '', 'resourceTags/user:PAAS_OS': '', 'resourceTags/user:PAAS_SCHEDULE': '', 'resourceTags/user:PAAS_TZ': '', 'resourceTags/user:Plan': '', 'resourceTags/user:Project': '', 'resourceTags/user:PurgeAfterFE': '', 'resourceTags/user:PurgeAllow': '', 'resourceTags/user:Purpose': '', 'resourceTags/user:Release': '', 'resourceTags/user:Role': '', 'resourceTags/user:Server': '', 'resourceTags/user:SnapShotGroupId': '', 'resourceTags/user:SnapTestRunId': '', 'resourceTags/user:Splunk': '', 'resourceTags/user:Stack': '', 'resourceTags/user:StackName': '', 'resourceTags/user:Stage': '', 'resourceTags/user:Status': '', 'resourceTags/user:Subdomain': '', 'resourceTags/user:TEST': '', 'resourceTags/user:Team': '', 'resourceTags/user:Test': '', 'resourceTags/user:Ticket': '', 'resourceTags/user:Timestamp': '', 'resourceTags/user:Type': '', 'resourceTags/user:USER': '', 'resourceTags/user:Usage': '', 'resourceTags/user:Use': '', 'resourceTags/user:User': '', 'resourceTags/user:ValidationData': '', 'resourceTags/user:VerStackMakr': '', 'resourceTags/user:Volume': '', 'resourceTags/user:ami': '', 'resourceTags/user:ami_name': '', 'resourceTags/user:app': '', 'resourceTags/user:appversion': '', 'resourceTags/user:arch': '', 'resourceTags/user:area': '', 'resourceTags/user:class': '', 'resourceTags/user:cluster': '', 'resourceTags/user:createdBy': '', 'resourceTags/user:creator': '', 'resourceTags/user:customer': '', 'resourceTags/user:customer_type': '', 'resourceTags/user:desc': '', 'resourceTags/user:description': '', 'resourceTags/user:device_name': '', 'resourceTags/user:environment': '', 'resourceTags/user:fqdn': '', 'resourceTags/user:group': '', 'resourceTags/user:host': '', 'resourceTags/user:hostname': '', 'resourceTags/user:instructor': '', 'resourceTags/user:jenkins_slave_type': '', 'resourceTags/user:job_id': '', 'resourceTags/user:job_name': '', 'resourceTags/user:key1': '', 'resourceTags/user:key2': '', 'resourceTags/user:key_pair_id': '', 'resourceTags/user:mode': '', 'resourceTags/user:name': '', 'resourceTags/user:org': '', 'resourceTags/user:origin': '', 'resourceTags/user:os': '', 'resourceTags/user:project': '', 'resourceTags/user:purpose': '', 'resourceTags/user:region': '', 'resourceTags/user:role': '', 'resourceTags/user:sp_connection_id': '', 'resourceTags/user:splunkit.io/department/code': '', 'resourceTags/user:splunkit.io/os/version': '', 'resourceTags/user:splunkit.io/user/email': '', 'resourceTags/user:splunkit.io/user/isPartner': '', 'resourceTags/user:splunkit/app': '', 'resourceTags/user:splunkit/application': '', 'resourceTags/user:splunkit/department': '', 'resourceTags/user:splunkit/dept': '', 'resourceTags/user:splunkit/env': '', 'resourceTags/user:splunkit/environment': '', 'resourceTags/user:splunkit/instance': '', 'resourceTags/user:splunkit/name': '', 'resourceTags/user:splunkit/owner': '', 'resourceTags/user:splunkit/provider': '', 'resourceTags/user:splunkit/provisioner': '', 'resourceTags/user:splunkit/resource': '', 'resourceTags/user:splunkit/team': '', 'resourceTags/user:splunkit/ttl': '', 'resourceTags/user:splunkit/uri': '', 'resourceTags/user:stack': '', 'resourceTags/user:stack_id': '', 'resourceTags/user:stack_version': '', 'resourceTags/user:stage': '', 'resourceTags/user:status': '', 'resourceTags/user:storage': '', 'resourceTags/user:storm_raid': '', 'resourceTags/user:subnet': '', 'resourceTags/user:tag': '', 'resourceTags/user:tag1': '', 'resourceTags/user:target': '', 'resourceTags/user:team': '', 'resourceTags/user:test': '', 'resourceTags/user:type': '', 'resourceTags/user:uri': '', 'resourceTags/user:usage': ''}, {'identity/LineItemId': 'y2i7wrj74nmhzgulowyenmeaw5fdmv6v725hcp2yvlxt5ltnqrnq', 'identity/TimeInterval': '2022-07-01T04:00:00Z/2022-07-01T05:00:00Z', 'bill/InvoiceId': '', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T04:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T05:00:00Z', 'lineItem/ProductCode': 'AWSCloudTrail', 'lineItem/UsageType': 'USW2-FreeEventsRecorded', 'lineItem/Operation': 'None', 'lineItem/AvailabilityZone': '', 'lineItem/ResourceId': '', 'lineItem/UsageAmount': '125.0000000000', 'lineItem/NormalizationFactor': '', 'lineItem/NormalizedUsageAmount': '', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0000000000', 'lineItem/UnblendedCost': '0.0000000000', 'lineItem/BlendedRate': '0.0000000000', 'lineItem/BlendedCost': '0.0000000000', 'lineItem/LineItemDescription': '0.0 per free event recorded in US West (Oregon) region', 'lineItem/TaxType': '', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'AWS CloudTrail', 'product/accessType': '', 'product/alarmType': '', 'product/attachmentType': '', 'product/availability': '', 'product/availabilityZone': '', 'product/brokerEngine': '', 'product/bundle': '', 'product/bundleDescription': '', 'product/bundleGroup': '', 'product/cacheEngine': '', 'product/callingType': '', 'product/capacity': '', 'product/capacitystatus': '', 'product/category': '', 'product/ciType': '', 'product/classicnetworkingsupport': '', 'product/clientLocation': '', 'product/clockSpeed': '', 'product/component': '', 'product/computeType': '', 'product/connectionType': '', 'product/contentType': '', 'product/country': '', 'product/countsAgainstQuota': '', 'product/cputype': '', 'product/currentGeneration': '', 'product/data': '', 'product/dataTransferQuota': '', 'product/dataType': '', 'product/databaseEdition': '', 'product/databaseEngine': '', 'product/datatransferout': '', 'product/dedicatedEbsThroughput': '', 'product/deploymentOption': '', 'product/describes': '', 'product/description': '', 'product/device': '', 'product/deviceType': '', 'product/directConnectLocation': '', 'product/directorySize': '', 'product/directoryType': '', 'product/directoryTypeDescription': '', 'product/dominantnondominant': '', 'product/durability': '', 'product/ecu': '', 'product/edition': '', 'product/endpoint': '', 'product/endpointType': '', 'product/engineCode': '', 'product/enhancedNetworkingSupport': '', 'product/enhancedNetworkingSupported': '', 'product/equivalentondemandsku': '', 'product/eventType': '', 'product/feeCode': '', 'product/feeDescription': '', 'product/findingGroup': '', 'product/findingSource': '', 'product/findingStorage': '', 'product/freeOverage': '', 'product/freeQueryTypes': '', 'product/freeTier': '', 'product/freeTrial': '', 'product/fromLocation': '', 'product/fromLocationType': '', 'product/fromRegionCode': '', 'product/fusfCategory': '', 'product/georegioncode': '', 'product/gets': '', 'product/gpu': '', 'product/gpuMemory': '', 'product/group': '', 'product/groupDescription': '', 'product/insightstype': '', 'product/instance': '', 'product/instanceFamily': '', 'product/instanceFunction': '', 'product/instanceName': '', 'product/instanceType': '', 'product/instanceTypeFamily': '', 'product/instances': '', 'product/intelAvx2Available': '', 'product/intelAvxAvailable': '', 'product/intelTurboAvailable': '', 'product/io': '', 'product/license': '', 'product/licenseModel': '', 'product/lineType': '', 'product/location': 'US West (Oregon)', 'product/locationType': 'AWS Region', 'product/lockeprofiles': '', 'product/logsDestination': '', 'product/mailboxStorage': '', 'product/marketoption': '', 'product/maxIopsBurstPerformance': '', 'product/maxIopsvolume': '', 'product/maxThroughputvolume': '', 'product/maxVolumeSize': '', 'product/maximumExtendedStorage': '', 'product/maximumStorageVolume': '', 'product/memory': '', 'product/memoryGib': '', 'product/memorytype': '', 'product/messageDeliveryFrequency': '', 'product/messageDeliveryOrder': '', 'product/meteringType': '', 'product/minVolumeSize': '', 'product/minimumStorageVolume': '', 'product/networkPerformance': '', 'product/normalizationSizeFactor': '', 'product/operatingSystem': '', 'product/operation': '', 'product/opsItems': '', 'product/origin': '', 'product/overageType': '', 'product/parameterType': '', 'product/physicalCpu': '', 'product/physicalGpu': '', 'product/physicalProcessor': '', 'product/platoclassificationtype': '', 'product/platodataanalyzedtype': '', 'product/platofeaturetype': '', 'product/platoinstancename': '', 'product/platoinstancetype': '', 'product/platopricingtype': '', 'product/platoprotocoltype': '', 'product/platostoragetype': '', 'product/platotrafficdirection': '', 'product/platotransfertype': '', 'product/platousagetype': '', 'product/platovolumetype': '', 'product/portSpeed': '', 'product/preInstalledSw': '', 'product/pricingUnit': '', 'product/primaryplaceofuse': '', 'product/processorArchitecture': '', 'product/processorFeatures': '', 'product/productFamily': 'Management Tools - AWS CloudTrail Free Events Recorded', 'product/productType': '', 'product/provisioned': '', 'product/queueType': '', 'product/recipient': '', 'product/region': 'us-west-2', 'product/regionCode': 'us-west-2', 'product/requestDescription': '', 'product/requestType': '', 'product/resourceAssessment': '', 'product/resourceEndpoint': '', 'product/resourcePriceGroup': '', 'product/resourceType': '', 'product/rootvolume': '', 'product/routingTarget': '', 'product/routingType': '', 'product/runningMode': '', 'product/servicecode': 'AWSCloudTrail', 'product/servicename': 'AWS CloudTrail', 'product/size': '', 'product/sku': '57SQQK7HQMW76PRE', 'product/snapshotarchivefeetype': '', 'product/softwareIncluded': '', 'product/softwareType': '', 'product/standardGroup': '', 'product/standardStorage': '', 'product/standardStorageRetentionIncluded': '', 'product/steps': '', 'product/storage': '', 'product/storageClass': '', 'product/storageMedia': '', 'product/storageType': '', 'product/subscriptionType': '', 'product/tenancy': '', 'product/throughput': '', 'product/throughputClass': '', 'product/tickettype': '', 'product/tiertype': '', 'product/toLocation': '', 'product/toLocationType': '', 'product/toRegionCode': '', 'product/trafficDirection': '', 'product/transactionType': '', 'product/transferType': '', 'product/type': '', 'product/updates': '', 'product/usageFamily': '', 'product/usagetype': 'USW2-FreeEventsRecorded', 'product/uservolume': '', 'product/vcpu': '', 'product/version': '', 'product/virtualInterfaceType': '', 'product/volumeApiName': '', 'product/volumeType': '', 'product/vpcnetworkingsupport': '', 'product/withActiveUsers': '', 'pricing/LeaseContractLength': '', 'pricing/OfferingClass': '', 'pricing/PurchaseOption': '', 'pricing/RateCode': '57SQQK7HQMW76PRE.JRTCKXETXF.6YS6EN2CT7', 'pricing/RateId': '7994477393', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000000000', 'pricing/publicOnDemandRate': '0.0000000000', 'pricing/term': 'OnDemand', 'pricing/unit': 'Events', 'reservation/AmortizedUpfrontCostForUsage': '', 'reservation/AmortizedUpfrontFeeForBillingPeriod': '', 'reservation/EffectiveCost': '', 'reservation/EndTime': '', 'reservation/ModificationStatus': '', 'reservation/NormalizedUnitsPerReservation': '', 'reservation/NumberOfReservations': '', 'reservation/RecurringFeeForUsage': '', 'reservation/ReservationARN': '', 'reservation/StartTime': '', 'reservation/SubscriptionId': '8592851348', 'reservation/TotalReservedNormalizedUnits': '', 'reservation/TotalReservedUnits': '', 'reservation/UnitsPerReservation': '', 'reservation/UnusedAmortizedUpfrontFeeForBillingPeriod': '', 'reservation/UnusedNormalizedUnitQuantity': '', 'reservation/UnusedQuantity': '', 'reservation/UnusedRecurringFee': '', 'reservation/UpfrontValue': '', 'savingsPlan/TotalCommitmentToDate': '', 'savingsPlan/SavingsPlanARN': '', 'savingsPlan/SavingsPlanRate': '', 'savingsPlan/UsedCommitment': '', 'savingsPlan/SavingsPlanEffectiveCost': '', 'savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod': '', 'savingsPlan/RecurringCommitmentForBillingPeriod': '', 'resourceTags/aws:cloudformation:logical-id': '', 'resourceTags/aws:cloudformation:stack-id': '', 'resourceTags/aws:cloudformation:stack-name': '', 'resourceTags/aws:createdBy': '', 'resourceTags/user:AMI': '', 'resourceTags/user:Application': '', 'resourceTags/user:Area': '', 'resourceTags/user:Author': '', 'resourceTags/user:Backup': '', 'resourceTags/user:BlockDevice': '', 'resourceTags/user:BuildUser': '', 'resourceTags/user:Cluster': '', 'resourceTags/user:Created': '', 'resourceTags/user:CreatedBy': '', 'resourceTags/user:Customer': '', 'resourceTags/user:CustomerType': '', 'resourceTags/user:DNS': '', 'resourceTags/user:Desc': '', 'resourceTags/user:Description': '', 'resourceTags/user:Device': '', 'resourceTags/user:ELB': '', 'resourceTags/user:Email': '', 'resourceTags/user:Environment': '', 'resourceTags/user:EventCount': '', 'resourceTags/user:FQDN': '', 'resourceTags/user:Host': '', 'resourceTags/user:Hostname': '', 'resourceTags/user:Infra': '', 'resourceTags/user:InstanceId': '', 'resourceTags/user:Instructor': '', 'resourceTags/user:Label': '', 'resourceTags/user:Life': '', 'resourceTags/user:NAME': '', 'resourceTags/user:Name': '', 'resourceTags/user:Network': '', 'resourceTags/user:Note': '', 'resourceTags/user:OS': '', 'resourceTags/user:Owner': '', 'resourceTags/user:PAAS_CREATED_BY': '', 'resourceTags/user:PAAS_LIFETIME_DAYS': '', 'resourceTags/user:PAAS_OS': '', 'resourceTags/user:PAAS_SCHEDULE': '', 'resourceTags/user:PAAS_TZ': '', 'resourceTags/user:Plan': '', 'resourceTags/user:Project': '', 'resourceTags/user:PurgeAfterFE': '', 'resourceTags/user:PurgeAllow': '', 'resourceTags/user:Purpose': '', 'resourceTags/user:Release': '', 'resourceTags/user:Role': '', 'resourceTags/user:Server': '', 'resourceTags/user:SnapShotGroupId': '', 'resourceTags/user:SnapTestRunId': '', 'resourceTags/user:Splunk': '', 'resourceTags/user:Stack': '', 'resourceTags/user:StackName': '', 'resourceTags/user:Stage': '', 'resourceTags/user:Status': '', 'resourceTags/user:Subdomain': '', 'resourceTags/user:TEST': '', 'resourceTags/user:Team': '', 'resourceTags/user:Test': '', 'resourceTags/user:Ticket': '', 'resourceTags/user:Timestamp': '', 'resourceTags/user:Type': '', 'resourceTags/user:USER': '', 'resourceTags/user:Usage': '', 'resourceTags/user:Use': '', 'resourceTags/user:User': '', 'resourceTags/user:ValidationData': '', 'resourceTags/user:VerStackMakr': '', 'resourceTags/user:Volume': '', 'resourceTags/user:ami': '', 'resourceTags/user:ami_name': '', 'resourceTags/user:app': '', 'resourceTags/user:appversion': '', 'resourceTags/user:arch': '', 'resourceTags/user:area': '', 'resourceTags/user:class': '', 'resourceTags/user:cluster': '', 'resourceTags/user:createdBy': '', 'resourceTags/user:creator': '', 'resourceTags/user:customer': '', 'resourceTags/user:customer_type': '', 'resourceTags/user:desc': '', 'resourceTags/user:description': '', 'resourceTags/user:device_name': '', 'resourceTags/user:environment': '', 'resourceTags/user:fqdn': '', 'resourceTags/user:group': '', 'resourceTags/user:host': '', 'resourceTags/user:hostname': '', 'resourceTags/user:instructor': '', 'resourceTags/user:jenkins_slave_type': '', 'resourceTags/user:job_id': '', 'resourceTags/user:job_name': '', 'resourceTags/user:key1': '', 'resourceTags/user:key2': '', 'resourceTags/user:key_pair_id': '', 'resourceTags/user:mode': '', 'resourceTags/user:name': '', 'resourceTags/user:org': '', 'resourceTags/user:origin': '', 'resourceTags/user:os': '', 'resourceTags/user:project': '', 'resourceTags/user:purpose': '', 'resourceTags/user:region': '', 'resourceTags/user:role': '', 'resourceTags/user:sp_connection_id': '', 'resourceTags/user:splunkit.io/department/code': '', 'resourceTags/user:splunkit.io/os/version': '', 'resourceTags/user:splunkit.io/user/email': '', 'resourceTags/user:splunkit.io/user/isPartner': '', 'resourceTags/user:splunkit/app': '', 'resourceTags/user:splunkit/application': '', 'resourceTags/user:splunkit/department': '', 'resourceTags/user:splunkit/dept': '', 'resourceTags/user:splunkit/env': '', 'resourceTags/user:splunkit/environment': '', 'resourceTags/user:splunkit/instance': '', 'resourceTags/user:splunkit/name': '', 'resourceTags/user:splunkit/owner': '', 'resourceTags/user:splunkit/provider': '', 'resourceTags/user:splunkit/provisioner': '', 'resourceTags/user:splunkit/resource': '', 'resourceTags/user:splunkit/team': '', 'resourceTags/user:splunkit/ttl': '', 'resourceTags/user:splunkit/uri': '', 'resourceTags/user:stack': '', 'resourceTags/user:stack_id': '', 'resourceTags/user:stack_version': '', 'resourceTags/user:stage': '', 'resourceTags/user:status': '', 'resourceTags/user:storage': '', 'resourceTags/user:storm_raid': '', 'resourceTags/user:subnet': '', 'resourceTags/user:tag': '', 'resourceTags/user:tag1': '', 'resourceTags/user:target': '', 'resourceTags/user:team': '', 'resourceTags/user:test': '', 'resourceTags/user:type': '', 'resourceTags/user:uri': '', 'resourceTags/user:usage': ''}, {'identity/LineItemId': '5vjom4j4ffg2vsgm6druoqtc43tctnz55s2acmgtgg3k6hhawq2q', 'identity/TimeInterval': '2022-07-01T07:00:00Z/2022-07-01T08:00:00Z', 'bill/InvoiceId': '', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T07:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T08:00:00Z', 'lineItem/ProductCode': 'AmazonEC2', 'lineItem/UsageType': 'USW2-DataTransfer-Regional-Bytes', 'lineItem/Operation': 'PublicIP-In', 'lineItem/AvailabilityZone': '', 'lineItem/ResourceId': 'i-0f7700bc526d074e9', 'lineItem/UsageAmount': '0.0033566216', 'lineItem/NormalizationFactor': '', 'lineItem/NormalizedUsageAmount': '', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0030000000', 'lineItem/UnblendedCost': '0.0000100699', 'lineItem/BlendedRate': '0.0030000000', 'lineItem/BlendedCost': '0.0000100699', 'lineItem/LineItemDescription': '$0.003 per GB - regional data transfer - in/out/between EC2 AZs or using elastic IPs or ELB', 'lineItem/TaxType': '', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'Amazon Elastic Compute Cloud', 'product/accessType': '', 'product/alarmType': '', 'product/attachmentType': '', 'product/availability': '', 'product/availabilityZone': '', 'product/brokerEngine': '', 'product/bundle': '', 'product/bundleDescription': '', 'product/bundleGroup': '', 'product/cacheEngine': '', 'product/callingType': '', 'product/capacity': '', 'product/capacitystatus': '', 'product/category': '', 'product/ciType': '', 'product/classicnetworkingsupport': '', 'product/clientLocation': '', 'product/clockSpeed': '', 'product/component': '', 'product/computeType': '', 'product/connectionType': '', 'product/contentType': '', 'product/country': '', 'product/countsAgainstQuota': '', 'product/cputype': '', 'product/currentGeneration': '', 'product/data': '', 'product/dataTransferQuota': '', 'product/dataType': '', 'product/databaseEdition': '', 'product/databaseEngine': '', 'product/datatransferout': '', 'product/dedicatedEbsThroughput': '', 'product/deploymentOption': '', 'product/describes': '', 'product/description': '', 'product/device': '', 'product/deviceType': '', 'product/directConnectLocation': '', 'product/directorySize': '', 'product/directoryType': '', 'product/directoryTypeDescription': '', 'product/dominantnondominant': '', 'product/durability': '', 'product/ecu': '', 'product/edition': '', 'product/endpoint': '', 'product/endpointType': '', 'product/engineCode': '', 'product/enhancedNetworkingSupport': '', 'product/enhancedNetworkingSupported': '', 'product/equivalentondemandsku': '', 'product/eventType': '', 'product/feeCode': '', 'product/feeDescription': '', 'product/findingGroup': '', 'product/findingSource': '', 'product/findingStorage': '', 'product/freeOverage': '', 'product/freeQueryTypes': '', 'product/freeTier': '', 'product/freeTrial': '', 'product/fromLocation': 'US West (Oregon)', 'product/fromLocationType': 'AWS Region', 'product/fromRegionCode': 'us-west-2', 'product/fusfCategory': '', 'product/georegioncode': '', 'product/gets': '', 'product/gpu': '', 'product/gpuMemory': '', 'product/group': '', 'product/groupDescription': '', 'product/insightstype': '', 'product/instance': '', 'product/instanceFamily': '', 'product/instanceFunction': '', 'product/instanceName': '', 'product/instanceType': '', 'product/instanceTypeFamily': '', 'product/instances': '', 'product/intelAvx2Available': '', 'product/intelAvxAvailable': '', 'product/intelTurboAvailable': '', 'product/io': '', 'product/license': '', 'product/licenseModel': '', 'product/lineType': '', 'product/location': '', 'product/locationType': '', 'product/lockeprofiles': '', 'product/logsDestination': '', 'product/mailboxStorage': '', 'product/marketoption': '', 'product/maxIopsBurstPerformance': '', 'product/maxIopsvolume': '', 'product/maxThroughputvolume': '', 'product/maxVolumeSize': '', 'product/maximumExtendedStorage': '', 'product/maximumStorageVolume': '', 'product/memory': '', 'product/memoryGib': '', 'product/memorytype': '', 'product/messageDeliveryFrequency': '', 'product/messageDeliveryOrder': '', 'product/meteringType': '', 'product/minVolumeSize': '', 'product/minimumStorageVolume': '', 'product/networkPerformance': '', 'product/normalizationSizeFactor': '', 'product/operatingSystem': '', 'product/operation': '', 'product/opsItems': '', 'product/origin': '', 'product/overageType': '', 'product/parameterType': '', 'product/physicalCpu': '', 'product/physicalGpu': '', 'product/physicalProcessor': '', 'product/platoclassificationtype': '', 'product/platodataanalyzedtype': '', 'product/platofeaturetype': '', 'product/platoinstancename': '', 'product/platoinstancetype': '', 'product/platopricingtype': '', 'product/platoprotocoltype': '', 'product/platostoragetype': '', 'product/platotrafficdirection': '', 'product/platotransfertype': '', 'product/platousagetype': '', 'product/platovolumetype': '', 'product/portSpeed': '', 'product/preInstalledSw': '', 'product/pricingUnit': '', 'product/primaryplaceofuse': '', 'product/processorArchitecture': '', 'product/processorFeatures': '', 'product/productFamily': 'Data Transfer', 'product/productType': '', 'product/provisioned': '', 'product/queueType': '', 'product/recipient': '', 'product/region': 'us-west-2', 'product/regionCode': '', 'product/requestDescription': '', 'product/requestType': '', 'product/resourceAssessment': '', 'product/resourceEndpoint': '', 'product/resourcePriceGroup': '', 'product/resourceType': '', 'product/rootvolume': '', 'product/routingTarget': '', 'product/routingType': '', 'product/runningMode': '', 'product/servicecode': 'AWSDataTransfer', 'product/servicename': 'AWS Data Transfer', 'product/size': '', 'product/sku': '62WNQUZDQQ6GRJC5', 'product/snapshotarchivefeetype': '', 'product/softwareIncluded': '', 'product/softwareType': '', 'product/standardGroup': '', 'product/standardStorage': '', 'product/standardStorageRetentionIncluded': '', 'product/steps': '', 'product/storage': '', 'product/storageClass': '', 'product/storageMedia': '', 'product/storageType': '', 'product/subscriptionType': '', 'product/tenancy': '', 'product/throughput': '', 'product/throughputClass': '', 'product/tickettype': '', 'product/tiertype': '', 'product/toLocation': 'US West (Oregon)', 'product/toLocationType': 'AWS Region', 'product/toRegionCode': 'us-west-2', 'product/trafficDirection': '', 'product/transactionType': '', 'product/transferType': 'IntraRegion', 'product/type': '', 'product/updates': '', 'product/usageFamily': '', 'product/usagetype': 'USW2-DataTransfer-Regional-Bytes', 'product/uservolume': '', 'product/vcpu': '', 'product/version': '', 'product/virtualInterfaceType': '', 'product/volumeApiName': '', 'product/volumeType': '', 'product/vpcnetworkingsupport': '', 'product/withActiveUsers': '', 'pricing/LeaseContractLength': '', 'pricing/OfferingClass': '', 'pricing/PurchaseOption': '', 'pricing/RateCode': '62WNQUZDQQ6GRJC5.JRTCKXETXF.6YS6EN2CT7', 'pricing/RateId': '7740772210', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000335662', 'pricing/publicOnDemandRate': '0.0100000000', 'pricing/term': 'OnDemand', 'pricing/unit': 'GB', 'reservation/AmortizedUpfrontCostForUsage': '', 'reservation/AmortizedUpfrontFeeForBillingPeriod': '', 'reservation/EffectiveCost': '', 'reservation/EndTime': '', 'reservation/ModificationStatus': '', 'reservation/NormalizedUnitsPerReservation': '', 'reservation/NumberOfReservations': '', 'reservation/RecurringFeeForUsage': '', 'reservation/ReservationARN': '', 'reservation/StartTime': '', 'reservation/SubscriptionId': '8592851269', 'reservation/TotalReservedNormalizedUnits': '', 'reservation/TotalReservedUnits': '', 'reservation/UnitsPerReservation': '', 'reservation/UnusedAmortizedUpfrontFeeForBillingPeriod': '', 'reservation/UnusedNormalizedUnitQuantity': '', 'reservation/UnusedQuantity': '', 'reservation/UnusedRecurringFee': '', 'reservation/UpfrontValue': '', 'savingsPlan/TotalCommitmentToDate': '', 'savingsPlan/SavingsPlanARN': '', 'savingsPlan/SavingsPlanRate': '', 'savingsPlan/UsedCommitment': '', 'savingsPlan/SavingsPlanEffectiveCost': '', 'savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod': '', 'savingsPlan/RecurringCommitmentForBillingPeriod': '', 'resourceTags/aws:cloudformation:logical-id': 'ec2', 'resourceTags/aws:cloudformation:stack-id': 'arn:aws:cloudformation:us-west-2:841154226728:stack/preeves-k3s-worker1/ac6e2480-d62b-11ec-9c70-0afdd06c1fa1', 'resourceTags/aws:cloudformation:stack-name': 'preeves-k3s-worker1', 'resourceTags/aws:createdBy': 'AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com', 'resourceTags/user:AMI': '', 'resourceTags/user:Application': '', 'resourceTags/user:Area': '', 'resourceTags/user:Author': '', 'resourceTags/user:Backup': '', 'resourceTags/user:BlockDevice': '', 'resourceTags/user:BuildUser': '', 'resourceTags/user:Cluster': '', 'resourceTags/user:Created': '', 'resourceTags/user:CreatedBy': '', 'resourceTags/user:Customer': '', 'resourceTags/user:CustomerType': '', 'resourceTags/user:DNS': '', 'resourceTags/user:Desc': '', 'resourceTags/user:Description': '', 'resourceTags/user:Device': '', 'resourceTags/user:ELB': '', 'resourceTags/user:Email': '', 'resourceTags/user:Environment': '', 'resourceTags/user:EventCount': '', 'resourceTags/user:FQDN': '', 'resourceTags/user:Host': '', 'resourceTags/user:Hostname': '', 'resourceTags/user:Infra': '', 'resourceTags/user:InstanceId': '', 'resourceTags/user:Instructor': '', 'resourceTags/user:Label': '', 'resourceTags/user:Life': '', 'resourceTags/user:NAME': '', 'resourceTags/user:Name': 'preeves-k3s-worker1', 'resourceTags/user:Network': '', 'resourceTags/user:Note': '', 'resourceTags/user:OS': '', 'resourceTags/user:Owner': '', 'resourceTags/user:PAAS_CREATED_BY': '', 'resourceTags/user:PAAS_LIFETIME_DAYS': '', 'resourceTags/user:PAAS_OS': '', 'resourceTags/user:PAAS_SCHEDULE': '', 'resourceTags/user:PAAS_TZ': '', 'resourceTags/user:Plan': '', 'resourceTags/user:Project': '', 'resourceTags/user:PurgeAfterFE': '', 'resourceTags/user:PurgeAllow': '', 'resourceTags/user:Purpose': '', 'resourceTags/user:Release': '', 'resourceTags/user:Role': '', 'resourceTags/user:Server': '', 'resourceTags/user:SnapShotGroupId': '', 'resourceTags/user:SnapTestRunId': '', 'resourceTags/user:Splunk': '', 'resourceTags/user:Stack': '', 'resourceTags/user:StackName': '', 'resourceTags/user:Stage': '', 'resourceTags/user:Status': '', 'resourceTags/user:Subdomain': '', 'resourceTags/user:TEST': '', 'resourceTags/user:Team': '', 'resourceTags/user:Test': '', 'resourceTags/user:Ticket': '', 'resourceTags/user:Timestamp': '', 'resourceTags/user:Type': '', 'resourceTags/user:USER': '', 'resourceTags/user:Usage': '', 'resourceTags/user:Use': '', 'resourceTags/user:User': '', 'resourceTags/user:ValidationData': '', 'resourceTags/user:VerStackMakr': '', 'resourceTags/user:Volume': '', 'resourceTags/user:ami': '', 'resourceTags/user:ami_name': '', 'resourceTags/user:app': '', 'resourceTags/user:appversion': '', 'resourceTags/user:arch': '', 'resourceTags/user:area': '', 'resourceTags/user:class': '', 'resourceTags/user:cluster': '', 'resourceTags/user:createdBy': '', 'resourceTags/user:creator': '', 'resourceTags/user:customer': '', 'resourceTags/user:customer_type': '', 'resourceTags/user:desc': '', 'resourceTags/user:description': '', 'resourceTags/user:device_name': '', 'resourceTags/user:environment': '', 'resourceTags/user:fqdn': '', 'resourceTags/user:group': '', 'resourceTags/user:host': '', 'resourceTags/user:hostname': '', 'resourceTags/user:instructor': '', 'resourceTags/user:jenkins_slave_type': '', 'resourceTags/user:job_id': '', 'resourceTags/user:job_name': '', 'resourceTags/user:key1': '', 'resourceTags/user:key2': '', 'resourceTags/user:key_pair_id': '', 'resourceTags/user:mode': '', 'resourceTags/user:name': '', 'resourceTags/user:org': '', 'resourceTags/user:origin': '', 'resourceTags/user:os': '', 'resourceTags/user:project': '', 'resourceTags/user:purpose': '', 'resourceTags/user:region': '', 'resourceTags/user:role': '', 'resourceTags/user:sp_connection_id': '', 'resourceTags/user:splunkit.io/department/code': '', 'resourceTags/user:splunkit.io/os/version': '', 'resourceTags/user:splunkit.io/user/email': '', 'resourceTags/user:splunkit.io/user/isPartner': '', 'resourceTags/user:splunkit/app': '', 'resourceTags/user:splunkit/application': '', 'resourceTags/user:splunkit/department': '', 'resourceTags/user:splunkit/dept': '', 'resourceTags/user:splunkit/env': '', 'resourceTags/user:splunkit/environment': '', 'resourceTags/user:splunkit/instance': '', 'resourceTags/user:splunkit/name': '', 'resourceTags/user:splunkit/owner': '', 'resourceTags/user:splunkit/provider': '', 'resourceTags/user:splunkit/provisioner': '', 'resourceTags/user:splunkit/resource': '', 'resourceTags/user:splunkit/team': '', 'resourceTags/user:splunkit/ttl': '', 'resourceTags/user:splunkit/uri': '', 'resourceTags/user:stack': '', 'resourceTags/user:stack_id': '', 'resourceTags/user:stack_version': '', 'resourceTags/user:stage': '', 'resourceTags/user:status': '', 'resourceTags/user:storage': '', 'resourceTags/user:storm_raid': '', 'resourceTags/user:subnet': '', 'resourceTags/user:tag': '', 'resourceTags/user:tag1': '', 'resourceTags/user:target': '', 'resourceTags/user:team': '', 'resourceTags/user:test': '', 'resourceTags/user:type': '', 'resourceTags/user:uri': '', 'resourceTags/user:usage': ''}])

		self.assertEqual(self.lambda_module.csvToJSON(['version,account-id,interface-id,srcaddr,dstaddr,srcport,dstport,protocol,packets,bytes,start,end,action,log-status','2,841154226728,eni-0b48139ba00b9b7bb,3.225.203.212,172.21.12.101,443,33910,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,91.240.118.245,172.21.12.101,54792,3414,6,1,40,1666655969,1666655995,REJECT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.208.215.234,172.21.12.101,443,44024,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.223.109.193,38608,443,6,7,539,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.223.109.193,172.21.12.101,443,38608,6,10,675,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,54.192.76.118,172.21.12.101,443,56238,6,11,6829,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.223.109.193,172.21.12.101,443,59154,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,5.8.18.58,172.21.12.101,54775,10623,6,1,40,1666655969,1666655995,REJECT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.208.215.234,44024,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,192.73.240.132,41641,3478,17,2,136,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,192.73.252.65,172.21.12.101,3478,41641,17,1,72,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,52.94.181.224,172.21.12.101,443,45320,6,20,6719,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.225.203.212,60974,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,52.94.181.224,45320,443,6,20,3269,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.223.109.193,172.21.12.101,443,57994,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,192.73.242.204,41641,3478,17,2,136,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,98.225.75.79,41641,41648,17,282,104132,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,98.225.75.79,172.21.12.101,41648,41641,17,285,63974,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,52.43.162.85,9997,57818,6,173,11620,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.225.203.212,33910,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,203.0.113.1,58070,12345,17,1,101,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.225.203.212,172.21.12.101,443,60974,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,78.128.112.170,172.21.12.101,55754,57539,6,1,40,1666655969,1666655995,REJECT,OK','2,841154226728,eni-0b48139ba00b9b7bb,192.73.242.204,172.21.12.101,3478,41641,17,2,144,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,54.192.76.118,56238,443,6,10,1192,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.223.109.193,59154,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,52.43.162.85,172.21.12.101,57818,9997,6,819,1162439,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,192.73.240.132,172.21.12.101,3478,41641,17,2,144,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,192.73.252.65,41641,3478,17,1,68,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.223.109.193,57994,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,208.111.34.178,172.21.12.101,3478,41641,17,2,144,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,208.111.34.178,41641,3478,17,2,136,1666655969,1666655995,ACCEPT,OK']), [{'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.225.203.212', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '33910', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '91.240.118.245', 'dstaddr': '172.21.12.101', 'srcport': '54792', 'dstport': '3414', 'protocol': '6', 'packets': '1', 'bytes': '40', 'start': '1666655969', 'end': '1666655995', 'action': 'REJECT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.208.215.234', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '44024', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.223.109.193', 'srcport': '38608', 'dstport': '443', 'protocol': '6', 'packets': '7', 'bytes': '539', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.223.109.193', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '38608', 'protocol': '6', 'packets': '10', 'bytes': '675', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '54.192.76.118', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '56238', 'protocol': '6', 'packets': '11', 'bytes': '6829', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.223.109.193', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '59154', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '5.8.18.58', 'dstaddr': '172.21.12.101', 'srcport': '54775', 'dstport': '10623', 'protocol': '6', 'packets': '1', 'bytes': '40', 'start': '1666655969', 'end': '1666655995', 'action': 'REJECT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.208.215.234', 'srcport': '44024', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '192.73.240.132', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '2', 'bytes': '136', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '192.73.252.65', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '1', 'bytes': '72', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '52.94.181.224', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '45320', 'protocol': '6', 'packets': '20', 'bytes': '6719', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.225.203.212', 'srcport': '60974', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '52.94.181.224', 'srcport': '45320', 'dstport': '443', 'protocol': '6', 'packets': '20', 'bytes': '3269', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.223.109.193', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '57994', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '192.73.242.204', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '2', 'bytes': '136', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '98.225.75.79', 'srcport': '41641', 'dstport': '41648', 'protocol': '17', 'packets': '282', 'bytes': '104132', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '98.225.75.79', 'dstaddr': '172.21.12.101', 'srcport': '41648', 'dstport': '41641', 'protocol': '17', 'packets': '285', 'bytes': '63974', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '52.43.162.85', 'srcport': '9997', 'dstport': '57818', 'protocol': '6', 'packets': '173', 'bytes': '11620', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.225.203.212', 'srcport': '33910', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '203.0.113.1', 'srcport': '58070', 'dstport': '12345', 'protocol': '17', 'packets': '1', 'bytes': '101', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.225.203.212', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '60974', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '78.128.112.170', 'dstaddr': '172.21.12.101', 'srcport': '55754', 'dstport': '57539', 'protocol': '6', 'packets': '1', 'bytes': '40', 'start': '1666655969', 'end': '1666655995', 'action': 'REJECT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '192.73.242.204', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '2', 'bytes': '144', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '54.192.76.118', 'srcport': '56238', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1192', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.223.109.193', 'srcport': '59154', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '52.43.162.85', 'dstaddr': '172.21.12.101', 'srcport': '57818', 'dstport': '9997', 'protocol': '6', 'packets': '819', 'bytes': '1162439', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '192.73.240.132', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '2', 'bytes': '144', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '192.73.252.65', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '1', 'bytes': '68', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.223.109.193', 'srcport': '57994', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '208.111.34.178', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '2', 'bytes': '144', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '208.111.34.178', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '2', 'bytes': '136', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}])

		# Test with removing empty rows
		self.lambda_module.SPLUNK_REMOVE_EMPTY_CSV_TO_JSON_FIELDS = "true"
		self.assertEqual(self.lambda_module.csvToJSON(['identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/accessType,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/describes,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeQueryTypes,product/freeTier,product/freeTrial,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/opsItems,product/origin,product/overageType,product/parameterType,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceAssessment,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/softwareType,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage','gxhsea5ks3hqkd4izpcztt3bbyodqrtv2e6c3pji335vli227ffa,2022-07-01T09:00:00Z/2022-07-01T10:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T09:00:00Z,2022-07-01T10:00:00Z,awskms,eu-central-1-KMS-Requests,GetKeyPolicy,,arn:aws:kms:eu-central-1:841154226728:key/566da3aa-ee78-4256-af4b-ae6d197d7e5e,1.0000000000,,,USD,0.0000030000,0.0000030000,0.0000030000,0.0000030000,$0.03 per 10000 KMS requests in EU (Frankfurt),,"Amazon Web Services, Inc.",AWS Key Management Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,awskms-APIRequest-All,All AWS KMS API requests,,,,,,,,,,,,,,,,EU (Frankfurt),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,API Request,,,,,eu-central-1,eu-central-1,,,,,,,,,,,awskms,AWS Key Management Service,,4H6XVYZMMD8MKVZD,,,,,,,,,,,,,,,,,,,,,,,,,,,eu-central-1-KMS-Requests,,,,,,,,,,,,4H6XVYZMMD8MKVZD.JRTCKXETXF.6YS6EN2CT7,7579438446,USD,0.0000030000,0.0000030000,OnDemand,Requests,,,,,,,,,,,8592851312,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','yohlkjq2fglidlmcveuvoqwvyyxxavydhildvtudifnxqij3shtq,2022-07-01T17:00:00Z/2022-07-01T18:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T17:00:00Z,2022-07-01T18:00:00Z,AmazonKinesisFirehose,USW2-BilledBytes,PutRecordBatch,,arn:aws:firehose:us-west-2:841154226728:deliverystream/841154226728-us-west-2-cloudtrail-firehose,0.0029754639,,,USD,0.0290000000,0.0000862885,0.0290000000,0.0000862885,Tier 1 $0.029 per GB of data ingested,,"Amazon Web Services, Inc.",Amazon Kinesis Firehose,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Per GB of data ingested,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Batch Processing,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,PutRecordBatch,,,,,,,,,,,,,,,,,,,,,,,,,,Kinesis Firehose,,,,,us-west-2,us-west-2,,,,,,,,,,,AmazonKinesisFirehose,Amazon Kinesis Firehose,,5267PTSYZKCEH8SQ,,,,,,,,,,,,,,,,1,,,,,,,,,,,USW2-BilledBytes,,,,,,,,,,,,5267PTSYZKCEH8SQ.JRTCKXETXF.HK3AFRJD7J,6906152730,USD,0.0000862885,0.0290000000,OnDemand,GB,,,,,,,,,,,8592851340,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','y2i7wrj74nmhzgulowyenmeaw5fdmv6v725hcp2yvlxt5ltnqrnq,2022-07-01T04:00:00Z/2022-07-01T05:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T04:00:00Z,2022-07-01T05:00:00Z,AWSCloudTrail,USW2-FreeEventsRecorded,None,,,125.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in US West (Oregon) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,us-west-2,us-west-2,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,57SQQK7HQMW76PRE,,,,,,,,,,,,,,,,,,,,,,,,,,,USW2-FreeEventsRecorded,,,,,,,,,,,,57SQQK7HQMW76PRE.JRTCKXETXF.6YS6EN2CT7,7994477393,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,','5vjom4j4ffg2vsgm6druoqtc43tctnz55s2acmgtgg3k6hhawq2q,2022-07-01T07:00:00Z/2022-07-01T08:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2022-07-01T00:00:00Z,2022-08-01T00:00:00Z,841154226728,Usage,2022-07-01T07:00:00Z,2022-07-01T08:00:00Z,AmazonEC2,USW2-DataTransfer-Regional-Bytes,PublicIP-In,,i-0f7700bc526d074e9,0.0033566216,,,USD,0.0030000000,0.0000100699,0.0030000000,0.0000100699,$0.003 per GB - regional data transfer - in/out/between EC2 AZs or using elastic IPs or ELB,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,62WNQUZDQQ6GRJC5,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,IntraRegion,,,,USW2-DataTransfer-Regional-Bytes,,,,,,,,,,,,62WNQUZDQQ6GRJC5.JRTCKXETXF.6YS6EN2CT7,7740772210,USD,0.0000335662,0.0100000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/preeves-k3s-worker1/ac6e2480-d62b-11ec-9c70-0afdd06c1fa1,preeves-k3s-worker1,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,preeves-k3s-worker1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,']), [{'identity/LineItemId': 'gxhsea5ks3hqkd4izpcztt3bbyodqrtv2e6c3pji335vli227ffa', 'identity/TimeInterval': '2022-07-01T09:00:00Z/2022-07-01T10:00:00Z', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T09:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T10:00:00Z', 'lineItem/ProductCode': 'awskms', 'lineItem/UsageType': 'eu-central-1-KMS-Requests', 'lineItem/Operation': 'GetKeyPolicy', 'lineItem/ResourceId': 'arn:aws:kms:eu-central-1:841154226728:key/566da3aa-ee78-4256-af4b-ae6d197d7e5e', 'lineItem/UsageAmount': '1.0000000000', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0000030000', 'lineItem/UnblendedCost': '0.0000030000', 'lineItem/BlendedRate': '0.0000030000', 'lineItem/BlendedCost': '0.0000030000', 'lineItem/LineItemDescription': '$0.03 per 10000 KMS requests in EU (Frankfurt)', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'AWS Key Management Service', 'product/group': 'awskms-APIRequest-All', 'product/groupDescription': 'All AWS KMS API requests', 'product/location': 'EU (Frankfurt)', 'product/locationType': 'AWS Region', 'product/productFamily': 'API Request', 'product/region': 'eu-central-1', 'product/regionCode': 'eu-central-1', 'product/servicecode': 'awskms', 'product/servicename': 'AWS Key Management Service', 'product/sku': '4H6XVYZMMD8MKVZD', 'product/usagetype': 'eu-central-1-KMS-Requests', 'pricing/RateCode': '4H6XVYZMMD8MKVZD.JRTCKXETXF.6YS6EN2CT7', 'pricing/RateId': '7579438446', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000030000', 'pricing/publicOnDemandRate': '0.0000030000', 'pricing/term': 'OnDemand', 'pricing/unit': 'Requests', 'reservation/SubscriptionId': '8592851312'}, {'identity/LineItemId': 'yohlkjq2fglidlmcveuvoqwvyyxxavydhildvtudifnxqij3shtq', 'identity/TimeInterval': '2022-07-01T17:00:00Z/2022-07-01T18:00:00Z', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T17:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T18:00:00Z', 'lineItem/ProductCode': 'AmazonKinesisFirehose', 'lineItem/UsageType': 'USW2-BilledBytes', 'lineItem/Operation': 'PutRecordBatch', 'lineItem/ResourceId': 'arn:aws:firehose:us-west-2:841154226728:deliverystream/841154226728-us-west-2-cloudtrail-firehose', 'lineItem/UsageAmount': '0.0029754639', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0290000000', 'lineItem/UnblendedCost': '0.0000862885', 'lineItem/BlendedRate': '0.0290000000', 'lineItem/BlendedCost': '0.0000862885', 'lineItem/LineItemDescription': 'Tier 1 $0.029 per GB of data ingested', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'Amazon Kinesis Firehose', 'product/description': 'Per GB of data ingested', 'product/group': 'Batch Processing', 'product/location': 'US West (Oregon)', 'product/locationType': 'AWS Region', 'product/operation': 'PutRecordBatch', 'product/productFamily': 'Kinesis Firehose', 'product/region': 'us-west-2', 'product/regionCode': 'us-west-2', 'product/servicecode': 'AmazonKinesisFirehose', 'product/servicename': 'Amazon Kinesis Firehose', 'product/sku': '5267PTSYZKCEH8SQ', 'product/tickettype': '1', 'product/usagetype': 'USW2-BilledBytes', 'pricing/RateCode': '5267PTSYZKCEH8SQ.JRTCKXETXF.HK3AFRJD7J', 'pricing/RateId': '6906152730', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000862885', 'pricing/publicOnDemandRate': '0.0290000000', 'pricing/term': 'OnDemand', 'pricing/unit': 'GB', 'reservation/SubscriptionId': '8592851340'}, {'identity/LineItemId': 'y2i7wrj74nmhzgulowyenmeaw5fdmv6v725hcp2yvlxt5ltnqrnq', 'identity/TimeInterval': '2022-07-01T04:00:00Z/2022-07-01T05:00:00Z', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T04:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T05:00:00Z', 'lineItem/ProductCode': 'AWSCloudTrail', 'lineItem/UsageType': 'USW2-FreeEventsRecorded', 'lineItem/Operation': 'None', 'lineItem/UsageAmount': '125.0000000000', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0000000000', 'lineItem/UnblendedCost': '0.0000000000', 'lineItem/BlendedRate': '0.0000000000', 'lineItem/BlendedCost': '0.0000000000', 'lineItem/LineItemDescription': '0.0 per free event recorded in US West (Oregon) region', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'AWS CloudTrail', 'product/location': 'US West (Oregon)', 'product/locationType': 'AWS Region', 'product/productFamily': 'Management Tools - AWS CloudTrail Free Events Recorded', 'product/region': 'us-west-2', 'product/regionCode': 'us-west-2', 'product/servicecode': 'AWSCloudTrail', 'product/servicename': 'AWS CloudTrail', 'product/sku': '57SQQK7HQMW76PRE', 'product/usagetype': 'USW2-FreeEventsRecorded', 'pricing/RateCode': '57SQQK7HQMW76PRE.JRTCKXETXF.6YS6EN2CT7', 'pricing/RateId': '7994477393', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000000000', 'pricing/publicOnDemandRate': '0.0000000000', 'pricing/term': 'OnDemand', 'pricing/unit': 'Events', 'reservation/SubscriptionId': '8592851348'}, {'identity/LineItemId': '5vjom4j4ffg2vsgm6druoqtc43tctnz55s2acmgtgg3k6hhawq2q', 'identity/TimeInterval': '2022-07-01T07:00:00Z/2022-07-01T08:00:00Z', 'bill/InvoicingEntity': 'Amazon Web Services, Inc.', 'bill/BillingEntity': 'AWS', 'bill/BillType': 'Anniversary', 'bill/PayerAccountId': '562282672475', 'bill/BillingPeriodStartDate': '2022-07-01T00:00:00Z', 'bill/BillingPeriodEndDate': '2022-08-01T00:00:00Z', 'lineItem/UsageAccountId': '841154226728', 'lineItem/LineItemType': 'Usage', 'lineItem/UsageStartDate': '2022-07-01T07:00:00Z', 'lineItem/UsageEndDate': '2022-07-01T08:00:00Z', 'lineItem/ProductCode': 'AmazonEC2', 'lineItem/UsageType': 'USW2-DataTransfer-Regional-Bytes', 'lineItem/Operation': 'PublicIP-In', 'lineItem/ResourceId': 'i-0f7700bc526d074e9', 'lineItem/UsageAmount': '0.0033566216', 'lineItem/CurrencyCode': 'USD', 'lineItem/UnblendedRate': '0.0030000000', 'lineItem/UnblendedCost': '0.0000100699', 'lineItem/BlendedRate': '0.0030000000', 'lineItem/BlendedCost': '0.0000100699', 'lineItem/LineItemDescription': '$0.003 per GB - regional data transfer - in/out/between EC2 AZs or using elastic IPs or ELB', 'lineItem/LegalEntity': 'Amazon Web Services, Inc.', 'product/ProductName': 'Amazon Elastic Compute Cloud', 'product/fromLocation': 'US West (Oregon)', 'product/fromLocationType': 'AWS Region', 'product/fromRegionCode': 'us-west-2', 'product/productFamily': 'Data Transfer', 'product/region': 'us-west-2', 'product/servicecode': 'AWSDataTransfer', 'product/servicename': 'AWS Data Transfer', 'product/sku': '62WNQUZDQQ6GRJC5', 'product/toLocation': 'US West (Oregon)', 'product/toLocationType': 'AWS Region', 'product/toRegionCode': 'us-west-2', 'product/transferType': 'IntraRegion', 'product/usagetype': 'USW2-DataTransfer-Regional-Bytes', 'pricing/RateCode': '62WNQUZDQQ6GRJC5.JRTCKXETXF.6YS6EN2CT7', 'pricing/RateId': '7740772210', 'pricing/currency': 'USD', 'pricing/publicOnDemandCost': '0.0000335662', 'pricing/publicOnDemandRate': '0.0100000000', 'pricing/term': 'OnDemand', 'pricing/unit': 'GB', 'reservation/SubscriptionId': '8592851269', 'resourceTags/aws:cloudformation:logical-id': 'ec2', 'resourceTags/aws:cloudformation:stack-id': 'arn:aws:cloudformation:us-west-2:841154226728:stack/preeves-k3s-worker1/ac6e2480-d62b-11ec-9c70-0afdd06c1fa1', 'resourceTags/aws:cloudformation:stack-name': 'preeves-k3s-worker1', 'resourceTags/aws:createdBy': 'AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com', 'resourceTags/user:Name': 'preeves-k3s-worker1'}])
		self.assertEqual(self.lambda_module.csvToJSON(['version,account-id,interface-id,srcaddr,dstaddr,srcport,dstport,protocol,packets,bytes,start,end,action,log-status','2,841154226728,eni-0b48139ba00b9b7bb,3.225.203.212,172.21.12.101,443,33910,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,91.240.118.245,172.21.12.101,54792,3414,6,1,40,1666655969,1666655995,REJECT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.208.215.234,172.21.12.101,443,44024,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.223.109.193,38608,443,6,7,539,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.223.109.193,172.21.12.101,443,38608,6,10,675,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,54.192.76.118,172.21.12.101,443,56238,6,11,6829,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.223.109.193,172.21.12.101,443,59154,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,5.8.18.58,172.21.12.101,54775,10623,6,1,40,1666655969,1666655995,REJECT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.208.215.234,44024,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,192.73.240.132,41641,3478,17,2,136,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,192.73.252.65,172.21.12.101,3478,41641,17,1,72,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,52.94.181.224,172.21.12.101,443,45320,6,20,6719,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.225.203.212,60974,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,52.94.181.224,45320,443,6,20,3269,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.223.109.193,172.21.12.101,443,57994,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,192.73.242.204,41641,3478,17,2,136,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,98.225.75.79,41641,41648,17,282,104132,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,98.225.75.79,172.21.12.101,41648,41641,17,285,63974,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,52.43.162.85,9997,57818,6,173,11620,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.225.203.212,33910,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,203.0.113.1,58070,12345,17,1,101,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,3.225.203.212,172.21.12.101,443,60974,6,11,4832,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,78.128.112.170,172.21.12.101,55754,57539,6,1,40,1666655969,1666655995,REJECT,OK','2,841154226728,eni-0b48139ba00b9b7bb,192.73.242.204,172.21.12.101,3478,41641,17,2,144,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,54.192.76.118,56238,443,6,10,1192,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.223.109.193,59154,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,52.43.162.85,172.21.12.101,57818,9997,6,819,1162439,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,192.73.240.132,172.21.12.101,3478,41641,17,2,144,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,192.73.252.65,41641,3478,17,1,68,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,3.223.109.193,57994,443,6,10,1450,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,208.111.34.178,172.21.12.101,3478,41641,17,2,144,1666655969,1666655995,ACCEPT,OK','2,841154226728,eni-0b48139ba00b9b7bb,172.21.12.101,208.111.34.178,41641,3478,17,2,136,1666655969,1666655995,ACCEPT,OK']), [{'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.225.203.212', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '33910', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '91.240.118.245', 'dstaddr': '172.21.12.101', 'srcport': '54792', 'dstport': '3414', 'protocol': '6', 'packets': '1', 'bytes': '40', 'start': '1666655969', 'end': '1666655995', 'action': 'REJECT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.208.215.234', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '44024', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.223.109.193', 'srcport': '38608', 'dstport': '443', 'protocol': '6', 'packets': '7', 'bytes': '539', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.223.109.193', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '38608', 'protocol': '6', 'packets': '10', 'bytes': '675', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '54.192.76.118', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '56238', 'protocol': '6', 'packets': '11', 'bytes': '6829', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.223.109.193', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '59154', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '5.8.18.58', 'dstaddr': '172.21.12.101', 'srcport': '54775', 'dstport': '10623', 'protocol': '6', 'packets': '1', 'bytes': '40', 'start': '1666655969', 'end': '1666655995', 'action': 'REJECT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.208.215.234', 'srcport': '44024', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '192.73.240.132', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '2', 'bytes': '136', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '192.73.252.65', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '1', 'bytes': '72', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '52.94.181.224', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '45320', 'protocol': '6', 'packets': '20', 'bytes': '6719', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.225.203.212', 'srcport': '60974', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '52.94.181.224', 'srcport': '45320', 'dstport': '443', 'protocol': '6', 'packets': '20', 'bytes': '3269', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.223.109.193', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '57994', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '192.73.242.204', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '2', 'bytes': '136', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '98.225.75.79', 'srcport': '41641', 'dstport': '41648', 'protocol': '17', 'packets': '282', 'bytes': '104132', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '98.225.75.79', 'dstaddr': '172.21.12.101', 'srcport': '41648', 'dstport': '41641', 'protocol': '17', 'packets': '285', 'bytes': '63974', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '52.43.162.85', 'srcport': '9997', 'dstport': '57818', 'protocol': '6', 'packets': '173', 'bytes': '11620', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.225.203.212', 'srcport': '33910', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '203.0.113.1', 'srcport': '58070', 'dstport': '12345', 'protocol': '17', 'packets': '1', 'bytes': '101', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '3.225.203.212', 'dstaddr': '172.21.12.101', 'srcport': '443', 'dstport': '60974', 'protocol': '6', 'packets': '11', 'bytes': '4832', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '78.128.112.170', 'dstaddr': '172.21.12.101', 'srcport': '55754', 'dstport': '57539', 'protocol': '6', 'packets': '1', 'bytes': '40', 'start': '1666655969', 'end': '1666655995', 'action': 'REJECT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '192.73.242.204', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '2', 'bytes': '144', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '54.192.76.118', 'srcport': '56238', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1192', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.223.109.193', 'srcport': '59154', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '52.43.162.85', 'dstaddr': '172.21.12.101', 'srcport': '57818', 'dstport': '9997', 'protocol': '6', 'packets': '819', 'bytes': '1162439', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '192.73.240.132', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '2', 'bytes': '144', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '192.73.252.65', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '1', 'bytes': '68', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '3.223.109.193', 'srcport': '57994', 'dstport': '443', 'protocol': '6', 'packets': '10', 'bytes': '1450', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '208.111.34.178', 'dstaddr': '172.21.12.101', 'srcport': '3478', 'dstport': '41641', 'protocol': '17', 'packets': '2', 'bytes': '144', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}, {'version': '2', 'account-id': '841154226728', 'interface-id': 'eni-0b48139ba00b9b7bb', 'srcaddr': '172.21.12.101', 'dstaddr': '208.111.34.178', 'srcport': '41641', 'dstport': '3478', 'protocol': '17', 'packets': '2', 'bytes': '136', 'start': '1666655969', 'end': '1666655995', 'action': 'ACCEPT', 'log-status': 'OK'}])

	def test_cgetTimestamp_prefix_ISO8601(self):
		
		# Test with prefix-ISO8601
		self.lambda_module.SPLUNK_TIME_FORMAT = "prefix-ISO8601"
		self.lambda_module.SPLUNK_TIME_PREFIX = "eventTime"
		self.assertEqual(self.lambda_module.getTimestamp("{'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 's3.amazonaws.com'}, 'eventTime': '2023-01-24T16:35:03Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'PutObject', 'awsRegion': 'us-west-2', 'sourceIPAddress': 's3.amazonaws.com', 'userAgent': 's3.amazonaws.com', 'errorCode': 'AccessDenied', 'errorMessage': 'Access Denied', 'requestParameters': {'bucketName': '841154226728-us-west-2-s3serveraccesslog', 'Host': 's3.us-west-2.amazonaws.com', 'key': 'csearch-us-west-2-public-bucket/2023-01-24-16-35-03-47DF8778CFDD78C5'}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 0.0, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'ojwjGZ6w+/skVUpckohex2XQYB4pS/Agh02EAeCBXVbGKPdG+NbAXsbEzc7KlONPBZiGDeMWUfk=', 'bytesTransferredOut': 243.0}, 'requestID': '75N88MRRR4YQPA62', 'eventID': '50f14e95-2370-40d9-9c75-5ce0f99029f1', 'readOnly': False, 'resources': [{'type': 'AWS::S3::Object', 'ARN': 'arn:aws:s3:::841154226728-us-west-2-s3serveraccesslog/csearch-us-west-2-public-bucket/2023-01-24-16-35-03-47DF8778CFDD78C5'}, {'accountId': '841154226728', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::841154226728-us-west-2-s3serveraccesslog'}], 'eventType': 'AwsApiCall', 'managementEvent': False, 'recipientAccountId': '841154226728', 'sharedEventID': '3d5737b0-6dde-4b7d-ba21-8a1b7ae8b197', 'vpcEndpointId': 'vpce-a0d039c9', 'eventCategory': 'Data'}", ""), 1674578103.0)

		self.lambda_module.SPLUNK_TIME_PREFIX = "eventTime41"
		self.assertEqual(self.lambda_module.getTimestamp("{'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 's3.amazonaws.com'}, 'eventTime41': '2023-01-24T16:40:21Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'PutObject', 'awsRegion': 'us-west-2', 'sourceIPAddress': 's3.amazonaws.com', 'userAgent': 's3.amazonaws.com', 'errorCode': 'AccessDenied', 'errorMessage': 'Access Denied', 'requestParameters': {'bucketName': '841154226728-us-west-2-s3serveraccesslog', 'Host': 's3.us-west-2.amazonaws.com', 'key': 'csearch-us-west-2-public-bucket/2023-01-24-16-40-21-36F195E1456DCDCC'}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 0.0, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'UKCehsUFvg6h+sJKf1YpBGcLkQFN0VMtplWvexYgx+JavuDOkzG2nbvQWHXCWZM1gT8XFe18KjE=', 'bytesTransferredOut': 243.0}, 'requestID': '3PX0SBSY61VQBCMR', 'eventID': '234ca255-0288-4c2e-a120-a572270cf89f', 'readOnly': False, 'resources': [{'type': 'AWS::S3::Object', 'ARN': 'arn:aws:s3:::841154226728-us-west-2-s3serveraccesslog/csearch-us-west-2-public-bucket/2023-01-24-16-40-21-36F195E1456DCDCC'}, {'accountId': '841154226728', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::841154226728-us-west-2-s3serveraccesslog'}], 'eventType': 'AwsApiCall', 'managementEvent': False, 'recipientAccountId': '841154226728', 'sharedEventID': '1cb966da-86b7-431d-87a7-569a3c10e049', 'vpcEndpointId': 'vpce-a0d039c9', 'eventCategory': 'Data'}", ""), 1674578421.0)

		self.lambda_module.SPLUNK_TIME_PREFIX = "eventTime"
		self.assertEqual(self.lambda_module.getTimestamp("{'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 'lambda.amazonaws.com'}, 'eventTime': '2022-01-19T16:41:14Z', 'eventSource': 'lambda.amazonaws.com', 'eventName': 'Invoke', 'awsRegion': 'us-west-2', 'sourceIPAddress': 'lambda.amazonaws.com', 'userAgent': 'lambda.amazonaws.com', 'requestParameters': {'functionName': 'arn:aws:lambda:us-west-2:841154226728:function:841154226728-us-west-2-vpcflowlog-lambda-function', 'invocationType': 'RequestResponse', 'logType': 'None'}, 'responseElements': None, 'additionalEventData': {'functionVersion': 'arn:aws:lambda:us-west-2:841154226728:function:841154226728-us-west-2-vpcflowlog-lambda-function:$LATEST'}, 'requestID': 'da756974-77df-57f0-8f92-353e7b8c8662', 'eventID': '893187ee-81ea-4755-b1d7-08f48bbffaed', 'readOnly': False, 'resources': [{'accountId': '841154226728', 'type': 'AWS::Lambda::Function', 'ARN': 'arn:aws:lambda:us-west-2:841154226728:function:841154226728-us-west-2-vpcflowlog-lambda-function'}], 'eventType': 'AwsApiCall', 'managementEvent': False, 'recipientAccountId': '841154226728', 'sharedEventID': 'f02269fd-bfb9-491e-9f58-d7f0600bd358', 'eventCategory': 'Data'}", ""), 1642610474.0)

		# Test with improperly formatted prefix-ISO8601 timestamp
		self.assertEqual(round(self.lambda_module.getTimestamp("{'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 'lambda.amazonaws.com'}, 'eventTime': '2022-0zz1-19T16:41:14Z', 'eventSource': 'lambda.amazonaws.com', 'eventName': 'Invoke', 'awsRegion': 'us-west-2', 'sourceIPAddress': 'lambda.amazonaws.com', 'userAgent': 'lambda.amazonaws.com', 'requestParameters': {'functionName': 'arn:aws:lambda:us-west-2:841154226728:function:841154226728-us-west-2-vpcflowlog-lambda-function', 'invocationType': 'RequestResponse', 'logType': 'None'}, 'responseElements': None, 'additionalEventData': {'functionVersion': 'arn:aws:lambda:us-west-2:841154226728:function:841154226728-us-west-2-vpcflowlog-lambda-function:$LATEST'}, 'requestID': 'da756974-77df-57f0-8f92-353e7b8c8662', 'eventID': '893187ee-81ea-4755-b1d7-08f48bbffaed', 'readOnly': False, 'resources': [{'accountId': '841154226728', 'type': 'AWS::Lambda::Function', 'ARN': 'arn:aws:lambda:us-west-2:841154226728:function:841154226728-us-west-2-vpcflowlog-lambda-function'}], 'eventType': 'AwsApiCall', 'managementEvent': False, 'recipientAccountId': '841154226728', 'sharedEventID': 'f02269fd-bfb9-491e-9f58-d7f0600bd358', 'eventCategory': 'Data'}", ""), 0), round(time.time(), 0))

	def test_cgetTimestamp_prefix_epoch(self):
		
		# Test with prefix-epoch
		self.lambda_module.SPLUNK_TIME_FORMAT = "prefix-epoch"

		self.lambda_module.SPLUNK_TIME_PREFIX = "time"
		self.assertEqual(self.lambda_module.getTimestamp("testevent time: 1674580913", ""), 1674580913)
		self.assertEqual(self.lambda_module.getTimestamp("wordsthatdontmeanthings123 time31: 1674580913", ""), 1674580913)

		self.lambda_module.SPLUNK_TIME_PREFIX = "time31"
		self.assertEqual(self.lambda_module.getTimestamp("wordsthatdontmeanthings123 time31: 1674580913", ""), 1674580913)

		self.lambda_module.SPLUNK_TIME_PREFIX = "3132"
		self.assertEqual(self.lambda_module.getTimestamp("wordsthatdontmeanthings123 3132: 1674580913", ""), 1674580913)

		# Test with improperly formatted prefix-epoch timestamp
		self.lambda_module.SPLUNK_TIME_PREFIX = "time"
		self.assertEqual(round(self.lambda_module.getTimestamp("wordsthatdontmeanthings123 3132: 1674580913", ""), 0), round(time.time(), 0))
		self.assertEqual(round(self.lambda_module.getTimestamp("wordsthatdontmeanthings123 time3asdffdsasdffdas: 1674580913", ""), 0), round(time.time(), 0))
		self.assertEqual(round(self.lambda_module.getTimestamp("wordsthatdontmeanthings123 badtime123: 1674580913", ""), 0), 1674580913)

	def test_getTimestamp_delineated_epoch(self):
		
		# Test with delineated-epoch, vpcflow log, space delimited
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-epoch"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "10"

		self.assertEqual(self.lambda_module.getTimestamp("2 841154226728 eni-0b48139ba00b9b7bb 192.73.240.132 172.21.12.101 443 60816 6 158 71263 1672790555 1672790581 ACCEPT OK", " "), 1672790555)
		self.assertEqual(self.lambda_module.getTimestamp("2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 36914 6 11 4831 1672790511 1672790581 ACCEPT OK", " "), 1672790511)
		self.assertEqual(round(self.lambda_module.getTimestamp("2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 36914 6 11 4831 1672a790511 1672790581 ACCEPT OK", ""), 0), round(time.time(), 0))

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp("2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 36914 6 11 4831 1672a790511 1672790581 ACCEPT OK", ""), 0), round(time.time(), 0))

		# Test with delineated-epoch, vpcflow log but comma delimited
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-epoch"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "10"

		self.assertEqual(self.lambda_module.getTimestamp("2,841154226728,eni-0b48139ba00b9b7bb,192.73.240.132,172.21.12.101,443,60816,6,158,71263,1672790555,1672790581,ACCEPT,OK", ","), 1672790555)
		self.assertEqual(self.lambda_module.getTimestamp("2,841154226728,eni-0b48139ba00b9b7bb,3.208.215.234,172.21.12.101,443,36914,6,11,4831,1672790511,1672790581,ACCEPT,OK", ","), 1672790511)
		self.assertEqual(round(self.lambda_module.getTimestamp("2,841154226728,eni-0b48139ba00b9b7bb,3.208.215.234,172.21.12.101,443,36914,6,11,4831,1672790a511,1672790581,ACCEPT,OK", ","),0), round(time.time(),0))

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp("2,841154226728,eni-0b48139ba00b9b7bb,3.208.215.234,172.21.12.101,443,36914,6,11,4831,1672790a511,1672790581,ACCEPT,OK", ","),0), round(time.time(),0))


		# Test with delineated-epoch, vpcflow log but tab delimited and with the end time of the stream
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-epoch"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "11"

		self.assertEqual(self.lambda_module.getTimestamp("2	841154226728	eni-0b48139ba00b9b7bb	192.73.240.132	172.21.12.101	443	60816	6	158	71263	1672790555	1672790581	ACCEPT	OK", "	"), 1672790581)
		self.assertEqual(self.lambda_module.getTimestamp("2	841154226728	eni-0b48139ba00b9b7bb	3.208.215.234	172.21.12.101	443	36914	6	11	4831	1672790511	1672790545	ACCEPT	OK", "	"), 1672790545)
		self.assertEqual(round(self.lambda_module.getTimestamp("2	841154226728	eni-0b48139ba00b9b7bb	3.208.215.234	172.21.12.101	443	36914	6	11	4831	1672790511	167a2790545	ACCEPT	OK", ","),0), round(time.time(),0))

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp("2	841154226728	eni-0b48139ba00b9b7bb	3.208.215.234	172.21.12.101	443	36914	6	11	4831	1672790511	167a2790545	ACCEPT	OK", ","),0), round(time.time(),0))

	def test_getTimestamp_delineated_ISO8601(self):
		
		# Test with delineated-epoch, ELB access log, space delimited
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-ISO8601"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "1"
		self.assertEqual(self.lambda_module.getTimestamp('http 2022-05-23T18:14:27.251617Z app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8 180.129.199.58:59892 172.21.11.125:80 0.001 0.001 0.000 200 200 548 3428 "GET http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/ HTTP/1.1" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36" - - arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e "Root=1-628bcf03-5c8fb6455464990b1c7ae840" "-" "-" 0 2022-05-23T18:14:27.248000Z "forward" "-" "-" "172.21.11.125:80" "200" "-" "-"', " "), 1653329667.251617)
		self.assertEqual(self.lambda_module.getTimestamp('http 2022-05-23T18:14:27.425920Z app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8 180.129.199.58:59892 172.21.11.125:80 0.000 0.001 0.000 200 200 525 3576 "GET http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/icons/ubuntu-logo.png HTTP/1.1" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36" - - arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e "Root=1-628bcf03-329f756e3e2f6eb75a563aa4" "-" "-" 0 2022-05-23T18:14:27.424000Z "forward" "-" "-" "172.21.11.125:80" "200" "-" "-"', " "), 1653329667.42592)

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp('http 2022-05-23T18:14:27.425920Z app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8 180.129.199.58:59892 172.21.11.125:80 0.000 0.001 0.000 200 200 525 3576 "GET http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/icons/ubuntu-logo.png HTTP/1.1" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36" - - arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e "Root=1-628bcf03-329f756e3e2f6eb75a563aa4" "-" "-" 0 2022-05-23T18:14:27.424000Z "forward" "-" "-" "172.21.11.125:80" "200" "-" "-", ","', " "),0), round(time.time(),0))


		# Test with delineated-epoch, ELB access log, comma delimited
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-ISO8601"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "0"
		self.assertEqual(self.lambda_module.getTimestamp('2022-05-23T18:14:27.251617Z,app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8,180.129.199.58:59892,172.21.11.125:80,0.001,0.001,0.000,200,200,548,3428,"GET,http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/,HTTP/1.1","Mozilla/5.0,(Macintosh;,Intel,Mac,OS,X,10_15_7),AppleWebKit/537.36,(KHTML,,like,Gecko),Chrome/101.0.4951.64,Safari/537.36",-,-,arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e,"Root=1-628bcf03-5c8fb6455464990b1c7ae840","-","-",0,2022-05-23T18:14:27.248000Z,"forward","-","-","172.21.11.125:80","200","-","-"', ","), 1653329667.251617)
		self.assertEqual(self.lambda_module.getTimestamp('2022-05-23T18:14:27.425920Z,app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8,180.129.199.58:59892,172.21.11.125:80,0.000,0.001,0.000,200,200,525,3576,"GET,http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/icons/ubuntu-logo.png,HTTP/1.1","Mozilla/5.0,(Macintosh;,Intel,Mac,OS,X,10_15_7),AppleWebKit/537.36,(KHTML,,like,Gecko),Chrome/101.0.4951.64,Safari/537.36",-,-,arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e,"Root=1-628bcf03-329f756e3e2f6eb75a563aa4","-","-",0,2022-05-23T18:14:27.424000Z,"forward","-","-","172.21.11.125:80","200","-","-"', ","), 1653329667.42592)

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp('2022-05-23T18:14:27.425920Z,app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8,180.129.199.58:59892,172.21.11.125:80,0.000,0.001,0.000,200,200,525,3576,"GET,http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/icons/ubuntu-logo.png,HTTP/1.1","Mozilla/5.0,(Macintosh;,Intel,Mac,OS,X,10_15_7),AppleWebKit/537.36,(KHTML,,like,Gecko),Chrome/101.0.4951.64,Safari/537.36",-,-,arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e,"Root=1-628bcf03-329f756e3e2f6eb75a563aa4","-","-",0,2022-05-23T18:14:27.424000Z,"forward","-","-","172.21.11.125:80","200","-","-"', ","),0), round(time.time(),0))

		# Test with delineated-epoch, ELB access log, tab delimited
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-ISO8601"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "2"
		self.assertEqual(self.lambda_module.getTimestamp('http	mock	2022-05-23T18:14:27.251617Z	app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8	180.129.199.58:59892	172.21.11.125:80	0.001	0.001	0.000	200	200	548	3428	"GET	http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/	HTTP/1.1"	"Mozilla/5.0	(Macintosh;	Intel	Mac	OS	X	10_15_7)	AppleWebKit/537.36	(KHTML,	like	Gecko)	Chrome/101.0.4951.64	Safari/537.36"	-	-	arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e	"Root=1-628bcf03-5c8fb6455464990b1c7ae840"	"-"	"-"	0	2022-05-23T18:14:27.248000Z	"forward"	"-"	"-"	"172.21.11.125:80"	"200"	"-"	"-"',"	"), 1653329667.251617)
		self.assertEqual(self.lambda_module.getTimestamp('http	mock	2022-05-23T18:14:27.425920Z	app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8	180.129.199.58:59892	172.21.11.125:80	0.000	0.001	0.000	200	200	525	3576	"GET	http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/icons/ubuntu-logo.png	HTTP/1.1"	"Mozilla/5.0	(Macintosh;	Intel	Mac	OS	X	10_15_7)	AppleWebKit/537.36	(KHTML,	like	Gecko)	Chrome/101.0.4951.64	Safari/537.36"	-	-	arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e	"Root=1-628bcf03-329f756e3e2f6eb75a563aa4"	"-"	"-"	0	2022-05-23T18:14:27.424000Z	"forward"	"-"	"-"	"172.21.11.125:80"	"200"	"-"	"-"', "	"), 1653329667.42592)

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp('http	mock	2022-05-23T18:14:27.425920Z	app/gditoolkit-elbv2-14MI7OWL3PLKA/5d0bd31f3e9aecb8	180.129.199.58:59892	172.21.11.125:80	0.000	0.001	0.000	200	200	525	3576	"GET	http://gditoolkit-elbv2-14mi7owl3plka-1413486595.us-west-2.elb.amazonaws.com:80/icons/ubuntu-logo.png	HTTP/1.1"	"Mozilla/5.0	(Macintosh;	Intel	Mac	OS	X	10_15_7)	AppleWebKit/537.36	(KHTML,	like	Gecko)	Chrome/101.0.4951.64	Safari/537.36"	-	-	arn:aws:elasticloadbalancing:us-west-2:012345678901:targetgroup/gdiDemo/6206628e2424a61e	"Root=1-628bcf03-329f756e3e2f6eb75a563aa4"	"-"	"-"	0	2022-05-23T18:14:27.424000Z	"forward"	"-"	"-"	"172.21.11.125:80"	"200"	"-"	"-"', "	"),0), round(time.time(),0))

	def test_getTimestamp_delineated_strftime(self):
		
		# Test with delineated-epoch, S3 server access logs access log, space delimited
		self.lambda_module.SPLUNK_TIME_FORMAT = "delineated-strftime"
		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "2"
		self.lambda_module.SPLUNK_STRFTIME_FORMAT = "[%d/%b/%Y:%H:%M:%S"
		self.assertEqual(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:00 +0000] 72.21.217.31 - XMCYE060BFAZFRK3 REST.HEAD.BUCKET - "HEAD / HTTP/1.1" 400 AuthorizationHeaderMalformed 365 - 2 - "-" "AWSConfig cfg/retry-mode/standard" - ynZYVfwfhjosIEcsZsYktTCU4lLWvxf0eNzLAFbMGNsgHE5KAi9EDMmZ0KewtKkmPvBCIDre6BY= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.amazonaws.com TLSv1.2 - -', " "), 1667912820)
		self.assertEqual(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [09/Nov/2022:06:07:16 +0000] 54.240.197.1 - S6SACNCB371CHXDR REST.HEAD.BUCKET - "HEAD / HTTP/1.1" 400 AuthorizationHeaderMalformed 365 - 3 - "-" "AWSConfig cfg/retry-mode/standard" - 5cJHnUc0zONwbsTwrwh1TV3NAuqzf/1uPAYZjPd7RKlg4dxxKSWZmvOoBkWugQbQ44rphIvlRQs= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.amazonaws.com TLSv1.2 - -', " "), 1667974036)
		self.assertEqual(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [11/Nov/2022:03:07:19 +0000] 54.239.6.87 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe 0N7GD2KZAM46996V REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - uQ7Sh98K4JbFhiNMudvH3h/EqiUu0c05wBnDAwtBdKBMD9d9yOZ8uRe4X5O0V19EBXbszAP3H9k= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', " "), 1668136039)

		self.assertEqual(round(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [11/Novz/2022:03:07:19 +0000] 54.239.6.87 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe 0N7GD2KZAM46996V REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - uQ7Sh98K4JbFhiNMudvH3h/EqiUu0c05wBnDAwtBdKBMD9d9yOZ8uRe4X5O0V19EBXbszAP3H9k= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', " "),0), round(time.time(),0))
		self.assertEqual(round(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [45/Nov/2022:03:07:19 +0000] 54.239.6.87 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe 0N7GD2KZAM46996V REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - uQ7Sh98K4JbFhiNMudvH3h/EqiUu0c05wBnDAwtBdKBMD9d9yOZ8uRe4X5O0V19EBXbszAP3H9k= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', " "),0), round(time.time(),0))
		self.assertEqual(round(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [11/Novz/2022:28:07:19 +0000] 54.239.6.87 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe 0N7GD2KZAM46996V REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - uQ7Sh98K4JbFhiNMudvH3h/EqiUu0c05wBnDAwtBdKBMD9d9yOZ8uRe4X5O0V19EBXbszAP3H9k= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', " "),0), round(time.time(),0))

		self.lambda_module.SPLUNK_TIME_DELINEATED_FIELD = "42"
		self.assertEqual(round(self.lambda_module.getTimestamp('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [11/Nov/2022:03:07:19 +0000] 54.239.6.87 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe 0N7GD2KZAM46996V REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - uQ7Sh98K4JbFhiNMudvH3h/EqiUu0c05wBnDAwtBdKBMD9d9yOZ8uRe4X5O0V19EBXbszAP3H9k= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', " "),0), round(time.time(),0))

	def test_downloadS3Object(self):

		# Test with files that do exist
		testFiles = ["testFile1.log", "testdir/123/testFile2.log"]

		for testFile in testFiles:
			# Validate return message
			self.assertEqual(self.lambda_module.downloadS3Object("s3-sqs-lambda-firehose-bucket", testFile), "/tmp/" + testFile.split("/")[-1])

			# Validate that file was retrieved correctly and the contents match the test file
			originalFile = ""
			with open("test-artifacts/" + testFile, 'r') as file:
				originalFile = file.read()

			downloadedFile = ""
			with open("/tmp/" + testFile.split("/")[-1], 'r') as file:
				downloadedFile = file.read()

			self.assertEqual(originalFile, downloadedFile)

		# Test with invalid files that do not exist
		self.assertEqual(self.lambda_module.downloadS3Object("s3-sqs-lambda-firehose-bucket-non-existent", "testFile1.log"), "Unable to download file s3://s3-sqs-lambda-firehose-bucket-non-existent/testFile1.log")
		self.assertEqual(self.lambda_module.downloadS3Object("s3-sqs-lambda-firehose-bucket", "non-existent-file.txt"), "Unable to download file s3://s3-sqs-lambda-firehose-bucket/non-existent-file.txt")
		self.assertEqual(self.lambda_module.downloadS3Object("s3-sqs-lambda-firehose-bucket-non-existent", "non-existent-file.txt"), "Unable to download file s3://s3-sqs-lambda-firehose-bucket-non-existent/non-existent-file.txt")


	def tearDown(self):

		# Stop moto
		self.mock_s3.stop()

		# Delete all files in tmp
		files = glob.glob('/tmp/*')
		for file in files:
			os.remove(file)


if __name__ == '__main__':
	unittest.main()
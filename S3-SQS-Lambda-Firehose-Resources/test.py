import unittest, os, importlib


class CloudWatchMetrics_Firehose_Resources_Tests(unittest.TestCase):

	def setUp(self):
		# Set environment variables
		os.environ['firehoseDeliverySreamName'] = "main"
		os.environ['AWS_REGION'] = "main"
		os.environ['SPLUNK_INDEX'] = "main"
		os.environ['SPLUNK_TIME_PREFIX'] = "main"
		os.environ['SPLUNK_EVENT_DELIMITER'] = "main"
		os.environ['SPLUNK_TIME_DELINEATED_FIELD'] = "main"
		os.environ['SPLUNK_TIME_FORMAT'] = "main"
		os.environ['SPLUNK_STRFTIME_FORMAT'] = "main"
		os.environ['SPLUNK_SOURCETYPE'] = "main"
		os.environ['SPLUNK_SOURCE'] = "main"
		os.environ['SPLUNK_HOST'] = "main"
		os.environ['SPLUNK_JSON_FORMAT'] = "main"
		os.environ['SPLUNK_IGNORE_FIRST_LINE'] = "main"
		os.environ['SPLUNK_CSV_TO_JSON'] = "main"
		os.environ['SPLUNK_REMOVE_EMPTY_CSV_TO_JSON_FIELDS'] = "main"

		self.lambda_module = importlib.import_module('lambda')

		self.lambda_module.SPLUNK_SOURCETYPE = "main"
		self.lambda_module.SPLUNK_JSON_FORMAT = "main"


	def test_createDdelimiter(self):
		
		# Test with un-swapped delimiters
		self.assertEqual(self.lambda_module.createDelimiter("none"), "none")
		self.assertEqual(self.lambda_module.createDelimiter("main"), "main")
		self.assertNotEqual(self.lambda_module.createDelimiter("none"), " ")

		# Test with delimiters to be swapped
		self.assertEqual(self.lambda_module.createDelimiter("comma"), ",")
		self.assertEqual(self.lambda_module.createDelimiter("space"), " ")
		self.assertEqual(self.lambda_module.createDelimiter("tab"), "	")
		self.assertEqual(self.lambda_module.createDelimiter("semicolon"), ";")

	def test_retrieveObjectInfo(self):

		# Test with working paths
		self.assertEqual(self.lambda_module.retrieveObjectInfo({'messageId': '0ed4e10e-7fe3-41c8-ba7e-59b0c90826f3', 'receiptHandle': 'AQEBrbGkhIBIrdBxqc9HfoDkMkaNz7/OE4jftgDzblOgi6aY4xgKPteadRUkKhr2apF8LYVsA9dZXVxPyQM74Tb0p8hNvZojgZW39Q0w8U75Lo/URZtpq/KT/LP+NBn5AUlYHwgV2Zy/i6TAs6EkNPjPj/+VYC8fNpaPeV5cFys/2Ql5hK1PTpvewhIe2TNLMjj2BUNWycSuboa5N6n5tY0wQG84JQvceb6tGW9x5Lb/ZP/ortmAZH+Yn5iUrg0sJwdudff1WdH8xZPSR3mSttskL7sSfEHS1cGLNr1XsHz4xpmX5Mv+xpievXjLMIESaO6aNoqBmQDPlZcExBJbWEXyDWrzVrU3YeQuTYaOFKXX8sf28aROG7jxJhk9NR5TSBR3w+vmuz0tgtm0pEqLHQPiC+MSi1nJeO7NbnPcnTqwvRLotFdmhlWAYBbPYsMuAoqp', 'body': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-2","eventTime":"2023-01-21T21:08:44.251Z","eventName":"ObjectCreated:Put","userIdentity":{"principalId":"AWS:AROAV2CJ256E23ZOBRSAF:prod.pdx.dbs.datafeeds.aws.internal"},"requestParameters":{"sourceIPAddress":"172.18.238.76"},"responseElements":{"x-amz-request-id":"81KMJ9RD5J340C2G","x-amz-id-2":"ORkLTETarSJwEOsMpQaqiVSdT8uoocAjB7tOlkVzfNMrqaGPRFHR4Jb4Pxxl9UauHUq4pgDuXZ/RZkH3BQHAlHvlDZ3C3rXj"},"s3":{"s3SchemaVersion":"1.0","configurationId":"85153fb0-1426-494e-9c4e-ffffe0ebf520","bucket":{"name":"841154226728-us-west-2-vpcflowlog","ownerIdentity":{"principalId":"A12SQTDQCD6TT5"},"arn":"arn:aws:s3:::841154226728-us-west-2-vpcflowlog"},"object":{"key":"AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2100Z_1ce1bf4b.log.gz","size":2595,"eTag":"0557d1d84c8f071523cc7d18ebf58d5a","sequencer":"0063CC545C372D5A7F"}}}]}', 'attributes': {'ApproximateReceiveCount': '1', 'SentTimestamp': '1674335325396', 'SenderId': 'AIDAJFWZWTE5KRAMGW5A2', 'ApproximateFirstReceiveTimestamp': '1674335325404'}, 'messageAttributes': {}, 'md5OfBody': '1910f3b491509daba1ceadca474a08c8', 'md5OfMessageAttributes': None, 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-west-2:841154226728:841154226728-us-west-2-vpcflowlog-sqs-queue', 'awsRegion': 'us-west-2'}), {'bucket': '841154226728-us-west-2-vpcflowlog', 'key': 'AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2100Z_1ce1bf4b.log.gz'})
		self.assertEqual(self.lambda_module.retrieveObjectInfo({'messageId': '65dd2ea3-8dc4-42fd-a180-ac91961ea2ee', 'receiptHandle': 'AQEBGerSNcBRWgr2QMCua2Q/J0m5yeHOqgzteDgS2Hmj1ZwcmAN1jITp5M+7hBLEBkL4McwVOlJJQAbPm99HZt3AhJmLX6hSqOtF8Bm2M7uP78s02L3gU1N3/1SZheorY+HCNo7smYxXLm2uYsAU/+evxEjcZzAGUBLnXpNnwT6kiU3qWw8GQ0FTci5NmGee4lt5RJjv6j4w93xnR9XovQQ9kJhcwmavXV+J5PbTSipTecfPrZDlKCMwBP+Nkfqyt3w5amVU1jl5/joK+WaSmdLGD2Evyjd4Z+05QsuA/9s/xMsoLXbiSj43CSrhH0opLWU1m7saEHRrmZJDhe2gF4rBOB8luX2I9ZoT3xyc/jPbgo3pJSAYiOwo6GEAZMoMhKRm/hcxMteB3YtDtDh8leaIRB5++ET0ASjLi1Ms8OGuoTJrz6J5GXQTJU7Ih52Jz/PY', 'body': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-2","eventTime":"2023-01-21T21:08:44.075Z","eventName":"ObjectCreated:Put","userIdentity":{"principalId":"AWS:AROAV2CJ256E23ZOBRSAF:prod.pdx.dbs.datafeeds.aws.internal"},"requestParameters":{"sourceIPAddress":"172.19.67.123"},"responseElements":{"x-amz-request-id":"81KR386GSPPEJ1A6","x-amz-id-2":"qDVdamIDcwxeAJOnAUm4kHvzvk2HsL5aggHiz6K7UQXNaYEJrtSbd/YbLR7xD0RpSeJDueUAFyWH02WPH9j51WFH37LjjnsQ"},"s3":{"s3SchemaVersion":"1.0","configurationId":"85153fb0-1426-494e-9c4e-ffffe0ebf520","bucket":{"name":"841154226728-us-west-2-vpcflowlog","ownerIdentity":{"principalId":"A12SQTDQCD6TT5"},"arn":"arn:aws:s3:::841154226728-us-west-2-vpcflowlog"},"object":{"key":"AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz","size":2794,"eTag":"1891e0401175628854f10ee575e9bade","sequencer":"0063CC545C0877B5E6"}}}]}', 'attributes': {'ApproximateReceiveCount': '1', 'SentTimestamp': '1674335325366', 'SenderId': 'AIDAJFWZWTE5KRAMGW5A2', 'ApproximateFirstReceiveTimestamp': '1674335325369'}, 'messageAttributes': {}, 'md5OfMessageAttributes': None, 'md5OfBody': 'b3cf3151132d06b8b68cdc64ad833dd6', 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-west-2:841154226728:841154226728-us-west-2-vpcflowlog-sqs-queue', 'awsRegion': 'us-west-2'}), {'bucket': '841154226728-us-west-2-vpcflowlog', 'key': 'AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz'})

		# Test with bad paths
		self.assertEqual(self.lambda_module.retrieveObjectInfo({'messageId': '0ed4e10e-7fe3-41c8-ba7e-59b0c90826f3', 'receiptHandle': 'AQEBrbGkhIBIrdBxqc9HfoDkMkaNz7/'}), "SQS message did not contain S3 file information.  Record: {'messageId': '0ed4e10e-7fe3-41c8-ba7e-59b0c90826f3', 'receiptHandle': 'AQEBrbGkhIBIrdBxqc9HfoDkMkaNz7/'}")

	def test_validateFileType(self):
		
		# Test with unsupported files
		self.assertEqual(self.lambda_module.validateFileType("none"), "Unsupported file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.txt"), "Unsupported file type.")
		self.assertEqual(self.lambda_module.validateFileType("file.md"), "Unsupported file type.")

		# Test with supported files
		self.assertEqual(self.lambda_module.validateFileType("AWSLogs/841154226728/vpcflowlogs/us-west-2/2023/01/21/841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gz"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.gz"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log.gzip"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.gzip"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.json"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.csv"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.log"), "Valid file type.")
		self.assertEqual(self.lambda_module.validateFileType("841154226728_vpcflowlogs_us-west-2_fl-055401975c87952e8_20230121T2105Z_654119f1.parquet"), "Valid file type.")

	def test_eventBreak(self):
		
		# Test with log files, removing first line 
		self.assertEqual(self.lambda_module.eventBreak("version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status\n2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK", "log", "true"), ['2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK'])

		# Test with log files, leaving first line 
		self.assertEqual(self.lambda_module.eventBreak("version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status\n2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK\n2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK", "log", "false"), ['version account-id interface-id srcaddr dstaddr srcport dstport protocol packets bytes start end action log-status', '2 841154226728 eni-0b48139ba00b9b7bb 3.208.215.234 172.21.12.101 443 48956 6 11 4832 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 172.21.12.101 34.212.183.222 56812 4200 6 17 7818 1674335396 1674335425 ACCEPT OK','2 841154226728 eni-0b48139ba00b9b7bb 3.225.203.212 172.21.12.101 443 56178 6 11 4832 1674335396 1674335425 ACCEPT OK'])

		# Test with csv files, removing first line
		self.assertEqual(self.lambda_module.eventBreak('identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/abdInstanceClass,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/backupservice,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeTier,product/freeTrial,product/freeUsageIncluded,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/invocation,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/origin,product/overageType,product/packSize,product/parameterType,product/physicalCores,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragename,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/qPresent,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/scanType,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/timeWindow,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usageGroup,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage,costCategory/cc_account_department\n2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,\nl2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\nlq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', "csv", "true"), [ '2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,', 'l2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', '3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', 'lq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'])

		# Test with csv files, leaving first line
		self.assertEqual(self.lambda_module.eventBreak('identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/abdInstanceClass,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/backupservice,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeTier,product/freeTrial,product/freeUsageIncluded,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/invocation,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/origin,product/overageType,product/packSize,product/parameterType,product/physicalCores,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragename,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/qPresent,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/scanType,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/timeWindow,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usageGroup,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage,costCategory/cc_account_department\n2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,\nl2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\nlq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', "csv", "false"), ['identity/LineItemId,identity/TimeInterval,bill/InvoiceId,bill/InvoicingEntity,bill/BillingEntity,bill/BillType,bill/PayerAccountId,bill/BillingPeriodStartDate,bill/BillingPeriodEndDate,lineItem/UsageAccountId,lineItem/LineItemType,lineItem/UsageStartDate,lineItem/UsageEndDate,lineItem/ProductCode,lineItem/UsageType,lineItem/Operation,lineItem/AvailabilityZone,lineItem/ResourceId,lineItem/UsageAmount,lineItem/NormalizationFactor,lineItem/NormalizedUsageAmount,lineItem/CurrencyCode,lineItem/UnblendedRate,lineItem/UnblendedCost,lineItem/BlendedRate,lineItem/BlendedCost,lineItem/LineItemDescription,lineItem/TaxType,lineItem/LegalEntity,product/ProductName,product/abdInstanceClass,product/alarmType,product/attachmentType,product/availability,product/availabilityZone,product/backupservice,product/brokerEngine,product/bundle,product/bundleDescription,product/bundleGroup,product/cacheEngine,product/callingType,product/capacity,product/capacitystatus,product/category,product/ciType,product/classicnetworkingsupport,product/clientLocation,product/clockSpeed,product/component,product/computeType,product/connectionType,product/contentType,product/country,product/countsAgainstQuota,product/cputype,product/currentGeneration,product/data,product/dataTransferQuota,product/dataType,product/databaseEdition,product/databaseEngine,product/datatransferout,product/dedicatedEbsThroughput,product/deploymentOption,product/description,product/device,product/deviceType,product/directConnectLocation,product/directorySize,product/directoryType,product/directoryTypeDescription,product/dominantnondominant,product/durability,product/ecu,product/edition,product/endpoint,product/endpointType,product/engineCode,product/enhancedNetworkingSupport,product/enhancedNetworkingSupported,product/equivalentondemandsku,product/eventType,product/feeCode,product/feeDescription,product/findingGroup,product/findingSource,product/findingStorage,product/freeOverage,product/freeTier,product/freeTrial,product/freeUsageIncluded,product/fromLocation,product/fromLocationType,product/fromRegionCode,product/fusfCategory,product/georegioncode,product/gets,product/gpu,product/gpuMemory,product/group,product/groupDescription,product/insightstype,product/instance,product/instanceFamily,product/instanceFunction,product/instanceName,product/instanceType,product/instanceTypeFamily,product/instances,product/intelAvx2Available,product/intelAvxAvailable,product/intelTurboAvailable,product/invocation,product/io,product/license,product/licenseModel,product/lineType,product/location,product/locationType,product/lockeprofiles,product/logsDestination,product/mailboxStorage,product/marketoption,product/maxIopsBurstPerformance,product/maxIopsvolume,product/maxThroughputvolume,product/maxVolumeSize,product/maximumExtendedStorage,product/maximumStorageVolume,product/memory,product/memoryGib,product/memorytype,product/messageDeliveryFrequency,product/messageDeliveryOrder,product/meteringType,product/minVolumeSize,product/minimumStorageVolume,product/networkPerformance,product/normalizationSizeFactor,product/operatingSystem,product/operation,product/origin,product/overageType,product/packSize,product/parameterType,product/physicalCores,product/physicalCpu,product/physicalGpu,product/physicalProcessor,product/platoclassificationtype,product/platodataanalyzedtype,product/platofeaturetype,product/platoinstancename,product/platoinstancetype,product/platopricingtype,product/platoprotocoltype,product/platostoragename,product/platostoragetype,product/platotrafficdirection,product/platotransfertype,product/platousagetype,product/platovolumetype,product/portSpeed,product/preInstalledSw,product/pricingUnit,product/primaryplaceofuse,product/processorArchitecture,product/processorFeatures,product/productFamily,product/productType,product/provisioned,product/qPresent,product/queueType,product/recipient,product/region,product/regionCode,product/requestDescription,product/requestType,product/resourceEndpoint,product/resourcePriceGroup,product/resourceType,product/rootvolume,product/routingTarget,product/routingType,product/runningMode,product/scanType,product/servicecode,product/servicename,product/size,product/sku,product/snapshotarchivefeetype,product/softwareIncluded,product/standardGroup,product/standardStorage,product/standardStorageRetentionIncluded,product/steps,product/storage,product/storageClass,product/storageMedia,product/storageType,product/subscriptionType,product/tenancy,product/throughput,product/throughputClass,product/tickettype,product/tiertype,product/timeWindow,product/toLocation,product/toLocationType,product/toRegionCode,product/trafficDirection,product/transactionType,product/transferType,product/type,product/updates,product/usageFamily,product/usageGroup,product/usagetype,product/uservolume,product/vcpu,product/version,product/virtualInterfaceType,product/volumeApiName,product/volumeType,product/vpcnetworkingsupport,product/withActiveUsers,pricing/LeaseContractLength,pricing/OfferingClass,pricing/PurchaseOption,pricing/RateCode,pricing/RateId,pricing/currency,pricing/publicOnDemandCost,pricing/publicOnDemandRate,pricing/term,pricing/unit,reservation/AmortizedUpfrontCostForUsage,reservation/AmortizedUpfrontFeeForBillingPeriod,reservation/EffectiveCost,reservation/EndTime,reservation/ModificationStatus,reservation/NormalizedUnitsPerReservation,reservation/NumberOfReservations,reservation/RecurringFeeForUsage,reservation/ReservationARN,reservation/StartTime,reservation/SubscriptionId,reservation/TotalReservedNormalizedUnits,reservation/TotalReservedUnits,reservation/UnitsPerReservation,reservation/UnusedAmortizedUpfrontFeeForBillingPeriod,reservation/UnusedNormalizedUnitQuantity,reservation/UnusedQuantity,reservation/UnusedRecurringFee,reservation/UpfrontValue,savingsPlan/TotalCommitmentToDate,savingsPlan/SavingsPlanARN,savingsPlan/SavingsPlanRate,savingsPlan/UsedCommitment,savingsPlan/SavingsPlanEffectiveCost,savingsPlan/AmortizedUpfrontCommitmentForBillingPeriod,savingsPlan/RecurringCommitmentForBillingPeriod,resourceTags/aws:cloudformation:logical-id,resourceTags/aws:cloudformation:stack-id,resourceTags/aws:cloudformation:stack-name,resourceTags/aws:createdBy,resourceTags/user:AMI,resourceTags/user:Application,resourceTags/user:Area,resourceTags/user:Author,resourceTags/user:Backup,resourceTags/user:BlockDevice,resourceTags/user:BuildUser,resourceTags/user:Cluster,resourceTags/user:Created,resourceTags/user:CreatedBy,resourceTags/user:Customer,resourceTags/user:CustomerType,resourceTags/user:DNS,resourceTags/user:Desc,resourceTags/user:Description,resourceTags/user:Device,resourceTags/user:ELB,resourceTags/user:Email,resourceTags/user:Environment,resourceTags/user:EventCount,resourceTags/user:FQDN,resourceTags/user:Host,resourceTags/user:Hostname,resourceTags/user:Infra,resourceTags/user:InstanceId,resourceTags/user:Instructor,resourceTags/user:Label,resourceTags/user:Life,resourceTags/user:NAME,resourceTags/user:Name,resourceTags/user:Network,resourceTags/user:Note,resourceTags/user:OS,resourceTags/user:Owner,resourceTags/user:PAAS_CREATED_BY,resourceTags/user:PAAS_LIFETIME_DAYS,resourceTags/user:PAAS_OS,resourceTags/user:PAAS_SCHEDULE,resourceTags/user:PAAS_TZ,resourceTags/user:Plan,resourceTags/user:Project,resourceTags/user:PurgeAfterFE,resourceTags/user:PurgeAllow,resourceTags/user:Purpose,resourceTags/user:Release,resourceTags/user:Role,resourceTags/user:Server,resourceTags/user:SnapShotGroupId,resourceTags/user:SnapTestRunId,resourceTags/user:Splunk,resourceTags/user:Stack,resourceTags/user:StackName,resourceTags/user:Stage,resourceTags/user:Status,resourceTags/user:Subdomain,resourceTags/user:TEST,resourceTags/user:Team,resourceTags/user:Test,resourceTags/user:Ticket,resourceTags/user:Timestamp,resourceTags/user:Type,resourceTags/user:USER,resourceTags/user:Usage,resourceTags/user:Use,resourceTags/user:User,resourceTags/user:ValidationData,resourceTags/user:VerStackMakr,resourceTags/user:Volume,resourceTags/user:ami,resourceTags/user:ami_name,resourceTags/user:app,resourceTags/user:appversion,resourceTags/user:arch,resourceTags/user:area,resourceTags/user:class,resourceTags/user:cluster,resourceTags/user:createdBy,resourceTags/user:creator,resourceTags/user:customer,resourceTags/user:customer_type,resourceTags/user:desc,resourceTags/user:description,resourceTags/user:device_name,resourceTags/user:environment,resourceTags/user:fqdn,resourceTags/user:group,resourceTags/user:host,resourceTags/user:hostname,resourceTags/user:instructor,resourceTags/user:jenkins_slave_type,resourceTags/user:job_id,resourceTags/user:job_name,resourceTags/user:key1,resourceTags/user:key2,resourceTags/user:key_pair_id,resourceTags/user:mode,resourceTags/user:name,resourceTags/user:org,resourceTags/user:origin,resourceTags/user:os,resourceTags/user:project,resourceTags/user:purpose,resourceTags/user:region,resourceTags/user:role,resourceTags/user:sp_connection_id,resourceTags/user:splunkit.io/department/code,resourceTags/user:splunkit.io/os/version,resourceTags/user:splunkit.io/user/email,resourceTags/user:splunkit.io/user/isPartner,resourceTags/user:splunkit/app,resourceTags/user:splunkit/application,resourceTags/user:splunkit/department,resourceTags/user:splunkit/dept,resourceTags/user:splunkit/env,resourceTags/user:splunkit/environment,resourceTags/user:splunkit/instance,resourceTags/user:splunkit/name,resourceTags/user:splunkit/owner,resourceTags/user:splunkit/provider,resourceTags/user:splunkit/provisioner,resourceTags/user:splunkit/resource,resourceTags/user:splunkit/team,resourceTags/user:splunkit/ttl,resourceTags/user:splunkit/uri,resourceTags/user:stack,resourceTags/user:stack_id,resourceTags/user:stack_version,resourceTags/user:stage,resourceTags/user:status,resourceTags/user:storage,resourceTags/user:storm_raid,resourceTags/user:subnet,resourceTags/user:tag,resourceTags/user:tag1,resourceTags/user:target,resourceTags/user:team,resourceTags/user:test,resourceTags/user:type,resourceTags/user:uri,resourceTags/user:usage,costCategory/cc_account_department', '2s2y5vxa2754grcd6i5uqdmcafpmpmhkt4zdzwnhufw2gqas2woq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AmazonS3,USE1-APS1-AWS-Out-Bytes,HeadBucket,,841154226728-us-west-2-cloudtrail,0.0000003399,,,USD,0.0200000000,0.0000000068,0.0200000000,0.0000000068,$0.02 per GB - US East (Northern Virginia) data transfer to Asia Pacific (Singapore),,"Amazon Web Services, Inc.",Amazon Simple Storage Service,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US East (N. Virginia),AWS Region,us-east-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-east-1,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,2T92AZQGNFAQHEXW,,,,,,,,,,,,,,,,,,Asia Pacific (Singapore),AWS Region,ap-southeast-1,,,InterRegion Outbound,,,,,USE1-APS1-AWS-Out-Bytes,,,,,,,,,,,,2T92AZQGNFAQHEXW.JRTCKXETXF.6YS6EN2CT7,14884114963,USD,0.0000000068,0.0200000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,s3Bucket,arn:aws:cloudformation:us-west-2:841154226728:stack/cloudTrailInS3ToCribl/cbf453a0-ea90-11ec-8235-0a3a6e90aec9,cloudTrailInS3ToCribl,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod,,,,,,,,,,,,,', 'l2hagxj64wvze5bcqog2fbhjftic3wc77w25ueh5wxk5w2nci5yq,2023-01-01T05:00:00Z/2023-01-01T06:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T05:00:00Z,2023-01-01T06:00:00Z,AWSCloudTrail,USW1-PaidEventsRecorded,None,,,4.0000000000,,,USD,0.0000200000,0.0000800000,0.0000200000,0.0000800000,0.00002 per paid event recorded in US West (N.California) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (N. California),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Paid Events Recorded,,,,,,us-west-1,us-west-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,3K24RW8SDRXJU2SH,,,,,,,,,,,,,,,,,,,,,,,,,,,,USW1-PaidEventsRecorded,,,,,,,,,,,,3K24RW8SDRXJU2SH.JRTCKXETXF.6YS6EN2CT7,14321586596,USD,0.0000800000,0.0000200000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', '3ux3elevb7nac74ytzkmxzossdv2bspvlqyrieefmmpasr7la3oa,2023-01-01T16:00:00Z/2023-01-01T17:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T16:00:00Z,2023-01-01T17:00:00Z,AmazonEC2,USW2-DataTransfer-Out-Bytes,RunInstances,,i-0b48683bd9f23a535,0.0076582441,,,USD,0.0225000000,0.0001723105,0.0225000001,0.0001723105,$0.0225 per GB data transfer out per month,,"Amazon Web Services, Inc.",Amazon Elastic Compute Cloud,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,US West (Oregon),AWS Region,us-west-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Data Transfer,,,,,,us-west-2,,,,,,,,,,,,AWSDataTransfer,AWS Data Transfer,,5M4327XEUKBBTWAT,,,,,,,,,,,,,,,,,,External,Other,,,,AWS Outbound,,,,,USW2-DataTransfer-Out-Bytes,,,,,,,,,,,,5M4327XEUKBBTWAT.JRTCKXETXF.6YS6EN2CT7,14884106629,USD,0.0006892420,0.0900000000,OnDemand,GB,,,,,,,,,,,8592851269,,,,,,,,,,,,,,,,ec2,arn:aws:cloudformation:us-west-2:841154226728:stack/splunkLabEnvironment/c8851ed0-0dc1-11ed-ac21-0291d41fd5bf,splunkLabEnvironment,AssumedRole:AROA4HWFS5IUE5MM7OWHV:preeves@splunk.com,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,splunkLab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,', 'lq4lap755gn5aktsjvbspwttmgfnqzx5wg2yw7mjk5apshostjhq,2023-01-01T13:00:00Z/2023-01-01T14:00:00Z,,"Amazon Web Services, Inc.",AWS,Anniversary,562282672475,2023-01-01T00:00:00Z,2023-02-01T00:00:00Z,841154226728,Usage,2023-01-01T13:00:00Z,2023-01-01T14:00:00Z,AWSCloudTrail,APS3-FreeEventsRecorded,None,,,19.0000000000,,,USD,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0 per free event recorded in Asia Pacific (Mumbai) region,,"Amazon Web Services, Inc.",AWS CloudTrail,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Asia Pacific (Mumbai),AWS Region,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Management Tools - AWS CloudTrail Free Events Recorded,,,,,,ap-south-1,ap-south-1,,,,,,,,,,,AWSCloudTrail,AWS CloudTrail,,6CRG8SSD237RQMN6,,,,,,,,,,,,,,,,,,,,,,,,,,,,APS3-FreeEventsRecorded,,,,,,,,,,,,6CRG8SSD237RQMN6.JRTCKXETXF.6YS6EN2CT7,14321586484,USD,0.0000000000,0.0000000000,OnDemand,Events,,,,,,,,,,,8592851348,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'])

		# Test with sourcetype set to aws:s3:accesslogs, single event
		self.lambda_module.SPLUNK_SOURCETYPE = "aws:s3:accesslogs"
		self.assertEqual(self.lambda_module.eventBreak('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', "log", "false"), ['d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -'])
		
		# Test with sourcetype set to aws:s3:accesslogs, multiple events
		self.assertEqual(self.lambda_module.eventBreak('d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -\nd2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:00 +0000] 72.21.217.31 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe XMCJ5XQ4EBJT3EK9 REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - 0QBKb8tfCZm6kL6nkgdc9rrE7cGaI+YLSi+jjIrnXqAzhHkrrOFUFqMd5SDmANZsjhcWWrHWIDk= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', "log", "false"), ['d2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:50 +0000] 54.240.199.94 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe B78TNZKV8P9FHYMW REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/legacy" - OqkEVY/YE+oipU36cfmT68EpF3Xebfnxvlz3gHgDaF/n2LiPE85uMP9zWCjUTWKi5wXqX5fPHPkrHP+Yc7czwg== SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -', 'd2b1828e428fd0fc94f09e0df9e09766e034d88de30f075647bbf52fa79dd42d splunk-aws-gdi-tooklit-us-west-2-public-bucket [08/Nov/2022:13:07:00 +0000] 72.21.217.31 arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForConfig/AWSConfig-Describe XMCJ5XQ4EBJT3EK9 REST.GET.LOCATION - "GET /?location HTTP/1.1" 200 - 137 - 20 - "-" "AWSConfig cfg/retry-mode/standard" - 0QBKb8tfCZm6kL6nkgdc9rrE7cGaI+YLSi+jjIrnXqAzhHkrrOFUFqMd5SDmANZsjhcWWrHWIDk= SigV4 ECDHE-RSA-AES128-GCM-SHA256 AuthHeader splunk-aws-gdi-tooklit-us-west-2-public-bucket.s3.us-west-2.amazonaws.com TLSv1.2 - -'])

		# Test with json, eventInRecords format
		self.lambda_module.SPLUNK_SOURCETYPE = "main"
		self.lambda_module.SPLUNK_JSON_FORMAT = "eventsInRecords"

		self.assertEqual(self.lambda_module.eventBreak('{"Records":[{"eventVersion":"1.08","userIdentity":{"type":"AssumedRole","principalId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2","accountId":"841154226728","sessionContext":{"sessionIssuer":{"type":"Role","principalId":"AROA4HWFS5IUE3HEDLKDB","arn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","accountId":"841154226728","userName":"AWSServiceRoleForResourceExplorer"},"webIdFederationData":{},"attributes":{"creationDate":"2023-01-19T22:55:36Z","mfaAuthenticated":"false"}},"invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:37Z","eventSource":"ec2.amazonaws.com","eventName":"DescribeIpamPools","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"DescribeIpamPoolsRequest":{"MaxResults":100}},"responseElements":null,"requestID":"8ae007b2-7862-47a3-87b3-770ec399463f","eventID":"3957f51a-8f68-4904-8d1e-8ded7bcc1981","readOnly":true,"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","eventCategory":"Management"},{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:36Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","roleSessionName":"resource-explorer-2","durationSeconds":900},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUDU43MXDC","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4","expiration":"Jan 19, 2023, 11:10:36 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2"}},"requestID":"9244c327-8a7d-4ef9-a556-daf719faa814","eventID":"201df201-769a-4f2e-bc50-59bdc32d32d9","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"7b1d2a34-3a77-4d6d-b3fe-372d296f4652","eventCategory":"Management"},{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"cloudtrail.amazonaws.com"},"eventTime":"2023-01-19T22:57:45Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"cloudtrail.amazonaws.com","userAgent":"cloudtrail.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole","roleSessionName":"CLOUDWATCH_LOGS_DELIVERY_SESSION"},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUEMTX5T6W","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==","expiration":"Jan 19, 2023, 11:57:45 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION","arn":"arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION"}},"requestID":"30819315-12f7-49cf-a95f-2a25c904c57d","eventID":"39ec690d-bb7b-4a15-b197-c7d449489268","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"724eaa5c-900a-4695-8402-ce3bf83ee464","eventCategory":"Management"}]}', "json", "false"), [{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROA4HWFS5IUE3HEDLKDB:resource-explorer-2', 'arn': 'arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2', 'accountId': '841154226728', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROA4HWFS5IUE3HEDLKDB', 'arn': 'arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer', 'accountId': '841154226728', 'userName': 'AWSServiceRoleForResourceExplorer'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2023-01-19T22:55:36Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'resource-explorer-2.amazonaws.com'}, 'eventTime': '2023-01-19T22:55:37Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DescribeIpamPools', 'awsRegion': 'sa-east-1', 'sourceIPAddress': 'resource-explorer-2.amazonaws.com', 'userAgent': 'resource-explorer-2.amazonaws.com', 'requestParameters': {'DescribeIpamPoolsRequest': {'MaxResults': 100}}, 'responseElements': None, 'requestID': '8ae007b2-7862-47a3-87b3-770ec399463f', 'eventID': '3957f51a-8f68-4904-8d1e-8ded7bcc1981', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '841154226728', 'eventCategory': 'Management'}, {'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 'resource-explorer-2.amazonaws.com'}, 'eventTime': '2023-01-19T22:55:36Z', 'eventSource': 'sts.amazonaws.com', 'eventName': 'AssumeRole', 'awsRegion': 'sa-east-1', 'sourceIPAddress': 'resource-explorer-2.amazonaws.com', 'userAgent': 'resource-explorer-2.amazonaws.com', 'requestParameters': {'roleArn': 'arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer', 'roleSessionName': 'resource-explorer-2', 'durationSeconds': 900}, 'responseElements': {'credentials': {'accessKeyId': 'ASIA4HWFS5IUDU43MXDC', 'sessionToken': 'IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4', 'expiration': 'Jan 19, 2023, 11:10:36 PM'}, 'assumedRoleUser': {'assumedRoleId': 'AROA4HWFS5IUE3HEDLKDB:resource-explorer-2', 'arn': 'arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2'}}, 'requestID': '9244c327-8a7d-4ef9-a556-daf719faa814', 'eventID': '201df201-769a-4f2e-bc50-59bdc32d32d9', 'readOnly': True, 'resources': [{'accountId': '841154226728', 'type': 'AWS::IAM::Role', 'ARN': 'arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '841154226728', 'sharedEventID': '7b1d2a34-3a77-4d6d-b3fe-372d296f4652', 'eventCategory': 'Management'}, {'eventVersion': '1.08', 'userIdentity': {'type': 'AWSService', 'invokedBy': 'cloudtrail.amazonaws.com'}, 'eventTime': '2023-01-19T22:57:45Z', 'eventSource': 'sts.amazonaws.com', 'eventName': 'AssumeRole', 'awsRegion': 'sa-east-1', 'sourceIPAddress': 'cloudtrail.amazonaws.com', 'userAgent': 'cloudtrail.amazonaws.com', 'requestParameters': {'roleArn': 'arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole', 'roleSessionName': 'CLOUDWATCH_LOGS_DELIVERY_SESSION'}, 'responseElements': {'credentials': {'accessKeyId': 'ASIA4HWFS5IUEMTX5T6W', 'sessionToken': 'IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==', 'expiration': 'Jan 19, 2023, 11:57:45 PM'}, 'assumedRoleUser': {'assumedRoleId': 'AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION', 'arn': 'arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION'}}, 'requestID': '30819315-12f7-49cf-a95f-2a25c904c57d', 'eventID': '39ec690d-bb7b-4a15-b197-c7d449489268', 'readOnly': True, 'resources': [{'accountId': '841154226728', 'type': 'AWS::IAM::Role', 'ARN': 'arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '841154226728', 'sharedEventID': '724eaa5c-900a-4695-8402-ce3bf83ee464', 'eventCategory': 'Management'}])

		# Test with json, NDJSON format
		self.lambda_module.SPLUNK_JSON_FORMAT = "NDJSON"
		self.assertEqual(self.lambda_module.eventBreak('{"eventVersion":"1.08","userIdentity":{"type":"AssumedRole","principalId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2","accountId":"841154226728","sessionContext":{"sessionIssuer":{"type":"Role","principalId":"AROA4HWFS5IUE3HEDLKDB","arn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","accountId":"841154226728","userName":"AWSServiceRoleForResourceExplorer"},"webIdFederationData":{},"attributes":{"creationDate":"2023-01-19T22:55:36Z","mfaAuthenticated":"false"}},"invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:37Z","eventSource":"ec2.amazonaws.com","eventName":"DescribeIpamPools","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"DescribeIpamPoolsRequest":{"MaxResults":100}},"responseElements":null,"requestID":"8ae007b2-7862-47a3-87b3-770ec399463f","eventID":"3957f51a-8f68-4904-8d1e-8ded7bcc1981","readOnly":true,"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","eventCategory":"Management"}\n{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:36Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","roleSessionName":"resource-explorer-2","durationSeconds":900},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUDU43MXDC","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4","expiration":"Jan 19, 2023, 11:10:36 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2"}},"requestID":"9244c327-8a7d-4ef9-a556-daf719faa814","eventID":"201df201-769a-4f2e-bc50-59bdc32d32d9","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"7b1d2a34-3a77-4d6d-b3fe-372d296f4652","eventCategory":"Management"}\n{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"cloudtrail.amazonaws.com"},"eventTime":"2023-01-19T22:57:45Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"cloudtrail.amazonaws.com","userAgent":"cloudtrail.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole","roleSessionName":"CLOUDWATCH_LOGS_DELIVERY_SESSION"},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUEMTX5T6W","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==","expiration":"Jan 19, 2023, 11:57:45 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION","arn":"arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION"}},"requestID":"30819315-12f7-49cf-a95f-2a25c904c57d","eventID":"39ec690d-bb7b-4a15-b197-c7d449489268","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"724eaa5c-900a-4695-8402-ce3bf83ee464","eventCategory":"Management"}', "json", "false"), ['{"eventVersion":"1.08","userIdentity":{"type":"AssumedRole","principalId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2","accountId":"841154226728","sessionContext":{"sessionIssuer":{"type":"Role","principalId":"AROA4HWFS5IUE3HEDLKDB","arn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","accountId":"841154226728","userName":"AWSServiceRoleForResourceExplorer"},"webIdFederationData":{},"attributes":{"creationDate":"2023-01-19T22:55:36Z","mfaAuthenticated":"false"}},"invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:37Z","eventSource":"ec2.amazonaws.com","eventName":"DescribeIpamPools","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"DescribeIpamPoolsRequest":{"MaxResults":100}},"responseElements":null,"requestID":"8ae007b2-7862-47a3-87b3-770ec399463f","eventID":"3957f51a-8f68-4904-8d1e-8ded7bcc1981","readOnly":true,"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","eventCategory":"Management"}', '{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"resource-explorer-2.amazonaws.com"},"eventTime":"2023-01-19T22:55:36Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"resource-explorer-2.amazonaws.com","userAgent":"resource-explorer-2.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer","roleSessionName":"resource-explorer-2","durationSeconds":900},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUDU43MXDC","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJHMEUCIQDdjahhHcSo/uzyit1mWhoBA5XbjZ4ykEnn9hAHmEBV6QIgGtL6JsblmFeoWHh090QZgkcrGaZcyfJHZwsMN7tzCC8q+QIIgP//////////ARABGgw4NDExNTQyMjY3MjgiDIemDVNfPpRyQT8ZtSrNAicKz/ria7va7HgwbStLIriWjt+pIp2tFKoQXMMn+FxEgNOa6w+s2r8Rg/2qhEBojrzZfMFm8n3teIyCUw1n9lORBn02K889eaHm3D0aiuZJ8R9bSuPziMybSB59qeqKrG9o7HuS3hSiL3shpVLEGQfqJkVSOtZ3AsRxyncOAMtJNY18bmcsnsQzOUPewRJdEhm7ltUmnbTNCHrHLm7lKhSJ2+cd420E7H2hFx+BylQW1q7eGYtdk4LLxODByPFYf6NL33bJP9e+FyATJpI99eww7iCY6hUl5oqOUU1Fj+L54FF15bpN0YmrADxv/nItt322WI+rzSfpif1x8bzTVY4FbZqw/fI51f958Jki4Fz3cZIf3UMWDfnSgvlgBfb60qaX5/mwVzOgUv8yO8NrYgjjv84mm4RHYeoabEJeElKYIHfb/rV46GzygDD1szDolKeeBjq/ATVSL8Rl4147yczzdzD5LelGYm+JcLcfUAbR7LojbsKcR3UeZ8BXp6LQdWiV6O70wBPT5/shYM+IBZNtN1nn1VcO/TtBY2RckGlkOFgo8bBaqN/rDwlJo/+6VFDA6taN4tT6P1ReFuckJpFyogTkfgTPZOKJPKqKtfLF5ksVtoRTi7VV78TD5HsseNgErLqGj7oRdJVKzMg41RjSziyT9YU4h4IfbS/2t7B3BB3J1HW6m5odYhSkLeWcB74eWeb4","expiration":"Jan 19, 2023, 11:10:36 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUE3HEDLKDB:resource-explorer-2","arn":"arn:aws:sts::841154226728:assumed-role/AWSServiceRoleForResourceExplorer/resource-explorer-2"}},"requestID":"9244c327-8a7d-4ef9-a556-daf719faa814","eventID":"201df201-769a-4f2e-bc50-59bdc32d32d9","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"7b1d2a34-3a77-4d6d-b3fe-372d296f4652","eventCategory":"Management"}', '{"eventVersion":"1.08","userIdentity":{"type":"AWSService","invokedBy":"cloudtrail.amazonaws.com"},"eventTime":"2023-01-19T22:57:45Z","eventSource":"sts.amazonaws.com","eventName":"AssumeRole","awsRegion":"sa-east-1","sourceIPAddress":"cloudtrail.amazonaws.com","userAgent":"cloudtrail.amazonaws.com","requestParameters":{"roleArn":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole","roleSessionName":"CLOUDWATCH_LOGS_DELIVERY_SESSION"},"responseElements":{"credentials":{"accessKeyId":"ASIA4HWFS5IUEMTX5T6W","sessionToken":"IQoJb3JpZ2luX2VjEBcaCXNhLWVhc3QtMSJGMEQCIAvmA3cuAoJQqfSMxc2VTFijAjo0S5rNV6/ez7OVK/GjAiAhjlD/M8/hdbSuAI8XUaOvMQ29KKJyRLXZrRChMntpVCr0AgiA//////////8BEAEaDDg0MTE1NDIyNjcyOCIMKnhdAOlR9LaBnTSkKsgCbCvh8T5O+4M8Za/PdG49u/6D5m1rh+zLXF3XTOvetpfwNqU0HSyiqMtdmOhwvBVolzw7XtNMyPVKAdQz++Qb/erCsR79Sqxc5tKXEesb4ke2Uw7y9OT/qwhElCfj4+M/wFFPxz3RaVrB2k+V3fcRBoWuDTSEmuAKEmDksGoorpoCmqHlZp20lLsuUrfz2vE5BLwAnufqlBnYb/hZ5TkPAqJUpPOun2XdgBQoKOc/GaV6PHObyOoTHw4KCOLUqQElqS/aUx02uEedMSdXEN7caVRSqf/bxxbO6hnxFemqnfDLEOP/VWg+2/Ld2L7WUHBECxANsNf5lzX4i1HunVpkcgxu47aG97JoytycaXUvVQnANFDjn66njIjG6A9YkX+GOjVgDkzG/VYOHBUFCqs+Z4zIN7QK/lXVCC+jJAXqcGGbvMunj3KBNDDplaeeBjrAAQvcNIjEYahUub/Kz03l62gu+Ync8RAyUdnNrVCHN5/yLmyP4xYXkWY2dH4bY7Eps1wQWBT1KwWcw8l74QWMbaMtznbHSeHGSpPCO/QWoMzUmlhUqN6rSll3RKXRgUGXY5wRU/rdaLXi8L3VryAfb45L/gw8yZ8t44B9WNVn0GQgAMv39pODRnGWFcqimD3FWGFru+vytqLXYkpbo1eeyOLMmZL74koKqE89yIpp0eWoSa/5l6rSbiMg9bXQFp5LHw==","expiration":"Jan 19, 2023, 11:57:45 PM"},"assumedRoleUser":{"assumedRoleId":"AROA4HWFS5IUEKFTURUYB:CLOUDWATCH_LOGS_DELIVERY_SESSION","arn":"arn:aws:sts::841154226728:assumed-role/aws-controltower-CloudWatchLogsRole/CLOUDWATCH_LOGS_DELIVERY_SESSION"}},"requestID":"30819315-12f7-49cf-a95f-2a25c904c57d","eventID":"39ec690d-bb7b-4a15-b197-c7d449489268","readOnly":true,"resources":[{"accountId":"841154226728","type":"AWS::IAM::Role","ARN":"arn:aws:iam::841154226728:role/aws-controltower-CloudWatchLogsRole"}],"eventType":"AwsApiCall","managementEvent":true,"recipientAccountId":"841154226728","sharedEventID":"724eaa5c-900a-4695-8402-ce3bf83ee464","eventCategory":"Management"}'])


if __name__ == '__main__':
	unittest.main()